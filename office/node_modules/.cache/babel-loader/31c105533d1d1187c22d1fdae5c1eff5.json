{"ast":null,"code":"var _jsxFileName = \"/Users/gwagbyeongjun/Sourcecode/react/aju-office/src/components/Editor/components/Insert.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useCallback } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport Resizer from \"react-image-file-resizer\";\nimport firebaseApp from \"../../config/firebaseApp\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst dummy = [{\n  img: \"summary\",\n  type: \"SUMMARY\"\n}, {\n  img: \"temp\",\n  type: \"IMAGE\"\n}, {\n  img: \"video\",\n  type: \"VIDEO\"\n} // { img: \"youtube\", type: \"YOUTUBE\" },\n// { img: \"link\", type: \"LINK\" },\n// { img: \"file\", type: \"FILE\" },\n];\nconst Fstorage = firebaseApp.storage();\nconst Fstore = firebaseApp.firestore();\n\nfunction Insert({\n  setIsUp,\n  temKey\n}) {\n  _s();\n\n  const dispatch = useDispatch();\n  const template = useSelector(state => state.database.editor);\n\n  const __imageUpload = useCallback((data64, name, resize) => {\n    return new Promise((resolve, reject) => {\n      const data = data64.split(\",\")[1];\n      const redata = resize.split(\",\")[1];\n      Fstorage.ref(`editor/${temKey}/${name}`).putString(data, \"base64\").then(result => {\n        result.ref.getDownloadURL().then(downloadUrl => {\n          Fstorage.ref(`editor/${temKey}/${name}-resize`).putString(redata, \"base64\").then(result => {\n            result.ref.getDownloadURL().then(resizeUrl => {\n              resolve({\n                url: downloadUrl,\n                resize: resizeUrl\n              });\n            });\n          });\n        });\n      });\n    });\n  }, [temKey]);\n\n  const __fileReader = useCallback(file => {\n    return new Promise((resolve, reject) => {\n      var reader = new FileReader();\n\n      reader.onload = function (e) {\n        const imageUrl = e.target.result;\n        var img = new Image();\n        img.src = imageUrl;\n\n        img.onload = function (e) {\n          Resizer.imageFileResizer(file, 5, 5, \"JPEG\", 100, 0, uri => {\n            resolve({\n              url: imageUrl,\n              resize: uri,\n              name: file.name,\n              width: this.width,\n              height: this.height\n            });\n          }, \"base64\");\n        };\n      };\n\n      reader.readAsDataURL(file);\n    });\n  }, []);\n\n  const __imageUpdate = useCallback(e => {\n    dispatch({\n      type: \"@config/isLoading\",\n      payload: true\n    });\n    let fileList = Object.values(e.target.files);\n    const base64 = Promise.all(fileList.map(item => {\n      const da = __fileReader(item).then(result => {\n        return result;\n      });\n\n      return da;\n    }));\n    base64.then(result => {\n      Promise.all(result.map(({\n        url,\n        name,\n        resize\n      }) => {\n        const po = __imageUpload(url, name, resize, width, height).then(result => {\n          return {\n            type: \"IMAGE\",\n            content: result,\n            width,\n            height,\n            id: `image-${new Date().getTime() - Math.floor(Math.random() * (100 - 1 + 1)) + 1}`\n          };\n        });\n\n        return po;\n      })).then(result => {\n        const arr = template.slice();\n        Fstore.collection(\"/editor\").doc(temKey).update({\n          template: [...arr, ...result]\n        });\n        dispatch({\n          type: \"@layouts/CHANGE_EDITOR\",\n          payload: [...arr, ...result]\n        });\n        dispatch({\n          type: \"@config/isLoading\",\n          payload: false\n        });\n      });\n    });\n  }, [__imageUpload, __fileReader, template, dispatch, temKey]);\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"insert-wrapper\",\n    children: dummy.map(({\n      img,\n      type\n    }, idx) => {\n      return /*#__PURE__*/_jsxDEV(\"label\", {\n        className: \"test-img\",\n        onClick: () => {\n          if (type !== \"IMAGE\" && type !== \"SUMMARY\") {\n            setIsUp({\n              status: true,\n              type: type\n            });\n          } else if (type === \"SUMMARY\") {\n            let arr = template.slice();\n            arr.push({\n              type: \"SUMMARY\",\n              content: {\n                text: \"\",\n                images: []\n              },\n              id: `summary-${new Date().getTime() - Math.floor(Math.random() * (100 - 1 + 1)) + 1}`\n            });\n            dispatch({\n              type: \"@layouts/CHANGE_EDITOR\",\n              payload: arr\n            });\n          }\n        },\n        children: [type === \"IMAGE\" ? /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          style: {\n            opacity: 0\n          },\n          multiple: true,\n          accept: \"image/x-png,image/gif,image/jpeg\",\n          onChange: __imageUpdate\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 15\n        }, this) : undefined, /*#__PURE__*/_jsxDEV(\"img\", {\n          src: `/assets/editor/${img}.svg`,\n          alt: `${img}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 13\n        }, this)]\n      }, idx, true, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 11\n      }, this);\n    })\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 126,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Insert, \"FvyDF0nARGnDekJAKhoXLiJmacU=\", false, function () {\n  return [useDispatch, useSelector];\n});\n\n_c = Insert;\nexport default Insert;\n\nvar _c;\n\n$RefreshReg$(_c, \"Insert\");","map":{"version":3,"sources":["/Users/gwagbyeongjun/Sourcecode/react/aju-office/src/components/Editor/components/Insert.jsx"],"names":["React","useCallback","useSelector","useDispatch","Resizer","firebaseApp","dummy","img","type","Fstorage","storage","Fstore","firestore","Insert","setIsUp","temKey","dispatch","template","state","database","editor","__imageUpload","data64","name","resize","Promise","resolve","reject","data","split","redata","ref","putString","then","result","getDownloadURL","downloadUrl","resizeUrl","url","__fileReader","file","reader","FileReader","onload","e","imageUrl","target","Image","src","imageFileResizer","uri","width","height","readAsDataURL","__imageUpdate","payload","fileList","Object","values","files","base64","all","map","item","da","po","content","id","Date","getTime","Math","floor","random","arr","slice","collection","doc","update","idx","status","push","text","images","opacity","undefined"],"mappings":"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","sourcesContent":["import React, { useCallback } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport Resizer from \"react-image-file-resizer\";\nimport firebaseApp from \"../../config/firebaseApp\";\nconst dummy = [\n  { img: \"summary\", type: \"SUMMARY\" },\n  { img: \"temp\", type: \"IMAGE\" },\n  { img: \"video\", type: \"VIDEO\" },\n  // { img: \"youtube\", type: \"YOUTUBE\" },\n  // { img: \"link\", type: \"LINK\" },\n  // { img: \"file\", type: \"FILE\" },\n];\n\nconst Fstorage = firebaseApp.storage();\nconst Fstore = firebaseApp.firestore();\nfunction Insert({ setIsUp, temKey }) {\n  const dispatch = useDispatch();\n  const template = useSelector((state) => state.database.editor);\n  const __imageUpload = useCallback(\n    (data64, name, resize) => {\n      return new Promise((resolve, reject) => {\n        const data = data64.split(\",\")[1];\n        const redata = resize.split(\",\")[1];\n        Fstorage.ref(`editor/${temKey}/${name}`)\n          .putString(data, \"base64\")\n          .then((result) => {\n            result.ref.getDownloadURL().then((downloadUrl) => {\n              Fstorage.ref(`editor/${temKey}/${name}-resize`)\n                .putString(redata, \"base64\")\n                .then((result) => {\n                  result.ref.getDownloadURL().then((resizeUrl) => {\n                    resolve({ url: downloadUrl, resize: resizeUrl });\n                  });\n                });\n            });\n          });\n      });\n    },\n    [temKey]\n  );\n  const __fileReader = useCallback((file) => {\n    return new Promise((resolve, reject) => {\n      var reader = new FileReader();\n      reader.onload = function (e) {\n        const imageUrl = e.target.result;\n        var img = new Image();\n        img.src = imageUrl;\n        img.onload = function (e) {\n          Resizer.imageFileResizer(\n            file,\n            5,\n            5,\n            \"JPEG\",\n            100,\n            0,\n            (uri) => {\n              resolve({\n                url: imageUrl,\n                resize: uri,\n                name: file.name,\n                width: this.width,\n                height: this.height,\n              });\n            },\n            \"base64\"\n          );\n        };\n      };\n      reader.readAsDataURL(file);\n    });\n  }, []);\n  const __imageUpdate = useCallback(\n    (e) => {\n      dispatch({\n        type: \"@config/isLoading\",\n        payload: true,\n      });\n      let fileList = Object.values(e.target.files);\n      const base64 = Promise.all(\n        fileList.map((item) => {\n          const da = __fileReader(item).then((result) => {\n            return result;\n          });\n          return da;\n        })\n      );\n      base64.then((result) => {\n        Promise.all(\n          result.map(({ url, name, resize }) => {\n            const po = __imageUpload(url, name, resize, width, height).then(\n              (result) => {\n                return {\n                  type: \"IMAGE\",\n                  content: result,\n                  width,\n                  height,\n                  id: `image-${\n                    new Date().getTime() -\n                    Math.floor(Math.random() * (100 - 1 + 1)) +\n                    1\n                  }`,\n                };\n              }\n            );\n            return po;\n          })\n        ).then((result) => {\n          const arr = template.slice();\n          Fstore.collection(\"/editor\")\n            .doc(temKey)\n            .update({ template: [...arr, ...result] });\n          dispatch({\n            type: \"@layouts/CHANGE_EDITOR\",\n            payload: [...arr, ...result],\n          });\n          dispatch({\n            type: \"@config/isLoading\",\n            payload: false,\n          });\n        });\n      });\n    },\n    [__imageUpload, __fileReader, template, dispatch, temKey]\n  );\n  return (\n    <div className=\"insert-wrapper\">\n      {dummy.map(({ img, type }, idx) => {\n        return (\n          <label\n            className=\"test-img\"\n            key={idx}\n            onClick={() => {\n              if (type !== \"IMAGE\" && type !== \"SUMMARY\") {\n                setIsUp({\n                  status: true,\n                  type: type,\n                });\n              } else if (type === \"SUMMARY\") {\n                let arr = template.slice();\n                arr.push({\n                  type: \"SUMMARY\",\n                  content: {\n                    text: \"\",\n                    images: [],\n                  },\n                  id: `summary-${\n                    new Date().getTime() -\n                    Math.floor(Math.random() * (100 - 1 + 1)) +\n                    1\n                  }`,\n                });\n                dispatch({\n                  type: \"@layouts/CHANGE_EDITOR\",\n                  payload: arr,\n                });\n              }\n            }}\n          >\n            {type === \"IMAGE\" ? (\n              <input\n                type=\"file\"\n                style={{ opacity: 0 }}\n                multiple={true}\n                accept=\"image/x-png,image/gif,image/jpeg\"\n                onChange={__imageUpdate}\n              />\n            ) : undefined}\n            <img src={`/assets/editor/${img}.svg`} alt={`${img}`} />\n          </label>\n        );\n      })}\n    </div>\n  );\n}\n\nexport default Insert;\n"]},"metadata":{},"sourceType":"module"}