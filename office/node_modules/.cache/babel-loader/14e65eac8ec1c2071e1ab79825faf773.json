{"ast":null,"code":"var _jsxFileName = \"/Users/gwagbyeongjun/Sourcecode/react/aju-office/src/components/Editor/components/Template/Summary.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useRef, useCallback, useEffect, useState } from \"react\";\nimport TemplateEmty from \"./TemplateEmty\";\nimport styled from \"styled-components\";\nimport { useDispatch } from \"react-redux\";\nimport { useSelector } from \"react-redux\";\nimport Resizer from \"react-image-file-resizer\";\nimport firebaseApp from \"../../../config/firebaseApp\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Fstorage = firebaseApp.storage();\nconst Label = styled.div`\n  width: 143px;\n  height: 139px;\n  background-color: #f7f7f7;\n  border: solid 1px #dbdbdb;\n  .list-img {\n    width: 58px;\n    height: 59px;\n  }\n  label {\n    position: relative;\n    display: flex;\n    width: 100%;\n    height: 100%;\n    align-items: center;\n    justify-content: center;\n    .sub-image {\n      width: 100%;\n      height: 100%;\n      position: absolute;\n      top: 0;\n      left: 0;\n    }\n    cursor: pointer;\n    input {\n      position: absolute;\n      display: none;\n    }\n  }\n`;\n_c = Label;\nconst Wrapper = styled.div`\n  width: 100%;\n  height: 550px;\n  display: flex;\n  .main {\n    border: solid 1px #dbdbdb;\n    margin-right: 35px;\n    width: 503px;\n    height: 490px;\n    background-color: #f7f7f7;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    label {\n      position: relative;\n      display: flex;\n      width: 100%;\n      height: 100%;\n      align-items: center;\n      justify-content: center;\n      flex-direction: column;\n\n      .true-image {\n        width: 100%;\n        height: 100%;\n        position: absolute;\n        top: 0;\n        left: 0;\n      }\n    }\n    .sub {\n      margin-top: 11px;\n      font-size: 14px;\n      font-weight: normal;\n      color: #bfbfbf;\n      text-align: center;\n      line-height: 1.57;\n    }\n  }\n  .content {\n    display: flex;\n    flex-direction: column;\n    justify-content: space-between;\n    padding-bottom: 60px;\n\n    box-sizing: border-box;\n    p {\n      overflow: hidden;\n      text-overflow: ellipsis;\n      cursor: text;\n      width: 454px;\n      height: auto;\n      white-space: pre-wrap;\n      word-wrap: break-word;\n      font-size: 17px;\n    }\n    textarea::placeholder {\n      color: #bfbfbf;\n      font-size: 17px;\n    }\n    .list {\n      display: grid;\n      grid-template-columns: repeat(3, 143px);\n      column-gap: 14px;\n      margin-top: 25px;\n    }\n  }\n`;\n_c2 = Wrapper;\nconst ControlBox = styled.div`\n  position: absolute;\n  z-index: -1;\n  width: 100%;\n  height: 100%;\n`;\n_c3 = ControlBox;\n\nfunction Summary({\n  data: {\n    text,\n    images\n  },\n  provided,\n  template,\n  idx,\n  setFocus,\n  id,\n  focusIdx,\n  temKey\n}) {\n  _s();\n\n  const status = useSelector(state => state.test.editor);\n  const dispatch = useDispatch();\n  const contentRef = useRef(null);\n  const [nowIdx, setNowIdx] = useState(0);\n\n  const __imageUpload = useCallback((data64, name) => {\n    return new Promise((resolve, reject) => {\n      const data = data64.split(\",\")[1];\n      Fstorage.ref(`editor/${temKey}/${id}/${name}`).putString(data, \"base64\").then(result => {\n        result.ref.getDownloadURL().then(downloadUrl => {\n          resolve(downloadUrl);\n        });\n      });\n    });\n  }, [id, temKey]);\n\n  const __fileReader = useCallback(file => {\n    return new Promise((resolve, reject) => {\n      var reader = new FileReader();\n\n      reader.onload = function (e) {\n        const imageUrl = e.target.result;\n        Resizer.imageFileResizer(file, 100, 100, \"PNG\", 100, 0, uri => {\n          resolve({\n            url: imageUrl,\n            resize: uri\n          });\n        }, \"base64\");\n      };\n\n      reader.readAsDataURL(file);\n    });\n  }, []);\n\n  const __updateImage = useCallback((type, file) => {\n    __fileReader(file).then(res => {\n      Promise.all([__imageUpload(res.resize, `${type}-resize`).then(res => {\n        return res;\n      }), __imageUpload(res.url, type).then(res => {\n        return res;\n      })]).then(result => {\n        dispatch({\n          type: \"@layouts/CHANGE_SUMMARY_IMAGE\",\n          idx,\n          payload: {\n            img: result[1],\n            resize: result[0]\n          },\n          index: type === \"main\" ? 0 : type\n        });\n      });\n    });\n  }, [__fileReader, __imageUpload, dispatch, idx]);\n\n  useEffect(() => {\n    if (text && focusIdx !== idx) {\n      contentRef.current.innerHTML = text;\n    }\n\n    return () => {};\n  }, [text, focusIdx, idx]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [idx === 0 ? /*#__PURE__*/_jsxDEV(TemplateEmty, {\n      idx: idx\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 20\n    }, this) : undefined, /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"template-video\",\n      ref: provided.innerRef,\n      ...provided.draggableProps,\n      ...provided.dragHandleProps,\n      onClick: () => {\n        setFocus(idx);\n      },\n      children: [/*#__PURE__*/_jsxDEV(ControlBox, {\n        onClick: () => {\n          console.log(\"클릭\");\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"dnd-icon\",\n        style: {\n          right: \"-60px\"\n        },\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: \"/assets/projects/dnd-icon.svg\",\n          alt: \"\\uC6D0\\uD558\\uB294 \\uC704\\uCE58\\uB85C \\uC774\\uB3D9\\uD574\\uBCF4\\uC138\\uC694!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Wrapper, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"main\",\n          children: /*#__PURE__*/_jsxDEV(\"label\", {\n            children: [images[nowIdx] ? /*#__PURE__*/_jsxDEV(\"img\", {\n              className: \"true-image\",\n              src: images[nowIdx].img,\n              alt: \"\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 223,\n              columnNumber: 17\n            }, this) : undefined, /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"sub\",\n              children: [\"\\uC0AC\\uC9C4\\uC744 \\uC5C5\\uB85C\\uB4DC\\uD574\\uC8FC\\uC138\\uC694 \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 227,\n                columnNumber: 29\n              }, this), \" jpeg, png, gif\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 226,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 221,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"content\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            contentEditable: true,\n            ref: contentRef,\n            suppressContentEditableWarning: true,\n            onKeyDown: e => {\n              if (contentRef.current.offsetHeight > 300 && e.keyCode !== 8) {\n                const test = contentRef.current.childNodes;\n                test[test.length - 1].remove();\n              }\n            },\n            onInput: e => {\n              dispatch({\n                type: \"@layouts/CHANGE_SUMMARY\",\n                payload: contentRef.current.innerHTML,\n                idx\n              });\n            },\n            onSelect: e => {\n              const select = window.getSelection();\n              const style = window.getComputedStyle(select.focusNode.parentNode);\n              const fontSize = parseInt(style.fontSize);\n              const align = style.textAlign;\n              const bold = document.queryCommandState(\"bold\");\n              const underline = document.queryCommandState(\"underline\");\n              const color = document.queryCommandValue(\"ForeColor\");\n\n              if (select.focusNode.localName === undefined && fontSize !== status.size) {\n                dispatch({\n                  type: \"@test/CHANGE_SIZE\",\n                  payload: fontSize\n                });\n              }\n\n              if (underline !== status.underline) {\n                dispatch({\n                  type: \"@test/CHANGE_UNDER\",\n                  payload: underline\n                });\n              }\n\n              if (bold !== status.bold) {\n                dispatch({\n                  type: \"@test/CHANGE_BOLD\",\n                  payload: bold\n                });\n              }\n\n              if (align !== status.align && align !== \"start\") {\n                dispatch({\n                  type: \"@test/CHANGE_ALIGN\",\n                  payload: align\n                });\n              }\n\n              if (color !== status.color) {\n                dispatch({\n                  type: \"@test/CHANGE_COLOR\",\n                  payload: color\n                });\n              }\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 232,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"list\",\n            children: [/*#__PURE__*/_jsxDEV(Label, {\n              onMouseOver: () => {\n                if (images[0]) {\n                  setNowIdx(0);\n                }\n              },\n              children: /*#__PURE__*/_jsxDEV(\"label\", {\n                children: [images[0] ? /*#__PURE__*/_jsxDEV(\"img\", {\n                  className: \"sub-image\",\n                  src: images[0].img,\n                  alt: \"\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 304,\n                  columnNumber: 21\n                }, this) : undefined, /*#__PURE__*/_jsxDEV(\"img\", {\n                  className: \"list-img\",\n                  src: \"/assets/editor/grey-plus.png\",\n                  alt: \"\\uCD94\\uAC00\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 306,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"file\",\n                  accept: \"image/x-png,image/gif,image/jpeg\",\n                  onChange: e => {\n                    __updateImage(0, e.target.files[0]);\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 311,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 302,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 295,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Label, {\n              onMouseOver: () => {\n                if (images[1]) {\n                  setNowIdx(1);\n                }\n              },\n              children: /*#__PURE__*/_jsxDEV(\"label\", {\n                children: [images[1] ? /*#__PURE__*/_jsxDEV(\"img\", {\n                  className: \"sub-image\",\n                  src: images[1].img,\n                  alt: \"\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 329,\n                  columnNumber: 21\n                }, this) : undefined, /*#__PURE__*/_jsxDEV(\"img\", {\n                  className: \"list-img\",\n                  src: \"/assets/editor/grey-plus.png\",\n                  alt: \"\\uCD94\\uAC00\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 331,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"file\",\n                  accept: \"image/x-png,image/gif,image/jpeg\",\n                  onChange: e => {\n                    __updateImage(1, e.target.files[0]);\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 336,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 327,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 320,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Label, {\n              onMouseOver: () => {\n                if (images[2]) {\n                  setNowIdx(2);\n                }\n              },\n              children: /*#__PURE__*/_jsxDEV(\"label\", {\n                children: [images[2] ? /*#__PURE__*/_jsxDEV(\"img\", {\n                  className: \"sub-image\",\n                  src: images[2].img,\n                  alt: \"\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 354,\n                  columnNumber: 21\n                }, this) : undefined, /*#__PURE__*/_jsxDEV(\"img\", {\n                  className: \"list-img\",\n                  src: \"/assets/editor/grey-plus.png\",\n                  alt: \"\\uCD94\\uAC00\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 356,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"file\",\n                  accept: \"image/x-png,image/gif,image/jpeg\",\n                  onChange: e => {\n                    __updateImage(2, e.target.files[0]);\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 361,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 352,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 345,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 294,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 7\n    }, this), !template[idx + 1] || template[idx + 1].type !== \"TITLE\" ? /*#__PURE__*/_jsxDEV(TemplateEmty, {\n      idx: idx + 1\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 375,\n      columnNumber: 9\n    }, this) : undefined]\n  }, void 0, true);\n}\n\n_s(Summary, \"x9rxMcdNF+KMfOa14snLxD96+C0=\", false, function () {\n  return [useSelector, useDispatch];\n});\n\n_c4 = Summary;\nexport default Summary;\n\nvar _c, _c2, _c3, _c4;\n\n$RefreshReg$(_c, \"Label\");\n$RefreshReg$(_c2, \"Wrapper\");\n$RefreshReg$(_c3, \"ControlBox\");\n$RefreshReg$(_c4, \"Summary\");","map":{"version":3,"sources":["/Users/gwagbyeongjun/Sourcecode/react/aju-office/src/components/Editor/components/Template/Summary.jsx"],"names":["React","useRef","useCallback","useEffect","useState","TemplateEmty","styled","useDispatch","useSelector","Resizer","firebaseApp","Fstorage","storage","Label","div","Wrapper","ControlBox","Summary","data","text","images","provided","template","idx","setFocus","id","focusIdx","temKey","status","state","test","editor","dispatch","contentRef","nowIdx","setNowIdx","__imageUpload","data64","name","Promise","resolve","reject","split","ref","putString","then","result","getDownloadURL","downloadUrl","__fileReader","file","reader","FileReader","onload","e","imageUrl","target","imageFileResizer","uri","url","resize","readAsDataURL","__updateImage","type","res","all","payload","img","index","current","innerHTML","undefined","innerRef","draggableProps","dragHandleProps","console","log","right","offsetHeight","keyCode","childNodes","length","remove","select","window","getSelection","style","getComputedStyle","focusNode","parentNode","fontSize","parseInt","align","textAlign","bold","document","queryCommandState","underline","color","queryCommandValue","localName","size","files"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,MAAhB,EAAwBC,WAAxB,EAAqCC,SAArC,EAAgDC,QAAhD,QAAgE,OAAhE;AACA,OAAOC,YAAP,MAAyB,gBAAzB;AACA,OAAOC,MAAP,MAAmB,mBAAnB;AACA,SAASC,WAAT,QAA4B,aAA5B;AACA,SAASC,WAAT,QAA4B,aAA5B;AACA,OAAOC,OAAP,MAAoB,0BAApB;AACA,OAAOC,WAAP,MAAwB,6BAAxB;;;AACA,MAAMC,QAAQ,GAAGD,WAAW,CAACE,OAAZ,EAAjB;AACA,MAAMC,KAAK,GAAGP,MAAM,CAACQ,GAAI;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CA7BA;KAAMD,K;AA8BN,MAAME,OAAO,GAAGT,MAAM,CAACQ,GAAI;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CApEA;MAAMC,O;AAqEN,MAAMC,UAAU,GAAGV,MAAM,CAACQ,GAAI;AAC9B;AACA;AACA;AACA;AACA,CALA;MAAME,U;;AAON,SAASC,OAAT,CAAiB;AACfC,EAAAA,IAAI,EAAE;AAAEC,IAAAA,IAAF;AAAQC,IAAAA;AAAR,GADS;AAEfC,EAAAA,QAFe;AAGfC,EAAAA,QAHe;AAIfC,EAAAA,GAJe;AAKfC,EAAAA,QALe;AAMfC,EAAAA,EANe;AAOfC,EAAAA,QAPe;AAQfC,EAAAA;AARe,CAAjB,EASG;AAAA;;AACD,QAAM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","sourcesContent":["import React, { useRef, useCallback, useEffect, useState } from \"react\";\nimport TemplateEmty from \"./TemplateEmty\";\nimport styled from \"styled-components\";\nimport { useDispatch } from \"react-redux\";\nimport { useSelector } from \"react-redux\";\nimport Resizer from \"react-image-file-resizer\";\nimport firebaseApp from \"../../../config/firebaseApp\";\nconst Fstorage = firebaseApp.storage();\nconst Label = styled.div`\n  width: 143px;\n  height: 139px;\n  background-color: #f7f7f7;\n  border: solid 1px #dbdbdb;\n  .list-img {\n    width: 58px;\n    height: 59px;\n  }\n  label {\n    position: relative;\n    display: flex;\n    width: 100%;\n    height: 100%;\n    align-items: center;\n    justify-content: center;\n    .sub-image {\n      width: 100%;\n      height: 100%;\n      position: absolute;\n      top: 0;\n      left: 0;\n    }\n    cursor: pointer;\n    input {\n      position: absolute;\n      display: none;\n    }\n  }\n`;\nconst Wrapper = styled.div`\n  width: 100%;\n  height: 550px;\n  display: flex;\n  .main {\n    border: solid 1px #dbdbdb;\n    margin-right: 35px;\n    width: 503px;\n    height: 490px;\n    background-color: #f7f7f7;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    label {\n      position: relative;\n      display: flex;\n      width: 100%;\n      height: 100%;\n      align-items: center;\n      justify-content: center;\n      flex-direction: column;\n\n      .true-image {\n        width: 100%;\n        height: 100%;\n        position: absolute;\n        top: 0;\n        left: 0;\n      }\n    }\n    .sub {\n      margin-top: 11px;\n      font-size: 14px;\n      font-weight: normal;\n      color: #bfbfbf;\n      text-align: center;\n      line-height: 1.57;\n    }\n  }\n  .content {\n    display: flex;\n    flex-direction: column;\n    justify-content: space-between;\n    padding-bottom: 60px;\n\n    box-sizing: border-box;\n    p {\n      overflow: hidden;\n      text-overflow: ellipsis;\n      cursor: text;\n      width: 454px;\n      height: auto;\n      white-space: pre-wrap;\n      word-wrap: break-word;\n      font-size: 17px;\n    }\n    textarea::placeholder {\n      color: #bfbfbf;\n      font-size: 17px;\n    }\n    .list {\n      display: grid;\n      grid-template-columns: repeat(3, 143px);\n      column-gap: 14px;\n      margin-top: 25px;\n    }\n  }\n`;\nconst ControlBox = styled.div`\n  position: absolute;\n  z-index: -1;\n  width: 100%;\n  height: 100%;\n`;\n\nfunction Summary({\n  data: { text, images },\n  provided,\n  template,\n  idx,\n  setFocus,\n  id,\n  focusIdx,\n  temKey,\n}) {\n  const status = useSelector((state) => state.test.editor);\n  const dispatch = useDispatch();\n  const contentRef = useRef(null);\n  const [nowIdx, setNowIdx] = useState(0);\n  const __imageUpload = useCallback(\n    (data64, name) => {\n      return new Promise((resolve, reject) => {\n        const data = data64.split(\",\")[1];\n        Fstorage.ref(`editor/${temKey}/${id}/${name}`)\n          .putString(data, \"base64\")\n          .then((result) => {\n            result.ref.getDownloadURL().then((downloadUrl) => {\n              resolve(downloadUrl);\n            });\n          });\n      });\n    },\n    [id, temKey]\n  );\n  const __fileReader = useCallback((file) => {\n    return new Promise((resolve, reject) => {\n      var reader = new FileReader();\n      reader.onload = function (e) {\n        const imageUrl = e.target.result;\n        Resizer.imageFileResizer(\n          file,\n          100,\n          100,\n          \"PNG\",\n          100,\n          0,\n          (uri) => {\n            resolve({ url: imageUrl, resize: uri });\n          },\n          \"base64\"\n        );\n      };\n      reader.readAsDataURL(file);\n    });\n  }, []);\n  const __updateImage = useCallback(\n    (type, file) => {\n      __fileReader(file).then((res) => {\n        Promise.all([\n          __imageUpload(res.resize, `${type}-resize`).then((res) => {\n            return res;\n          }),\n          __imageUpload(res.url, type).then((res) => {\n            return res;\n          }),\n        ]).then((result) => {\n          dispatch({\n            type: \"@layouts/CHANGE_SUMMARY_IMAGE\",\n            idx,\n            payload: {\n              img: result[1],\n              resize: result[0],\n            },\n            index: type === \"main\" ? 0 : type,\n          });\n        });\n      });\n    },\n    [__fileReader, __imageUpload, dispatch, idx]\n  );\n  useEffect(() => {\n    if (text && focusIdx !== idx) {\n      contentRef.current.innerHTML = text;\n    }\n    return () => {};\n  }, [text, focusIdx, idx]);\n  return (\n    <>\n      {idx === 0 ? <TemplateEmty idx={idx} /> : undefined}\n      <div\n        className=\"template-video\"\n        ref={provided.innerRef}\n        {...provided.draggableProps}\n        {...provided.dragHandleProps}\n        onClick={() => {\n          setFocus(idx);\n        }}\n      >\n        <ControlBox\n          onClick={() => {\n            console.log(\"클릭\");\n          }}\n        />\n        <div className=\"dnd-icon\" style={{ right: \"-60px\" }}>\n          <img\n            src=\"/assets/projects/dnd-icon.svg\"\n            alt=\"원하는 위치로 이동해보세요!\"\n          />\n        </div>\n        <Wrapper>\n          <div className=\"main\">\n            <label>\n              {images[nowIdx] ? (\n                <img className=\"true-image\" src={images[nowIdx].img} alt=\"\" />\n              ) : undefined}\n\n              <div className=\"sub\">\n                사진을 업로드해주세요 <br /> jpeg, png, gif\n              </div>\n            </label>\n          </div>\n          <div className=\"content\">\n            <p\n              contentEditable={true}\n              ref={contentRef}\n              suppressContentEditableWarning={true}\n              onKeyDown={(e) => {\n                if (contentRef.current.offsetHeight > 300 && e.keyCode !== 8) {\n                  const test = contentRef.current.childNodes;\n                  test[test.length - 1].remove();\n                }\n              }}\n              onInput={(e) => {\n                dispatch({\n                  type: \"@layouts/CHANGE_SUMMARY\",\n                  payload: contentRef.current.innerHTML,\n                  idx,\n                });\n              }}\n              onSelect={(e) => {\n                const select = window.getSelection();\n                const style = window.getComputedStyle(\n                  select.focusNode.parentNode\n                );\n                const fontSize = parseInt(style.fontSize);\n                const align = style.textAlign;\n                const bold = document.queryCommandState(\"bold\");\n                const underline = document.queryCommandState(\"underline\");\n                const color = document.queryCommandValue(\"ForeColor\");\n                if (\n                  select.focusNode.localName === undefined &&\n                  fontSize !== status.size\n                ) {\n                  dispatch({\n                    type: \"@test/CHANGE_SIZE\",\n                    payload: fontSize,\n                  });\n                }\n                if (underline !== status.underline) {\n                  dispatch({\n                    type: \"@test/CHANGE_UNDER\",\n                    payload: underline,\n                  });\n                }\n                if (bold !== status.bold) {\n                  dispatch({\n                    type: \"@test/CHANGE_BOLD\",\n                    payload: bold,\n                  });\n                }\n                if (align !== status.align && align !== \"start\") {\n                  dispatch({\n                    type: \"@test/CHANGE_ALIGN\",\n                    payload: align,\n                  });\n                }\n                if (color !== status.color) {\n                  dispatch({\n                    type: \"@test/CHANGE_COLOR\",\n                    payload: color,\n                  });\n                }\n              }}\n            ></p>\n            <div className=\"list\">\n              <Label\n                onMouseOver={() => {\n                  if (images[0]) {\n                    setNowIdx(0);\n                  }\n                }}\n              >\n                <label>\n                  {images[0] ? (\n                    <img className=\"sub-image\" src={images[0].img} alt=\"\" />\n                  ) : undefined}\n                  <img\n                    className=\"list-img\"\n                    src=\"/assets/editor/grey-plus.png\"\n                    alt=\"추가\"\n                  />\n                  <input\n                    type=\"file\"\n                    accept=\"image/x-png,image/gif,image/jpeg\"\n                    onChange={(e) => {\n                      __updateImage(0, e.target.files[0]);\n                    }}\n                  />\n                </label>\n              </Label>\n              <Label\n                onMouseOver={() => {\n                  if (images[1]) {\n                    setNowIdx(1);\n                  }\n                }}\n              >\n                <label>\n                  {images[1] ? (\n                    <img className=\"sub-image\" src={images[1].img} alt=\"\" />\n                  ) : undefined}\n                  <img\n                    className=\"list-img\"\n                    src=\"/assets/editor/grey-plus.png\"\n                    alt=\"추가\"\n                  />\n                  <input\n                    type=\"file\"\n                    accept=\"image/x-png,image/gif,image/jpeg\"\n                    onChange={(e) => {\n                      __updateImage(1, e.target.files[0]);\n                    }}\n                  />\n                </label>\n              </Label>\n              <Label\n                onMouseOver={() => {\n                  if (images[2]) {\n                    setNowIdx(2);\n                  }\n                }}\n              >\n                <label>\n                  {images[2] ? (\n                    <img className=\"sub-image\" src={images[2].img} alt=\"\" />\n                  ) : undefined}\n                  <img\n                    className=\"list-img\"\n                    src=\"/assets/editor/grey-plus.png\"\n                    alt=\"추가\"\n                  />\n                  <input\n                    type=\"file\"\n                    accept=\"image/x-png,image/gif,image/jpeg\"\n                    onChange={(e) => {\n                      __updateImage(2, e.target.files[0]);\n                    }}\n                  />\n                </label>\n              </Label>\n            </div>\n          </div>\n        </Wrapper>\n      </div>\n      {!template[idx + 1] || template[idx + 1].type !== \"TITLE\" ? (\n        <TemplateEmty idx={idx + 1} />\n      ) : undefined}\n    </>\n  );\n}\n\nexport default Summary;\n"]},"metadata":{},"sourceType":"module"}