{"ast":null,"code":"var _jsxFileName = \"/Users/gwagbyeongjun/Sourcecode/react/aju-office/src/components/Editor/components/UploadFile.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useCallback, useState } from 'react';\nimport firebaseApp from '@config/firebaseApp';\nimport { useDispatch } from 'react-redux';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Fstorage = firebaseApp.storage();\n\nfunction UploadFile({\n  __close,\n  template\n}) {\n  _s();\n\n  const dispatch = useDispatch();\n  const [File, setFile] = useState(undefined);\n\n  const __uploadFile = useCallback(item => {\n    return new Promise((resolve, reject) => {\n      Fstorage.ref(`/editor/files/${item.name}`).put(item).then(res => {\n        res.ref.getDownloadURL().then(url => {\n          resolve({\n            type: 'FILE',\n            content: {\n              title: item.name,\n              url\n            },\n            id: `file-${new Date().getTime() - Math.floor(Math.random() * (100 - 1 + 1)) + 1}`\n          });\n        });\n      });\n    });\n  }, []);\n\n  const __readFile = useCallback(() => {\n    const arr = template.slice();\n    let fileList = Object.values(File);\n    Promise.all(fileList.map(async (item, idx) => {\n      const result = await __uploadFile(item).then(result => {\n        return result;\n      });\n      return result;\n    })).then(result => {\n      dispatch({\n        type: '@layouts/CHANGE_EDITOR',\n        payload: [...arr, ...result]\n      });\n\n      __close();\n    });\n  }, [File, dispatch, __close, template, __uploadFile]);\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"popup-wrapper file\",\n    children: [/*#__PURE__*/_jsxDEV(\"img\", {\n      src: \"/assets/editor/cancel.svg\",\n      alt: \"\",\n      className: \"cancel\",\n      onClick: __close\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"popup-title\",\n      children: \"\\uD30C\\uC77C \\uC5C5\\uB85C\\uB4DC\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"content-wrapper file-content\",\n      onDrop: e => {\n        setFile(e.dataTransfer.files); // __readFile(e.dataTransfer.files);\n\n        e.stopPropagation();\n        e.preventDefault();\n      },\n      onDragOver: e => {\n        e.stopPropagation();\n        e.preventDefault();\n      },\n      children: /*#__PURE__*/_jsxDEV(\"label\", {\n        className: \"file-insert\",\n        style: File ? {\n          backgroundColor: 'rgb(234,244,252)'\n        } : undefined,\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: `/assets/editor/${File ? 'blue-' : ''}document.svg`,\n          alt: \"insert\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"insert-title\",\n          style: File ? {\n            color: '#3597ec'\n          } : undefined,\n          children: File ? File.length > 1 ? `${File[0].name} 외 ${File.length - 1}개` : `${File[0].name}` : '파일을 선택 또는 드래그해주세요'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          multiple: true,\n          style: {\n            display: 'none'\n          },\n          onChange: e => {\n            setFile(e.target.files); // __readFile(e.target.files);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"link-btn file-btn\",\n      style: File ? undefined : {\n        backgroundColor: 'grey'\n      },\n      onClick: () => {\n        if (File) {\n          __readFile();\n        }\n      },\n      children: \"\\uB4F1\\uB85D\\uD558\\uAE30\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 49,\n    columnNumber: 5\n  }, this);\n}\n\n_s(UploadFile, \"grVJzfxEq7MaloQNaF9rlPjWvIQ=\", false, function () {\n  return [useDispatch];\n});\n\n_c = UploadFile;\nexport default UploadFile;\n\nvar _c;\n\n$RefreshReg$(_c, \"UploadFile\");","map":{"version":3,"sources":["/Users/gwagbyeongjun/Sourcecode/react/aju-office/src/components/Editor/components/UploadFile.jsx"],"names":["React","useCallback","useState","firebaseApp","useDispatch","Fstorage","storage","UploadFile","__close","template","dispatch","File","setFile","undefined","__uploadFile","item","Promise","resolve","reject","ref","name","put","then","res","getDownloadURL","url","type","content","title","id","Date","getTime","Math","floor","random","__readFile","arr","slice","fileList","Object","values","all","map","idx","result","payload","e","dataTransfer","files","stopPropagation","preventDefault","backgroundColor","color","length","display","target"],"mappings":"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","sourcesContent":["import React, { useCallback, useState } from 'react';\nimport firebaseApp from '@config/firebaseApp';\nimport { useDispatch } from 'react-redux';\nconst Fstorage = firebaseApp.storage();\nfunction UploadFile({ __close, template }) {\n  const dispatch = useDispatch();\n  const [File, setFile] = useState(undefined);\n  const __uploadFile = useCallback((item) => {\n    return new Promise((resolve, reject) => {\n      Fstorage.ref(`/editor/files/${item.name}`)\n        .put(item)\n        .then((res) => {\n          res.ref.getDownloadURL().then((url) => {\n            resolve({\n              type: 'FILE',\n              content: {\n                title: item.name,\n                url,\n              },\n              id: `file-${\n                new Date().getTime() -\n                Math.floor(Math.random() * (100 - 1 + 1)) +\n                1\n              }`,\n            });\n          });\n        });\n    });\n  }, []);\n  const __readFile = useCallback(() => {\n    const arr = template.slice();\n    let fileList = Object.values(File);\n    Promise.all(\n      fileList.map(async (item, idx) => {\n        const result = await __uploadFile(item).then((result) => {\n          return result;\n        });\n        return result;\n      }),\n    ).then((result) => {\n      dispatch({\n        type: '@layouts/CHANGE_EDITOR',\n        payload: [...arr, ...result],\n      });\n      __close();\n    });\n  }, [File, dispatch, __close, template, __uploadFile]);\n  return (\n    <div className=\"popup-wrapper file\">\n      <img\n        src=\"/assets/editor/cancel.svg\"\n        alt=\"\"\n        className=\"cancel\"\n        onClick={__close}\n      />\n      <div className=\"popup-title\">파일 업로드</div>\n      <div\n        className=\"content-wrapper file-content\"\n        onDrop={(e) => {\n          setFile(e.dataTransfer.files);\n          // __readFile(e.dataTransfer.files);\n          e.stopPropagation();\n          e.preventDefault();\n        }}\n        onDragOver={(e) => {\n          e.stopPropagation();\n          e.preventDefault();\n        }}\n      >\n        <label\n          className=\"file-insert\"\n          style={File ? { backgroundColor: 'rgb(234,244,252)' } : undefined}\n        >\n          <img\n            src={`/assets/editor/${File ? 'blue-' : ''}document.svg`}\n            alt=\"insert\"\n          />\n          <div\n            className=\"insert-title\"\n            style={File ? { color: '#3597ec' } : undefined}\n          >\n            {File\n              ? File.length > 1\n                ? `${File[0].name} 외 ${File.length - 1}개`\n                : `${File[0].name}`\n              : '파일을 선택 또는 드래그해주세요'}\n          </div>\n          <input\n            type=\"file\"\n            multiple={true}\n            style={{ display: 'none' }}\n            onChange={(e) => {\n              setFile(e.target.files);\n              // __readFile(e.target.files);\n            }}\n          />\n        </label>\n      </div>\n      <div\n        className=\"link-btn file-btn\"\n        style={File ? undefined : { backgroundColor: 'grey' }}\n        onClick={() => {\n          if (File) {\n            __readFile();\n          }\n        }}\n      >\n        등록하기\n      </div>\n    </div>\n  );\n}\n\nexport default UploadFile;\n"]},"metadata":{},"sourceType":"module"}