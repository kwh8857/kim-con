{"code":"!function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&\"object\"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:t}),2&n&&\"string\"!=typeof t)for(var i in t)e.d(r,i,function(e){return t[e]}.bind(null,i));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,\"a\",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p=\"\",e(e.s=7)}([function(t,e,n){\"use strict\";function r(t,e){function n(){this.constructor=t}if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Class extends value \"+e+\" is not a constructor or null\");c(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function i(t,e,n,r){function i(t){return t instanceof n?t:new n(function(e){e(t)})}return new(n||(n=Promise))(function(n,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?n(t.value):i(t.value).then(s,a)}u((r=r.apply(t,e||[])).next())})}function o(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(i)throw new TypeError(\"Generator is already executing.\");for(;u;)try{if(i=1,o&&(s=2&n[0]?o.return:n[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,n[1])).done)return s;switch(o=0,s&&(n=[2&n[0],s.value]),n[0]){case 0:case 1:s=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,o=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){u.label=n[1];break}if(6===n[0]&&u.label<s[1]){u.label=s[1],s=n;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(n);break}s[2]&&u.ops.pop(),u.trys.pop();continue}n=e.call(t,u)}catch(t){n=[6,t],o=0}finally{i=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,s,a,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},\"function\"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a}function s(t){var e=\"function\"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&\"number\"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?\"Object is not iterable.\":\"Symbol.iterator is not defined.\")}function a(t,e){var n=\"function\"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function u(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)(r||!(i in e))&&(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||e)}n.d(e,\"c\",function(){return r}),n.d(e,\"a\",function(){return h}),n.d(e,\"b\",function(){return i}),n.d(e,\"d\",function(){return o}),n.d(e,\"g\",function(){return s}),n.d(e,\"e\",function(){return a}),n.d(e,\"f\",function(){return u});var c=function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},h=function(){return(h=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.create,Object.create},function(t,e,n){\"use strict\";var r=String.fromCharCode;(function(t){\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nfunction i(t){return o(void 0,t)}function o(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&s(n)&&(t[n]=o(t[n],e[n]));return t}function s(t){return\"__proto__\"!==t}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2021 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function a(t,e){if(t.uid)throw new Error('The \"uid\" field is no longer supported by mockUserToken. Please use \"sub\" instead for Firebase Auth User ID.');var n=e||\"demo-project\",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error(\"mockUserToken must contain 'sub' or 'user_id' field!\");var o=Object(E.a)({iss:\"https://securetoken.google.com/\"+n,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:\"custom\",identities:{}}},t);return[_.encodeString(JSON.stringify({alg:\"none\",type:\"JWT\"}),!1),_.encodeString(JSON.stringify(o),!1),\"\"].join(\".\")}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function u(){return\"undefined\"!=typeof navigator&&\"string\"==typeof navigator.userAgent?navigator.userAgent:\"\"}function c(){return\"undefined\"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(u())}function h(){try{return\"[object process]\"===Object.prototype.toString.call(t.process)}catch(t){return!1}}function l(){return\"object\"==typeof self&&self.self===self}function f(){var t=\"object\"==typeof chrome?chrome.runtime:\"object\"==typeof browser?browser.runtime:void 0;return\"object\"==typeof t&&void 0!==t.id}function d(){return\"object\"==typeof navigator&&\"ReactNative\"===navigator.product}function p(){return 0<=u().indexOf(\"Electron/\")}function y(){var t=u();return 0<=t.indexOf(\"MSIE \")||0<=t.indexOf(\"Trident/\")}function g(){return 0<=u().indexOf(\"MSAppHost/\")}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nfunction v(t,e){return Object.prototype.hasOwnProperty.call(t,e)}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function m(t,e){var n=new A(t,e);return n.subscribe.bind(n)}function b(){}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2021 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function w(t){return t&&t._delegate?t._delegate:t}n.d(e,\"a\",function(){return I}),n.d(e,\"b\",function(){return O}),n.d(e,\"c\",function(){return v}),n.d(e,\"d\",function(){return a}),n.d(e,\"e\",function(){return m}),n.d(e,\"f\",function(){return i}),n.d(e,\"g\",function(){return o}),n.d(e,\"h\",function(){return w}),n.d(e,\"i\",function(){return u}),n.d(e,\"j\",function(){return l}),n.d(e,\"k\",function(){return f}),n.d(e,\"l\",function(){return p}),n.d(e,\"m\",function(){return y}),n.d(e,\"n\",function(){return c}),n.d(e,\"o\",function(){return h}),n.d(e,\"p\",function(){return d}),n.d(e,\"q\",function(){return g});var E=n(0),_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+\"+/=\"},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+\"-_.\"},HAS_NATIVE_SUPPORT:\"function\"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error(\"encodeByteArray takes an array as a parameter\");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,a=s?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,h=(15&a)<<2|c>>6,l=63&c;u||(l=64,!s&&(h=64)),r.push(n[o>>2],n[(3&o)<<4|a>>4],n[h],n[l])}return r.join(\"\")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(function(t){for(var e,n=[],r=0,i=0;i<t.length;i++)128>(e=t.charCodeAt(i))?n[r++]=e:2048>e?(n[r++]=192|e>>6,n[r++]=128|63&e):55296==(64512&e)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(e=65536+((1023&e)<<10)+(1023&t.charCodeAt(++i)),n[r++]=240|e>>18,n[r++]=128|63&e>>12,n[r++]=128|63&e>>6,n[r++]=128|63&e):(n[r++]=224|e>>12,n[r++]=128|63&e>>6,n[r++]=128|63&e);return n}(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,i=0;n<t.length;){var o=t[n++];if(128>o)e[i++]=r(o);else if(191<o&&224>o){var s=t[n++];e[i++]=r((31&o)<<6|63&s)}else if(239<o&&365>o){var a=((7&o)<<18|(63&(s=t[n++]))<<12|(63&(u=t[n++]))<<6|63&t[n++])-65536;e[i++]=r(55296+(a>>10)),e[i++]=r(56320+(1023&a))}else{s=t[n++];var u=t[n++];e[i++]=r((15&o)<<12|(63&s)<<6|63&u)}}return e.join(\"\")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0,a=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==u)throw Error();r.push(o<<2|s>>4),64!==a&&(r.push(240&s<<4|a>>2),64!==u&&r.push(192&a<<6|u))}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},I=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),\"function\"==typeof t&&(e.promise.catch(function(){}),1===t.length?t(n):t(n,r))}},t}(),T=function(t){function e(n,r,i){var o=t.call(this,r)||this;return o.code=n,o.customData=i,o.name=\"FirebaseError\",Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,O.prototype.create),o}return Object(E.c)(e,t),e}(Error),O=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+\"/\"+t,o=this.errors[t],s=o?function(t,e){return t.replace(S,function(t,n){var r=e[n];return null==r?\"<\"+n+\"?>\":r+\"\"})}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */(o,r):\"Error\",a=this.serviceName+\": \"+s+\" (\"+i+\").\";return new T(i,a,r)},t}(),S=/\\{\\$([^}]+)}/g,A=(function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if(\"string\"==typeof t)for(var r=0;16>r;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;16>r;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;80>r;r++)l=n[r-3]^n[r-8]^n[r-14]^n[r-16],n[r]=4294967295&(l<<1|l>>>31);var i,o,s=this.chain_[0],a=this.chain_[1],u=this.chain_[2],c=this.chain_[3],h=this.chain_[4];for(r=0;80>r;r++){40>r?20>r?(i=c^a&(u^c),o=1518500249):(i=a^u^c,o=1859775393):60>r?(i=a&u|c&(a|u),o=2400959708):(i=a^u^c,o=3395469782);var l=4294967295&(s<<5|s>>>27)+i+h+o+n[r];h=c,c=u,u=4294967295&(a<<30|a>>>2),a=s,s=l}this.chain_[0]=4294967295&this.chain_[0]+s,this.chain_[1]=4294967295&this.chain_[1]+a,this.chain_[2]=4294967295&this.chain_[2]+u,this.chain_[3]=4294967295&this.chain_[3]+c,this.chain_[4]=4294967295&this.chain_[4]+h},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if(\"string\"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;56>this.inbuf_?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;56<=n;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;5>n;n++)for(var i=24;0<=i;i-=8)t[r]=255&this.chain_[n]>>i,++r;return t}}(),function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(function(){t(n)}).catch(function(t){n.error(t)})}return t.prototype.next=function(t){this.forEachObserver(function(e){e.next(t)})},t.prototype.error=function(t){this.forEachObserver(function(e){e.error(t)}),this.close(t)},t.prototype.complete=function(){this.forEachObserver(function(t){t.complete()}),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error(\"Missing Observer.\");void 0===(r=function(t,e){if(\"object\"!=typeof t||null===t)return!1;for(var n,r=0,i=e;r<i.length;r++)if((n=i[r])in t&&\"function\"==typeof t[n])return!0;return!1}(t,[\"next\",\"error\",\"complete\"])?t:{next:t,error:e,complete:n}).next&&(r.next=b),void 0===r.error&&(r.error=b),void 0===r.complete&&(r.complete=b);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}}),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0===this.observers||void 0===this.observers[t]||(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){\"undefined\"!=typeof console&&console.error&&console.error(t)}})},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(function(){e.observers=void 0,e.onNoObservers=void 0}))},t}());\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */}).call(this,n(5))},function(t,e,n){\"use strict\";var r=Math.max,i=Math.floor;(function(t){function o(){return vi.logLevel}function s(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(vi.logLevel<=fi.a.DEBUG){var r=e.map(c);vi.debug.apply(vi,Object(hi.f)([\"Firestore (8.7.0): \"+t],r))}}function a(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(vi.logLevel<=fi.a.ERROR){var r=e.map(c);vi.error.apply(vi,Object(hi.f)([\"Firestore (8.7.0): \"+t],r))}}function u(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(vi.logLevel<=fi.a.WARN){var r=e.map(c);vi.warn.apply(vi,Object(hi.f)([\"Firestore (8.7.0): \"+t],r))}}function c(t){if(\"string\"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function h(t){void 0===t&&(t=\"Unexpected state\");var e=\"FIRESTORE (8.7.0) INTERNAL ASSERTION FAILED: \"+t;throw a(e),new Error(e)}function l(t){t||h()}function f(t){return t}\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function d(t){var e=\"undefined\"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&\"function\"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=i(256*Math.random());return n}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function p(t,e){return t<e?-1:t>e?1:0}function y(t,e,n){return t.length===e.length&&t.every(function(t,r){return n(t,e[r])})}function g(t){return t+\"\\0\"}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function v(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function m(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function b(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function w(t){if(l(!!t),\"string\"==typeof t){var e=0,n=Ni.exec(t);if(l(!!n),n[1]){var r=n[1];e=+(r=(r+\"000000000\").substr(0,9))}var o=new Date(t);return{seconds:i(o.getTime()/1e3),nanos:e}}return{seconds:E(t.seconds),nanos:E(t.nanos)}}function E(t){return\"number\"==typeof t?t:\"string\"==typeof t?+t:0}function _(t){return\"string\"==typeof t?Si.fromBase64String(t):Si.fromUint8Array(t)}\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function I(t){var e,n;return\"server_timestamp\"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function T(t){var e=w(t.mapValue.fields.__local_write_time__.timestampValue);return new bi(e.seconds,e.nanos)}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function O(t){return null==t}function S(t){return 0===t&&1/t==-1/0}function A(t){return\"number\"==typeof t&&Number.isInteger(t)&&!S(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function D(t){return\"nullValue\"in t?0:\"booleanValue\"in t?1:\"integerValue\"in t||\"doubleValue\"in t?2:\"timestampValue\"in t?3:\"stringValue\"in t?5:\"bytesValue\"in t?6:\"referenceValue\"in t?7:\"geoPointValue\"in t?8:\"arrayValue\"in t?9:\"mapValue\"in t?I(t)?4:10:h()}function N(t,e){var n=D(t);return n===D(e)&&(!(0!==n)||(1===n?t.booleanValue===e.booleanValue:4===n?T(t).isEqual(T(e)):3===n?function(t,e){if(\"string\"==typeof t.timestampValue&&\"string\"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=w(t.timestampValue),r=w(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e):5===n?t.stringValue===e.stringValue:6===n?function(e,n){return _(t.bytesValue).isEqual(_(n.bytesValue))}(0,e):7===n?t.referenceValue===e.referenceValue:8===n?function(t,e){return E(t.geoPointValue.latitude)===E(e.geoPointValue.latitude)&&E(t.geoPointValue.longitude)===E(e.geoPointValue.longitude)}(t,e):2===n?function(t,e){if(\"integerValue\"in t&&\"integerValue\"in e)return E(t.integerValue)===E(e.integerValue);if(\"doubleValue\"in t&&\"doubleValue\"in e){var n=E(t.doubleValue),r=E(e.doubleValue);return n===r?S(n)===S(r):isNaN(n)&&isNaN(r)}return!1}(t,e):9===n?y(t.arrayValue.values||[],e.arrayValue.values||[],N):10===n?function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(v(n)!==v(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!N(n[i],r[i])))return!1;return!0}(t,e):h()))}function C(t,e){return void 0!==(t.values||[]).find(function(t){return N(t,e)})}function j(t,e){var n=D(t),r=D(e);if(n!==r)return p(n,r);switch(n){case 0:return 0;case 1:return p(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=E(t.integerValue||t.doubleValue),r=E(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return k(t.timestampValue,e.timestampValue);case 4:return k(T(t),T(e));case 5:return p(t.stringValue,e.stringValue);case 6:return function(t,e){var n=_(t),r=_(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n,r=t.split(\"/\"),i=e.split(\"/\"),o=0;o<r.length&&o<i.length;o++)if(0!==(n=p(r[o],i[o])))return n;return p(r.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=p(E(t.latitude),E(e.latitude));return 0===n?p(E(t.longitude),E(e.longitude)):n}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n,r=t.values||[],i=e.values||[],o=0;o<r.length&&o<i.length;++o)if(n=j(r[o],i[o]))return n;return p(r.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s,a=0;a<r.length&&a<o.length;++a){if(0!==(s=p(r[a],o[a])))return s;var u=j(n[r[a]],i[o[a]]);if(0!==u)return u}return p(r.length,o.length)}(t.mapValue,e.mapValue);default:throw h()}}function k(t,e){if(\"string\"==typeof t&&\"string\"==typeof e&&t.length===e.length)return p(t,e);var n=w(t),r=w(e),i=p(n.seconds,r.seconds);return 0===i?p(n.nanos,r.nanos):i}function R(t){return function t(e){return\"nullValue\"in e?\"null\":\"booleanValue\"in e?\"\"+e.booleanValue:\"integerValue\"in e?\"\"+e.integerValue:\"doubleValue\"in e?\"\"+e.doubleValue:\"timestampValue\"in e?function(t){var e=w(t);return\"time(\"+e.seconds+\",\"+e.nanos+\")\"}(e.timestampValue):\"stringValue\"in e?e.stringValue:\"bytesValue\"in e?_(e.bytesValue).toBase64():\"referenceValue\"in e?(r=e.referenceValue,Ci.fromName(r).toString()):\"geoPointValue\"in e?\"geo(\"+(n=e.geoPointValue).latitude+\",\"+n.longitude+\")\":\"arrayValue\"in e?function(e){for(var n=\"[\",r=!0,i=0,o=e.values||[];i<o.length;i++)r?r=!1:n+=\",\",n+=t(o[i]);return n+\"]\"}(e.arrayValue):\"mapValue\"in e?function(e){for(var n,r=\"{\",i=!0,o=0,s=Object.keys(e.fields||{}).sort();o<s.length;o++)n=s[o],i?i=!1:r+=\",\",r+=n+\":\"+t(e.fields[n]);return r+\"}\"}(e.mapValue):h();var n,r}(t)}function x(t,e){return{referenceValue:\"projects/\"+t.projectId+\"/databases/\"+t.database+\"/documents/\"+e.path.canonicalString()}}function L(t){return!!t&&\"integerValue\"in t}function P(t){return!!t&&\"arrayValue\"in t}function M(t){return!!t&&\"nullValue\"in t}function F(t){return!!t&&\"doubleValue\"in t&&isNaN(+t.doubleValue)}function V(t){return!!t&&\"mapValue\"in t}function U(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue)return{timestampValue:Object.assign({},w(t.timestampValue))};if(t.mapValue){var e={mapValue:{fields:{}}};return m(t.mapValue.fields,function(t,n){return e.mapValue.fields[t]=U(n)}),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=U(t.arrayValue.values[r]);return n}return Object.assign({},t)}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function q(t){var e=[];return m(t.fields,function(t,n){var r=new Ti([t]);if(V(n)){var i=q(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o,s=0,a=i;s<a.length;s++)o=a[s],e.push(r.child(o))}else e.push(r)}),new Oi(e)\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */}\n/**\n * @license\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function B(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Ri(t,e,n,r,i,o,s)}function K(t){var e=f(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+=\"|cg:\"+e.collectionGroup),n+=\"|f:\",n+=e.filters.map(function(t){return function(t){return t.field.canonicalString()+t.op.toString()+R(t.value)}(t)}).join(\",\"),n+=\"|ob:\",n+=e.orderBy.map(function(t){return function(t){return t.field.canonicalString()+t.dir}(t)}).join(\",\"),O(e.limit)||(n+=\"|l:\",n+=e.limit),e.startAt&&(n+=\"|lb:\",n+=H(e.startAt)),e.endAt&&(n+=\"|ub:\",n+=H(e.endAt)),e.h=n}return e.h}function z(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!W(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!N(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!X(t.startAt,e.startAt)&&X(t.endAt,e.endAt)}function G(t){return Ci.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}function Q(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return Ci.fromName(t.referenceValue)})}function H(t){return(t.before?\"b\":\"a\")+\":\"+t.position.map(function(t){return R(t)}).join(\",\")}function W(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function Y(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.isKeyField()?Ci.comparator(Ci.fromName(s.referenceValue),n.key):j(s,n.data.field(o.field)),\"desc\"===o.dir&&(r*=-1),0!==r)break}return t.before?0>=r:0>r}function X(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!N(t.position[n],e.position[n]))return!1;return!0}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function $(t,e,n,r,i,o,s,a){return new zi(t,e,n,r,i,o,s,a)}function J(t){return new zi(t)}function Z(t){return!O(t.limit)&&\"F\"===t.limitType}function tt(t){return!O(t.limit)&&\"L\"===t.limitType}function et(t){return 0<t.explicitOrderBy.length?t.explicitOrderBy[0].field:null}function nt(t){for(var e,n=0,r=t.filters;n<r.length;n++)if((e=r[n]).g())return e.field;return null}function rt(t){return null!==t.collectionGroup}function it(t){var e=f(t);if(null===e.p){e.p=[];var n=nt(e),r=et(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new Ki(n)),e.p.push(new Ki(Ti.keyField(),\"asc\"));else{for(var i,o=!1,s=0,a=e.explicitOrderBy;s<a.length;s++)i=a[s],e.p.push(i),i.field.isKeyField()&&(o=!0);if(!o){var u=0<e.explicitOrderBy.length?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:\"asc\";e.p.push(new Ki(Ti.keyField(),u))}}}return e.p}function ot(t){var e=f(t);if(!e.T)if(\"F\"===e.limitType)e.T=B(e.path,e.collectionGroup,it(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=it(e);r<i.length;r++){var o=i[r],s=\"desc\"===o.dir?\"asc\":\"desc\";n.push(new Ki(o.field,s))}var a=e.endAt?new Bi(e.endAt.position,!e.endAt.before):null,u=e.startAt?new Bi(e.startAt.position,!e.startAt.before):null;e.T=B(e.path,e.collectionGroup,n,e.filters,e.limit,a,u)}return e.T}function st(t,e,n){return new zi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function at(t,e){return z(ot(t),ot(e))&&t.limitType===e.limitType}function ut(t){return K(ot(t))+\"|lt:\"+t.limitType}function ct(t){return\"Query(target=\"+(e=ot(t),n=e.path.canonicalString(),null!==e.collectionGroup&&(n+=\" collectionGroup=\"+e.collectionGroup),0<e.filters.length&&(n+=\", filters: [\"+e.filters.map(function(t){return(e=t).field.canonicalString()+\" \"+e.op+\" \"+R(e.value);var e}).join(\", \")+\"]\"),O(e.limit)||(n+=\", limit: \"+e.limit),0<e.orderBy.length&&(n+=\", orderBy: [\"+e.orderBy.map(function(t){return function(t){return t.field.canonicalString()+\" (\"+t.dir+\")\"}(t)}).join(\", \")+\"]\"),e.startAt&&(n+=\", startAt: \"+H(e.startAt)),e.endAt&&(n+=\", endAt: \"+H(e.endAt)),\"Target(\"+n+\")\")+\"; limitType=\"+t.limitType+\")\";var e,n}function ht(t,e){return e.isFoundDocument()&&function(t,e){var n=e.key.path;return null===t.collectionGroup?Ci.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n):e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n)}(t,e)&&function(t,e){for(var n,r=0,i=t.explicitOrderBy;r<i.length;r++)if(!(n=i[r]).field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return(!t.startAt||Y(t.startAt,it(t),e))&&(!t.endAt||!Y(t.endAt,it(t),e))}(t,e)}function lt(t){return function(e,n){for(var r=!1,i=0,o=it(t);i<o.length;i++){var s=o[i],a=ft(s,e,n);if(0!==a)return a;r=r||s.field.isKeyField()}return 0}}function ft(t,e,n){var r=t.field.isKeyField()?Ci.comparator(e.key,n.key):function(t,e,n){var r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?j(r,i):h()}(t.field,e,n);switch(t.dir){case\"asc\":return r;case\"desc\":return-1*r;default:return h()}}\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function dt(t,e){if(t.I){if(isNaN(e))return{doubleValue:\"NaN\"};if(e===1/0)return{doubleValue:\"Infinity\"};if(e===-1/0)return{doubleValue:\"-Infinity\"}}return{doubleValue:S(e)?\"-0\":e}}function pt(t){return{integerValue:\"\"+t}}function yt(t,e){return A(e)?pt(e):dt(t,e)}\n/**\n * @license\n * Copyright 2018 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function gt(t,e,n){return t instanceof Qi?function(t,e){var n={fields:{__type__:{stringValue:\"server_timestamp\"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Hi?bt(t,e):t instanceof Wi?wt(t,e):function(t,e){var n=mt(t,e),r=Et(n)+Et(t.A);return L(n)&&L(t.A)?pt(r):dt(t.R,r)}(t,e)}function vt(t,e,n){return t instanceof Hi?bt(t,e):t instanceof Wi?wt(t,e):n}function mt(t,e){return t instanceof Yi?L(n=e)||function(t){return!!t&&\"doubleValue\"in t}(n)?e:{integerValue:0}:null;var n}function bt(t,e){for(var n=_t(e),r=function(t){n.some(function(e){return N(e,t)})||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}function wt(t,e){for(var n=_t(e),r=function(t){n=n.filter(function(e){return!N(e,t)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}function Et(t){return E(t.integerValue||t.doubleValue)}function _t(t){return P(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function It(t,e){return void 0===t.updateTime?void 0===t.exists||t.exists===e.isFoundDocument():e.isFoundDocument()&&e.version.isEqual(t.updateTime)}function Tt(t,e,n){t instanceof to?function(t,e,n){var r=t.value.clone(),i=Ct(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof eo?function(t,e,n){if(It(t.precondition,e)){var r=Ct(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(Nt(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Ot(t,e,n){t instanceof to?function(t,e,n){if(It(t.precondition,e)){var r=t.value.clone(),i=jt(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(Dt(e),r).setHasLocalMutations()}}(t,e,n):t instanceof eo?function(t,e,n){if(It(t.precondition,e)){var r=jt(t.fieldTransforms,n,e),i=e.data;i.setAll(Nt(t)),i.setAll(r),e.convertToFoundDocument(Dt(e),i).setHasLocalMutations()}}(t,e,n):function(e,n){It(t.precondition,n)&&n.convertToNoDocument(wi.min())}(0,e)}function St(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e.data.field(o.field),a=mt(o.transform,s||null);null!=a&&(null==n&&(n=ji.empty()),n.set(o.field,a))}return n||null}function At(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||t&&e&&y(t,e,function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Hi&&e instanceof Hi||t instanceof Wi&&e instanceof Wi?y(t.elements,e.elements,N):t instanceof Yi&&e instanceof Yi?N(t.A,e.A):t instanceof Qi&&e instanceof Qi}(t.transform,e.transform)}(t,e)})}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function Dt(t){return t.isFoundDocument()?t.version:wi.min()}function Nt(t){var e=new Map;return t.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}}),e}function Ct(t,e,n){var r=new Map;l(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,vt(s,a,n[i]))}return r}function jt(t,e,n){for(var r=new Map,i=0,o=t;i<o.length;i++){var s=o[i],a=s.transform,u=n.data.field(s.field);r.set(s.field,gt(a,u,e))}return r}function kt(t){return t===yi.OK?h():t!==yi.CANCELLED&&t!==yi.UNKNOWN&&t!==yi.DEADLINE_EXCEEDED&&t!==yi.RESOURCE_EXHAUSTED&&t!==yi.INTERNAL&&t!==yi.UNAVAILABLE&&t!==yi.UNAUTHENTICATED&&(t===yi.INVALID_ARGUMENT||t===yi.NOT_FOUND||t===yi.ALREADY_EXISTS||t===yi.PERMISSION_DENIED||t===yi.FAILED_PRECONDITION||t===yi.ABORTED||t===yi.OUT_OF_RANGE||t===yi.UNIMPLEMENTED||t===yi.DATA_LOSS||h())}function Rt(t){return void 0===t?(a(\"GRPC error has no .code\"),yi.UNKNOWN):t===Ai.OK?yi.OK:t===Ai.CANCELLED?yi.CANCELLED:t===Ai.UNKNOWN?yi.UNKNOWN:t===Ai.DEADLINE_EXCEEDED?yi.DEADLINE_EXCEEDED:t===Ai.RESOURCE_EXHAUSTED?yi.RESOURCE_EXHAUSTED:t===Ai.INTERNAL?yi.INTERNAL:t===Ai.UNAVAILABLE?yi.UNAVAILABLE:t===Ai.UNAUTHENTICATED?yi.UNAUTHENTICATED:t===Ai.INVALID_ARGUMENT?yi.INVALID_ARGUMENT:t===Ai.NOT_FOUND?yi.NOT_FOUND:t===Ai.ALREADY_EXISTS?yi.ALREADY_EXISTS:t===Ai.PERMISSION_DENIED?yi.PERMISSION_DENIED:t===Ai.FAILED_PRECONDITION?yi.FAILED_PRECONDITION:t===Ai.ABORTED?yi.ABORTED:t===Ai.OUT_OF_RANGE?yi.OUT_OF_RANGE:t===Ai.UNIMPLEMENTED?yi.UNIMPLEMENTED:t===Ai.DATA_LOSS?yi.DATA_LOSS:h()}function xt(){return ho}function Lt(){return lo}function Pt(){return fo}function Mt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n,r=po,i=0,o=t;i<o.length;i++)n=o[i],r=r.add(n);return r}function Ft(){return yo}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function Vt(){return new oo(Ci.comparator)}function Ut(){return new oo(Ci.comparator)}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function qt(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\\.\\d*/,\"\").replace(\"Z\",\"\")+\".\"+(\"000000000\"+e.nanoseconds).slice(-9)+\"Z\":{seconds:\"\"+e.seconds,nanos:e.nanoseconds}}function Bt(t,e){return t.I?e.toBase64():e.toUint8Array()}function Kt(t){return l(!!t),wi.fromTimestamp((e=w(t),new bi(e.seconds,e.nanos)));var e}function zt(t,e){return(n=t,new _i([\"projects\",n.projectId,\"databases\",n.database])).child(\"documents\").child(e).canonicalString();var n}function Gt(t){var e=_i.fromString(t);return l(ce(e)),e}function Qt(t,e){return zt(t.databaseId,e.path)}function Ht(t,e){var n=Gt(e);if(n.get(1)!==t.databaseId.projectId)throw new gi(yi.INVALID_ARGUMENT,\"Tried to deserialize key from different project: \"+n.get(1)+\" vs \"+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new gi(yi.INVALID_ARGUMENT,\"Tried to deserialize key from different database: \"+n.get(3)+\" vs \"+t.databaseId.database);return new Ci($t(n))}function Wt(t,e){return zt(t.databaseId,e)}function Yt(t){var e=Gt(t);return 4===e.length?_i.emptyPath():$t(e)}function Xt(t){return new _i([\"projects\",t.databaseId.projectId,\"databases\",t.databaseId.database]).canonicalString()}function $t(t){return l(4<t.length&&\"documents\"===t.get(4)),t.popFirst(5)}function Jt(t,e,n){return{name:Qt(t,e),fields:n.value.mapValue.fields}}function Zt(t,e,n){var r=Ht(t,e.name),i=Kt(e.updateTime),o=new ji({mapValue:{fields:e.fields}}),s=ki.newFoundDocument(r,i,o);return n&&s.setHasCommittedMutations(),n?s.setHasCommittedMutations():s}function te(t,e){var n;if(e instanceof to)n={update:Jt(t,e.key,e.value)};else if(e instanceof no)n={delete:Qt(t,e.key)};else if(e instanceof eo)n={update:Jt(t,e.key,e.data),updateMask:function(t){var e=[];return t.fields.forEach(function(t){return e.push(t.canonicalString())}),{fieldPaths:e}}(e.fieldMask)};else{if(!(e instanceof ro))return h();n={verify:Qt(t,e.key)}}return 0<e.fieldTransforms.length&&(n.updateTransforms=e.fieldTransforms.map(function(t){return function(t,e){var n=e.transform;if(n instanceof Qi)return{fieldPath:e.field.canonicalString(),setToServerValue:\"REQUEST_TIME\"};if(n instanceof Hi)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Wi)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Yi)return{fieldPath:e.field.canonicalString(),increment:n.A};throw h()}(0,t)})),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0===e.updateTime?void 0===e.exists?h():{exists:e.exists}:{updateTime:function(t,e){return qt(t,e.toTimestamp())}(t,e.updateTime)}}(t,e.precondition)),n}function ee(t,e){var n=e.currentDocument?function(t){return void 0===t.updateTime?void 0===t.exists?Ji.none():Ji.exists(t.exists):Ji.updateTime(Kt(t.updateTime))}(e.currentDocument):Ji.none(),r=e.updateTransforms?e.updateTransforms.map(function(e){return function(t,e){var n=null;if(\"setToServerValue\"in e)l(\"REQUEST_TIME\"===e.setToServerValue),n=new Qi;else if(\"appendMissingElements\"in e){var r=e.appendMissingElements.values||[];n=new Hi(r)}else if(\"removeAllFromArray\"in e){var i=e.removeAllFromArray.values||[];n=new Wi(i)}else\"increment\"in e?n=new Yi(t,e.increment):h();var o=Ti.fromServerFormat(e.fieldPath);return new Xi(o,n)}(t,e)}):[];if(e.update){e.update.name;var i=Ht(t,e.update.name),o=new ji({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){var e=t.fieldPaths||[];return new Oi(e.map(function(t){return Ti.fromServerFormat(t)}))}(e.updateMask);return new eo(i,o,s,n,r)}return new to(i,o,n,r)}if(e.delete){var a=Ht(t,e.delete);return new no(a,n)}if(e.verify){var u=Ht(t,e.verify);return new ro(u,n)}return h()}function ne(t,e){return{documents:[Wt(t,e.path)]}}function re(t,e){var n={structuredQuery:{}},r=e.path;null===e.collectionGroup?(n.parent=Wt(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]):(n.parent=Wt(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return function(t){if(\"==\"===t.op){if(F(t.value))return{unaryFilter:{field:ae(t.field),op:\"IS_NAN\"}};if(M(t.value))return{unaryFilter:{field:ae(t.field),op:\"IS_NULL\"}}}else if(\"!=\"===t.op){if(F(t.value))return{unaryFilter:{field:ae(t.field),op:\"IS_NOT_NAN\"}};if(M(t.value))return{unaryFilter:{field:ae(t.field),op:\"IS_NOT_NULL\"}}}return{fieldFilter:{field:ae(t.field),op:function(t){return To[t]}(t.op),value:t.value}}}(t)});return 1===e.length?e[0]:{compositeFilter:{op:\"AND\",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return function(t){return{field:ae(t.field),direction:function(t){return Io[t]}(t.dir)}}(t)})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.I||O(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=oe(e.startAt)),e.endAt&&(n.structuredQuery.endAt=oe(e.endAt)),n}function ie(t){var e=Yt(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(0<r){l(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=function t(e){return e?void 0===e.unaryFilter?void 0===e.fieldFilter?void 0===e.compositeFilter?h():e.compositeFilter.filters.map(function(e){return t(e)}).reduce(function(t,e){return t.concat(e)}):[function(t){return xi.create(ue(t.fieldFilter.field),function(t){switch(t){case\"EQUAL\":return\"==\";case\"NOT_EQUAL\":return\"!=\";case\"GREATER_THAN\":return\">\";case\"GREATER_THAN_OR_EQUAL\":return\">=\";case\"LESS_THAN\":return\"<\";case\"LESS_THAN_OR_EQUAL\":return\"<=\";case\"ARRAY_CONTAINS\":return\"array-contains\";case\"IN\":return\"in\";case\"NOT_IN\":return\"not-in\";case\"ARRAY_CONTAINS_ANY\":return\"array-contains-any\";case\"OPERATOR_UNSPECIFIED\":default:return h()}}(t.fieldFilter.op),t.fieldFilter.value)}(e)]:[function(t){switch(t.unaryFilter.op){case\"IS_NAN\":var e=ue(t.unaryFilter.field);return xi.create(e,\"==\",{doubleValue:NaN});case\"IS_NULL\":var n=ue(t.unaryFilter.field);return xi.create(n,\"==\",{nullValue:\"NULL_VALUE\"});case\"IS_NOT_NAN\":var r=ue(t.unaryFilter.field);return xi.create(r,\"!=\",{doubleValue:NaN});case\"IS_NOT_NULL\":var i=ue(t.unaryFilter.field);return xi.create(i,\"!=\",{nullValue:\"NULL_VALUE\"});case\"OPERATOR_UNSPECIFIED\":default:return h()}}(e)]:[]}(n.where));var a=[];n.orderBy&&(a=n.orderBy.map(function(t){return function(t){return new Ki(ue(t.field),function(t){return\"ASCENDING\"===t?\"asc\":\"DESCENDING\"===t?\"desc\":void 0}(t.direction))}(t)}));var u=null;n.limit&&(u=function(t){var e;return O(e=\"object\"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=se(n.startAt));var f=null;return n.endAt&&(f=se(n.endAt)),$(e,i,a,s,u,\"F\",c,f)}function oe(t){return{before:t.before,values:t.position}}function se(t){var e=!!t.before,n=t.values||[];return new Bi(n,e)}function ae(t){return{fieldPath:t.canonicalString()}}function ue(t){return Ti.fromServerFormat(t.fieldPath)}function ce(t){return 4<=t.length&&\"projects\"===t.get(0)&&\"databases\"===t.get(2)}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function he(t){for(var e=\"\",n=0;n<t.length;n++)0<e.length&&(e=fe(e)),e=le(t.get(n),e);return fe(e)}function le(t,e){for(var n,r=e,i=t.length,o=0;o<i;o++)r+=\"\\0\"===(n=t.charAt(o))?\"\u0001\u0010\":\"\u0001\"===n?\"\u0001\u0011\":n;return r}function fe(t){return t+\"\u0001\u0001\"}function de(t){var e=t.length;if(l(2<=e),2===e)return l(\"\u0001\"===t.charAt(0)&&\"\u0001\"===t.charAt(1)),_i.emptyPath();for(var n,r=[],i=\"\",o=0;o<e;){switch((0>(n=t.indexOf(\"\u0001\",o))||n>e-2)&&h(),t.charAt(n+1)){case\"\u0001\":var s=t.substring(o,n),a=void 0;0===i.length?a=s:(a=i+=s,i=\"\"),r.push(a);break;case\"\u0010\":i+=t.substring(o,n),i+=\"\\0\";break;case\"\u0011\":i+=t.substring(o,n+1);break;default:h()}o=n+2}return new _i(r)}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function pe(t){return\"IndexedDbTransactionError\"===t.name}function ye(t){return new Qo(function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=ge(t.target.error);n(e)}})}function ge(t){var e=Wo._t(Object(li.i)());if(12.2<=e&&13>e){var n=\"An internal error was encountered in the Indexed Database server\";if(0<=t.message.indexOf(n)){var r=new gi(\"internal\",\"IOS_INDEXEDDB_BUG1: IndexedDb has thrown '\"+n+\"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.\");return Jo||(Jo=!0,setTimeout(function(){throw r},0)),r}}return t}\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function ve(t,e){var n=f(t);return Wo.It(n.Mt,e)}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function me(t,e){if(e.document)return Zt(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Ci.fromSegments(e.noDocument.path),r=Ie(e.noDocument.readTime),i=ki.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=Ci.fromSegments(e.unknownDocument.path);return r=Ie(e.unknownDocument.version),ki.newUnknownDocument(o,r)}return h()}function be(t,e,n){var r=we(n),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){var o=function(t,e){return{name:Qt(t,e.key),fields:e.data.value.mapValue.fields,updateTime:qt(t,e.version.toTimestamp())}}(t.Lt,e),s=e.hasCommittedMutations;return new Ro(null,null,o,s,r,i)}if(e.isNoDocument()){var a=e.key.path.toArray(),u=_e(e.version);return s=e.hasCommittedMutations,new Ro(null,new jo(a,u),null,s,r,i)}if(e.isUnknownDocument()){var c=e.key.path.toArray(),l=_e(e.version);return new Ro(new ko(c,l),null,null,!0,r,i)}return h()}function we(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Ee(t){var e=new bi(t[0],t[1]);return wi.fromTimestamp(e)}function _e(t){var e=t.toTimestamp();return new So(e.seconds,e.nanoseconds)}function Ie(t){var e=new bi(t.seconds,t.nanoseconds);return wi.fromTimestamp(e)}function Te(t,e){for(var n,r=(e.baseMutations||[]).map(function(e){return ee(t.Lt,e)}),i=0;i<e.mutations.length-1;++i)if(n=e.mutations[i],i+1<e.mutations.length&&void 0!==e.mutations[i+1].transform){var o=e.mutations[i+1];n.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}var s=e.mutations.map(function(e){return ee(t.Lt,e)}),a=bi.fromMillis(e.localWriteTimeMs);return new ts(e.batchId,a,r,s)}function Oe(t){var e,n,r=Ie(t.readTime),i=void 0===t.lastLimboFreeSnapshotVersion?wi.min():Ie(t.lastLimboFreeSnapshotVersion);return void 0===t.query.documents?e=ot(ie(t.query)):(l(1===(n=t.query).documents.length),e=ot(J(Yt(n.documents[0])))),new ns(e,t.targetId,0,t.lastListenSequenceNumber,r,i,Si.fromBase64String(t.resumeToken))}function Se(t,e){var n,r=_e(e.snapshotVersion),i=_e(e.lastLimboFreeSnapshotVersion);n=G(e.target)?ne(t.Lt,e.target):re(t.Lt,e.target);var o=e.resumeToken.toBase64();return new Lo(e.targetId,K(e.target),r,o,e.sequenceNumber,i,n)}function Ae(t){var e=ie({parent:t.parent,structuredQuery:t.structuredQuery});return\"LAST\"===t.limitType?st(e,e.limit,\"L\"):e}\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function De(t){return ve(t,Uo.store)}function Ne(t){return ve(t,qo.store)}\n/**\n * @license\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function Ce(t){return ve(t,Fo.store)}\n/**\n * @license\n * Copyright 2018 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function je(t,e,n){var r=t.store(No.store),i=t.store(Co.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.$t({range:s},function(t,e,n){return a++,n.delete()});o.push(u.next(function(){l(1==a)}));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var d=f[h],p=Co.key(e,d.key.path,n.batchId);o.push(i.delete(p)),c.push(d.key)}return Qo.waitFor(o).next(function(){return c})}function ke(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw h();e=t.noDocument}return JSON.stringify(e).length}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function Re(t,e,n){var r=Co.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Le(t).$t({range:o,kt:!0},function(t,n,r){var o=t[0],a=t[1];t[2],o===e&&a===i&&(s=!0),r.done()}).next(function(){return s})}function xe(t){return ve(t,No.store)}function Le(t){return ve(t,Co.store)}function Pe(t){return ve(t,Do.store)}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function Me(t){return ve(t,Lo.store)}function Fe(t){return ve(t,Mo.store)}function Ve(t){return ve(t,Po.store)}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function Ue(t){return Object(hi.b)(this,void 0,void 0,function(){return Object(hi.d)(this,function(){if(t.code!==yi.FAILED_PRECONDITION||t.message!==Ko)throw t;return s(\"LocalStore\",\"Unexpectedly lost primary lease\"),[2]})})}\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function qe(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=p(n,i);return 0===s?p(r,o):s}function Be(t,e){return Ve(t).put(function(t,e){return new Po(0,he(t.path),e)}(e,t.currentSequenceNumber))}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function Ke(t){return ve(t,xo.store)}function ze(t){return ve(t,Ro.store)}function Ge(t){return t.path.toArray()}\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function Qe(t){t.createObjectStore(Po.store,{keyPath:Po.keyPath}).createIndex(Po.documentTargetsIndex,Po.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Lo.store,{keyPath:Lo.keyPath}).createIndex(Lo.queryTargetsIndexName,Lo.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Mo.store)}function He(t){return ve(t,Ao.store)}function We(t){return ve(t,Vo.store)}function Ye(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+=\".\"+t.database),\"firestore/\"+e+\"/\"+n+\"/\"\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function Xe(t,e,n,r){return new Ds(t,e,n,r)}function $e(t,e){return Object(hi.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(hi.d)(this,function(s){switch(s.label){case 0:return n=f(t),r=n._n,i=n.Mn,[4,n.persistence.runTransaction(\"Handle user change\",\"readonly\",function(t){var o;return n._n.getAllMutationBatches(t).next(function(s){return o=s,r=n.persistence.getMutationQueue(e),i=new Os(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)}).next(function(e){for(var n,r=[],s=[],a=Mt(),u=0,c=o;u<c.length;u++){n=c[u],r.push(n.batchId);for(var h,l=0,f=n.mutations;l<f.length;l++)h=f[l],a=a.add(h.key)}for(var d,p=0,y=e;p<y.length;p++){d=y[p],s.push(d.batchId);for(var g,v=0,m=d.mutations;v<m.length;v++)g=m[v],a=a.add(g.key)}return i.pn(t,a).next(function(t){return{Ln:t,removedBatchIds:r,addedBatchIds:s}})})})];case 1:return o=s.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}})})}function Je(t){var e=f(t);return e.persistence.runTransaction(\"Get last remote snapshot version\",\"readonly\",function(t){return e.qe.getLastRemoteSnapshotVersion(t)})}function Ze(t,e,n,r,i){var o=Mt();return n.forEach(function(t){return o=o.add(t)}),e.getEntries(t,o).next(function(t){var o=xt();return n.forEach(function(n,a){var u=t.get(n),c=(null==i?void 0:i.get(n))||r;a.isNoDocument()&&a.version.isEqual(wi.min())?(e.removeEntry(n,c),o=o.insert(n,a)):!u.isValidDocument()||0<a.version.compareTo(u.version)||0===a.version.compareTo(u.version)&&u.hasPendingWrites?(e.addEntry(a,c),o=o.insert(n,a)):s(\"LocalStore\",\"Ignoring outdated watch update for \",n,\". Current version:\",u.version,\" Watch version:\",a.version)}),o})}function tn(t,e){var n=f(t);return n.persistence.runTransaction(\"Allocate target\",\"readwrite\",function(t){var r;return n.qe.getTargetData(t,e).next(function(i){return i?(r=i,Qo.resolve(r)):n.qe.allocateTargetId(t).next(function(i){return r=new ns(e,i,0,t.currentSequenceNumber),n.qe.addTargetData(t,r).next(function(){return r})})})}).then(function(t){var r=n.Fn.get(t.targetId);return(null===r||0<t.snapshotVersion.compareTo(r.snapshotVersion))&&(n.Fn=n.Fn.insert(t.targetId,t),n.kn.set(e,t.targetId)),t})}function en(t,e,n){return Object(hi.b)(this,void 0,void 0,function(){var r,i,o,a;return Object(hi.d)(this,function(u){switch(u.label){case 0:r=f(t),i=r.Fn.get(e),o=n?\"readwrite\":\"readwrite-primary\",u.label=1;case 1:return u.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction(\"Release target\",o,function(t){return r.persistence.referenceDelegate.removeTarget(t,i)})];case 2:u.sent(),u.label=3;case 3:return[3,5];case 4:if(!pe(a=u.sent()))throw a;return s(\"LocalStore\",\"Failed to update sequence numbers for target \"+e+\": \"+a),[3,5];case 5:return r.Fn=r.Fn.remove(e),r.kn.delete(i.target),[2]}})})}function nn(t,e,n){var r=f(t),i=wi.min(),o=Mt();return r.persistence.runTransaction(\"Execute query\",\"readonly\",function(t){return function(t,e,n){var r=f(t),i=r.kn.get(n);return void 0===i?r.qe.getTargetData(e,n):Qo.resolve(r.Fn.get(i))}(r,t,ot(e)).next(function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(t,e.targetId).next(function(t){o=t})}).next(function(){return r.xn.getDocumentsMatchingQuery(t,e,n?i:wi.min(),n?o:Mt())}).next(function(t){return{documents:t,Bn:o}})})}function rn(t,e){var n=f(t),r=f(n.qe),i=n.Fn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction(\"Get target data\",\"readonly\",function(t){return r.lt(t,e).next(function(t){return t?t.target:null})})}function on(t){var e=f(t);return e.persistence.runTransaction(\"Get new document changes\",\"readonly\",function(t){return function(t,e,n){var r=f(t),i=xt(),o=we(n),s=ze(e),a=IDBKeyRange.lowerBound(o,!0);return s.$t({index:Ro.readTimeIndex,range:a},function(t,e){var n=me(r.R,e);i=i.insert(n.key,n),o=e.readTime}).next(function(){return{wn:i,readTime:Ee(o)}})}(e.On,t,e.$n)}).then(function(t){var n=t.wn,r=t.readTime;return e.$n=r,n})}\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nfunction sn(t,e){return\"firestore_clients_\"+t+\"_\"+e}function an(t,e,n){var r=\"firestore_mutations_\"+t+\"_\"+n;return e.isAuthenticated()&&(r+=\"_\"+e.uid),r}function un(t,e){return\"firestore_targets_\"+t+\"_\"+e}\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function cn(){return\"undefined\"==typeof window?null:window}function hn(){return\"undefined\"==typeof document?null:document}\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function ln(t){return new Oo(t,!0)}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function fn(t){return Object(hi.b)(this,void 0,void 0,function(){var e,n;return Object(hi.d)(this,function(r){switch(r.label){case 0:if(!wn(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function dn(t){return Object(hi.b)(this,void 0,void 0,function(){var e,n;return Object(hi.d)(this,function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function pn(t,e){var n=f(t);n.$r.has(e.targetId)||(n.$r.set(e.targetId,e),bn(n)?mn(n):Dn(n).er()&&gn(n,e))}function yn(t,e){var n=f(t),r=Dn(n);n.$r.delete(e),r.er()&&vn(n,e),0===n.$r.size&&(r.er()?r.ir():wn(n)&&n.Br.set(\"Unknown\"))}function gn(t,e){t.qr.U(e.targetId),Dn(t).mr(e)}function vn(t,e){t.qr.U(e),Dn(t).yr(e)}function mn(t){t.qr=new _o({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.$r.get(e)||null}}),Dn(t).start(),t.Br.Sr()}function bn(t){return wn(t)&&!Dn(t).tr()&&0<t.$r.size}function wn(t){return 0===f(t).Or.size}function En(t){t.qr=void 0}function _n(t,e,n){return Object(hi.b)(this,void 0,void 0,function(){var r=this;return Object(hi.d)(this,function(i){switch(i.label){case 0:if(!pe(e))throw e;return t.Or.add(1),[4,dn(t)];case 1:return i.sent(),t.Br.set(\"Offline\"),n||(n=function(){return Je(t.localStore)}),t.asyncQueue.enqueueRetryable(function(){return Object(hi.b)(r,void 0,void 0,function(){return Object(hi.d)(this,function(e){switch(e.label){case 0:return s(\"RemoteStore\",\"Retrying IndexedDB access\"),[4,n()];case 1:return e.sent(),t.Or.delete(1),[4,fn(t)];case 2:return e.sent(),[2]}})})}),[2]}})})}function In(t,e){return e().catch(function(n){return _n(t,n,e)})}function Tn(t){return Object(hi.b)(this,void 0,void 0,function(){var e,n,r,i,o;return Object(hi.d)(this,function(s){switch(s.label){case 0:e=f(t),n=Nn(e),r=0<e.kr.length?e.kr[e.kr.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return wn(t)&&10>t.kr.length}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,function(t,e){var n=f(t);return n.persistence.runTransaction(\"Get next mutation batch\",\"readonly\",function(t){return void 0===e&&(e=-1),n._n.getNextMutationBatchAfterBatchId(t,e)})}(e.localStore,r)];case 3:return null===(i=s.sent())?(0===e.kr.length&&n.ir(),[3,7]):(r=i.batchId,function(t,e){t.kr.push(e);var n=Nn(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,_n(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return On(e)&&Sn(e),[2]}})})}function On(t){return wn(t)&&!Nn(t).tr()&&0<t.kr.length}function Sn(t){Nn(t).start()}function An(t,e){return Object(hi.b)(this,void 0,void 0,function(){var n;return Object(hi.d)(this,function(r){switch(r.label){case 0:return n=f(t),e?(n.Or.delete(2),[4,fn(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Or.add(2),[4,dn(n)]);case 3:r.sent(),n.Br.set(\"Unknown\"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function Dn(t){var e=this;return t.Ur||(t.Ur=function(t,e,n){var r=f(t);return r.br(),new ta(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:function(t){return Object(hi.b)(this,void 0,void 0,function(){return Object(hi.d)(this,function(){return t.$r.forEach(function(e){gn(t,e)}),[2]})})}.bind(null,t),Ri:function(t,e){return Object(hi.b)(this,void 0,void 0,function(){return Object(hi.d)(this,function(){return En(t),bn(t)?(t.Br.Nr(e),mn(t)):t.Br.set(\"Unknown\"),[2]})})}.bind(null,t),_r:function(t,e,n){return Object(hi.b)(this,void 0,void 0,function(){var r,i,o;return Object(hi.d)(this,function(a){switch(a.label){case 0:if(t.Br.set(\"Online\"),!(e instanceof wo&&2===e.state&&e.cause))return[3,6];a.label=1;case 1:return a.trys.push([1,3,,5]),[4,function(t,e){return Object(hi.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(hi.d)(this,function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?(o=i[r],t.$r.has(o)?[4,t.remoteSyncer.rejectListen(o,n)]:[3,3]):[3,5];case 2:s.sent(),t.$r.delete(o),t.qr.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}})})}(t,e)];case 2:return a.sent(),[3,5];case 3:return r=a.sent(),s(\"RemoteStore\",\"Failed to remove targets %s: %s \",e.targetIds.join(\",\"),r),[4,_n(t,r)];case 4:return a.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof mo?t.qr.X(e):e instanceof bo?t.qr.rt(e):t.qr.et(e),n.isEqual(wi.min()))return[3,13];a.label=7;case 7:return a.trys.push([7,11,,13]),[4,Je(t.localStore)];case 8:return i=a.sent(),0<=n.compareTo(i)?[4,function(t,e){var n=t.qr.ut(e);return n.targetChanges.forEach(function(n,r){if(0<n.resumeToken.approximateByteSize()){var i=t.$r.get(r);i&&t.$r.set(r,i.withResumeToken(n.resumeToken,e))}}),n.targetMismatches.forEach(function(e){var n=t.$r.get(e);if(n){t.$r.set(e,n.withResumeToken(Si.EMPTY_BYTE_STRING,n.snapshotVersion)),vn(t,e);var r=new ns(n.target,e,1,n.sequenceNumber);gn(t,r)}}),t.remoteSyncer.applyRemoteEvent(n)}(t,n)]:[3,10];case 9:a.sent(),a.label=10;case 10:return[3,13];case 11:return s(\"RemoteStore\",\"Failed to raise snapshot:\",o=a.sent()),[4,_n(t,o)];case 12:return a.sent(),[3,13];case 13:return[2]}})})}.bind(null,t)}),t.Mr.push(function(n){return Object(hi.b)(e,void 0,void 0,function(){return Object(hi.d)(this,function(e){switch(e.label){case 0:return n?(t.Ur.sr(),bn(t)?mn(t):t.Br.set(\"Unknown\"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:e.sent(),En(t),e.label=3;case 3:return[2]}})})})),t.Ur}function Nn(t){var e=this;return t.Kr||(t.Kr=function(t,e,n){var r=f(t);return r.br(),new ea(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:function(t){return Object(hi.b)(this,void 0,void 0,function(){return Object(hi.d)(this,function(){return Nn(t).Ar(),[2]})})}.bind(null,t),Ri:function(t,e){return Object(hi.b)(this,void 0,void 0,function(){return Object(hi.d)(this,function(n){switch(n.label){case 0:return e&&Nn(t).pr?[4,function(t,e){return Object(hi.b)(this,void 0,void 0,function(){var n,r;return Object(hi.d)(this,function(i){switch(i.label){case 0:return kt(r=e.code)&&r!==yi.ABORTED?(n=t.kr.shift(),Nn(t).sr(),[4,In(t,function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)})]):[3,3];case 1:return i.sent(),[4,Tn(t)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return On(t)&&Sn(t),[2]}})})}.bind(null,t),Ir:function(t){return Object(hi.b)(this,void 0,void 0,function(){var e,n,r,i;return Object(hi.d)(this,function(){for(e=Nn(t),n=0,r=t.kr;n<r.length;n++)i=r[n],e.Er(i.mutations);return[2]})})}.bind(null,t),Tr:function(t,e,n){return Object(hi.b)(this,void 0,void 0,function(){var r,i;return Object(hi.d)(this,function(o){switch(o.label){case 0:return r=t.kr.shift(),i=es.from(r,e,n),[4,In(t,function(){return t.remoteSyncer.applySuccessfulWrite(i)})];case 1:return o.sent(),[4,Tn(t)];case 2:return o.sent(),[2]}})})}.bind(null,t)}),t.Mr.push(function(n){return Object(hi.b)(e,void 0,void 0,function(){return Object(hi.d)(this,function(e){switch(e.label){case 0:return n?(t.Kr.sr(),[4,Tn(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Kr.stop()];case 3:e.sent(),0<t.kr.length&&(s(\"RemoteStore\",\"Stopping write stream with \"+t.kr.length+\" pending writes\"),t.kr=[]),e.label=4;case 4:return[2]}})})})),t.Kr\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */}function Cn(t,e){if(a(\"AsyncQueue\",e+\": \"+t),pe(t))return new gi(yi.UNAVAILABLE,e+\": \"+t);throw t}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function jn(t,e){return Object(hi.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u;return Object(hi.d)(this,function(c){switch(c.label){case 0:if(n=f(t),r=e.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new ca),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.onListen(r)];case 2:return s.Wr=c.sent(),[3,4];case 3:return a=c.sent(),u=Cn(a,\"Initialization of query '\"+ct(e.query)+\"' failed\"),[2,void e.onError(u)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zr(n.onlineState),o.Wr&&e.Hr(o.Wr)&&Rn(n),[2]}})})}function kn(t,e){return Object(hi.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(hi.d)(this,function(){return n=f(t),r=e.query,i=!1,(o=n.queries.get(r))&&0<=(s=o.listeners.indexOf(e))&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]})})}function Rn(t){t.Gr.forEach(function(t){t.next()})}\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function xn(t,e,n,r){return Object(hi.b)(this,void 0,void 0,function(){var i,o,s,a,u,c;return Object(hi.d)(this,function(h){switch(h.label){case 0:return t.Oo=function(e,n,r){return function(t,e,n,r){return Object(hi.b)(this,void 0,void 0,function(){var i,o,s;return Object(hi.d)(this,function(a){switch(a.label){case 0:return(i=e.view._o(n)).Nn?[4,nn(t.localStore,e.query,!1).then(function(t){var n=t.documents;return e.view._o(n,i)})]:[3,2];case 1:i=a.sent(),a.label=2;case 2:return o=r&&r.targetChanges.get(e.targetId),s=e.view.applyChanges(i,t.isPrimaryClient,o),[2,(zn(t,e.targetId,s.To),s.snapshot)]}})})}(t,e,n,r)},[4,nn(t.localStore,e,!0)];case 1:return i=h.sent(),o=new ga(e,i.Bn),s=o._o(i.documents),a=vo.createSynthesizedTargetChangeForCurrentChange(n,r&&\"Offline\"!==t.onlineState),u=o.applyChanges(s,t.isPrimaryClient,a),zn(t,n,u.To),c=new va(e,n,o),[2,(t.Po.set(e,c),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),u.snapshot)]}})})}function Ln(t,e,n){return Object(hi.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(hi.d)(this,function(a){switch(a.label){case 0:r=$n(t),a.label=1;case 1:return a.trys.push([1,5,,6]),[4,function(t,e){var n,r=f(t),i=bi.now(),o=e.reduce(function(t,e){return t.add(e.key)},Mt());return r.persistence.runTransaction(\"Locally write mutations\",\"readwrite\",function(t){return r.Mn.pn(t,o).next(function(o){n=o;for(var s=[],a=0,u=e;a<u.length;a++){var c=u[a],h=St(c,n.get(c.key));null!=h&&s.push(new eo(c.key,h,q(h.value.mapValue),Ji.exists(!0)))}return r._n.addMutationBatch(t,i,s,e)})}).then(function(t){return t.applyToLocalDocumentSet(n),{batchId:t.batchId,changes:n}})}(r.localStore,e)];case 2:return i=a.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(t,e,n){var r=t.xo[t.currentUser.toKey()];r||(r=new oo(p)),r=r.insert(e,n),t.xo[t.currentUser.toKey()]=r}(r,i.batchId,n),[4,Hn(r,i.changes)];case 3:return a.sent(),[4,Tn(r.remoteStore)];case 4:return a.sent(),[3,6];case 5:return o=a.sent(),s=Cn(o,\"Failed to persist write\"),n.reject(s),[3,6];case 6:return[2]}})})}function Pn(t,e){return Object(hi.b)(this,void 0,void 0,function(){var n,r;return Object(hi.d)(this,function(i){switch(i.label){case 0:n=f(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,function(t,e){var n=f(t),r=e.snapshotVersion,i=n.Fn;return n.persistence.runTransaction(\"Apply remote event\",\"readwrite-primary\",function(t){var o=n.On.newChangeBuffer({trackRemovals:!0});i=n.Fn;var s=[];e.targetChanges.forEach(function(e,o){var a=i.get(o);if(a){s.push(n.qe.removeMatchingKeys(t,e.removedDocuments,o).next(function(){return n.qe.addMatchingKeys(t,e.addedDocuments,o)}));var u=e.resumeToken;if(0<u.approximateByteSize()){var c=a.withResumeToken(u,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,c),function(t,e,n){return l(0<e.resumeToken.approximateByteSize()),0===t.resumeToken.approximateByteSize()||3e8<=e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()||0<n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size}(a,c,e)&&s.push(n.qe.updateTargetData(t,c))}}});var a=xt();if(e.documentUpdates.forEach(function(r){e.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))}),s.push(Ze(t,o,e.documentUpdates,r,void 0).next(function(t){a=t})),!r.isEqual(wi.min())){var u=n.qe.getLastRemoteSnapshotVersion(t).next(function(){return n.qe.setTargetsMetadata(t,t.currentSequenceNumber,r)});s.push(u)}return Qo.waitFor(s).next(function(){return o.apply(t)}).next(function(){return n.Mn.En(t,a)}).next(function(){return a})}).then(function(t){return n.Fn=i,t})}(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach(function(t,e){var r=n.Co.get(e);r&&(l(1>=t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size),0<t.addedDocuments.size?r.bo=!0:0<t.modifiedDocuments.size?l(r.bo):0<t.removedDocuments.size&&(l(r.bo),r.bo=!1))}),[4,Hn(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Ue(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}})})}function Mn(t,e,n){var r=f(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach(function(t,n){var r=n.view.zr(e);r.snapshot&&i.push(r.snapshot)}),function(t,e){var n=f(t);n.onlineState=e;var r=!1;n.queries.forEach(function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(e)&&(r=!0)}),r&&Rn(n)}(r.eventManager,e),i.length&&r.vo._r(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Fn(t,e){return Object(hi.b)(this,void 0,void 0,function(){var n,r,i;return Object(hi.d)(this,function(o){switch(o.label){case 0:n=f(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=f(t);return n.persistence.runTransaction(\"Acknowledge batch\",\"readwrite-primary\",function(t){var r=e.batch.keys(),i=n.On.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=Qo.resolve();return o.forEach(function(t){s=s.next(function(){return r.getEntry(e,t)}).next(function(e){var o=n.docVersions.get(t);l(null!==o),0>e.version.compareTo(o)&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&r.addEntry(e,n.commitVersion))})}),s.next(function(){return t._n.removeMutationBatch(e,i)})}(n,t,e,i).next(function(){return i.apply(t)}).next(function(){return n._n.performConsistencyCheck(t)}).next(function(){return n.Mn.pn(t,r)})})}(n.localStore,e)];case 2:return i=o.sent(),qn(n,r,null),Un(n,r),n.sharedClientState.updateMutationState(r,\"acknowledged\"),[4,Hn(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Ue(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function Vn(t,e){return Object(hi.b)(this,void 0,void 0,function(){var n,r,i,o,a;return Object(hi.d)(this,function(u){switch(u.label){case 0:wn((n=f(t)).remoteStore)||s(\"SyncEngine\",\"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.\"),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,(c=f(n.localStore),c.persistence.runTransaction(\"Get highest unacknowledged batch id\",\"readonly\",function(t){return c._n.getHighestUnacknowledgedBatchId(t)}))];case 2:return-1===(r=u.sent())?[2,void e.resolve()]:((i=n.Fo.get(r)||[]).push(e),n.Fo.set(r,i),[3,4]);case 3:return o=u.sent(),a=Cn(o,\"Initialization of waitForPendingWrites() operation failed\"),e.reject(a),[3,4];case 4:return[2]}var c})})}function Un(t,e){(t.Fo.get(e)||[]).forEach(function(t){t.resolve()}),t.Fo.delete(e)}function qn(t,e,n){var r=f(t),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i}}function Bn(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r,i=0,o=t.Vo.get(e);i<o.length;i++)r=o[i],t.Po.delete(r),n&&t.vo.Mo(r,n);t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach(function(e){t.No.containsKey(e)||Kn(t,e)})}function Kn(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(yn(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),Qn(t))}function zn(t,e,n){for(var r,i=0,o=n;i<o.length;i++)(r=o[i])instanceof pa?(t.No.addReference(r.key,e),Gn(t,r)):r instanceof ya?(s(\"SyncEngine\",\"Document no longer in limbo: \"+r.key),t.No.removeReference(r.key,e),t.No.containsKey(r.key)||Kn(t,r.key)):h()}function Gn(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||(s(\"SyncEngine\",\"New document in limbo: \"+n),t.So.add(r),Qn(t))}function Qn(t){for(;0<t.So.size&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new Ci(_i.fromString(e)),r=t.ko.next();t.Co.set(r,new ma(n)),t.Do=t.Do.insert(n,r),pn(t.remoteStore,new ns(ot(J(n.path)),r,2,pi.o))}}function Hn(t,e,n){return Object(hi.b)(this,void 0,void 0,function(){var r,i,o,a;return Object(hi.d)(this,function(u){switch(u.label){case 0:return r=f(t),i=[],o=[],a=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach(function(t,s){a.push(r.Oo(s,e,n).then(function(t){if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(s.targetId,t.fromCache?\"not-current\":\"current\"),i.push(t);var e=Ss.Pn(s.targetId,t);o.push(e)}}))}),[4,Promise.all(a)]);case 1:return u.sent(),r.vo._r(i),[4,function(t,e){return Object(hi.b)(this,void 0,void 0,function(){var n,r,i,o,a,u,c,h,l;return Object(hi.d)(this,function(d){switch(d.label){case 0:n=f(t),d.label=1;case 1:return d.trys.push([1,3,,4]),[4,n.persistence.runTransaction(\"notifyLocalViewChanges\",\"readwrite\",function(t){return Qo.forEach(e,function(e){return Qo.forEach(e.bn,function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)}).next(function(){return Qo.forEach(e.vn,function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)})})})})];case 2:return d.sent(),[3,4];case 3:if(!pe(r=d.sent()))throw r;return s(\"LocalStore\",\"Failed to update sequence numbers: \"+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)a=o[i],u=a.targetId,a.fromCache||(c=n.Fn.get(u),h=c.snapshotVersion,l=c.withLastLimboFreeSnapshotVersion(h),n.Fn=n.Fn.insert(u,l));return[2]}})})}(r.localStore,o)];case 2:u.sent(),u.label=3;case 3:return[2]}})})}function Wn(t,e){return Object(hi.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u,c,h,l,d,p,y,g;return Object(hi.d)(this,function(v){switch(v.label){case 0:n=f(t),r=[],i=[],o=0,s=e,v.label=1;case 1:return o<s.length?(a=s[o],u=void 0,(c=n.Vo.get(a))&&0!==c.length?[4,tn(n.localStore,ot(c[0]))]:[3,7]):[3,13];case 2:u=v.sent(),h=0,l=c,v.label=3;case 3:return h<l.length?(d=l[h],p=n.Po.get(d),[4,function(t,e){return Object(hi.b)(this,void 0,void 0,function(){var n,r,i;return Object(hi.d)(this,function(o){switch(o.label){case 0:return[4,nn((n=f(t)).localStore,e.query,!0)];case 1:return r=o.sent(),i=e.view.Ao(r),[2,(n.isPrimaryClient&&zn(n,e.targetId,i.To),i)]}})})}(n,p)]):[3,6];case 4:(y=v.sent()).snapshot&&i.push(y.snapshot),v.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,rn(n.localStore,a)];case 8:return g=v.sent(),[4,tn(n.localStore,g)];case 9:return u=v.sent(),[4,xn(n,Yn(g),a,!1)];case 10:v.sent(),v.label=11;case 11:r.push(u),v.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}})})}function Yn(t){return $(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,\"F\",t.startAt,t.endAt)}function Xn(t){var e=f(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Pn.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=function(t,e){var n=f(t),r=n.Co.get(e);if(r&&r.bo)return Mt().add(r.key);var i=Mt(),o=n.Vo.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var u=a[s],c=n.Po.get(u);i=i.unionWith(c.view.wo)}return i}.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=function(t,e,n){return Object(hi.b)(this,void 0,void 0,function(){var r,i,o,s,a,u;return Object(hi.d)(this,function(c){switch(c.label){case 0:return(r=f(t)).sharedClientState.updateQueryState(e,\"rejected\",n),i=r.Co.get(e),(o=i&&i.key)?(s=(s=new oo(Ci.comparator)).insert(o,ki.newNoDocument(o,wi.min())),a=Mt().add(o),u=new go(wi.min(),new Map,new uo(p),s,a),[4,Pn(r,u)]):[3,2];case 1:return c.sent(),r.Do=r.Do.remove(o),r.Co.delete(e),Qn(r),[3,4];case 2:return[4,en(r.localStore,e,!1).then(function(){return Bn(r,e,n)}).catch(Ue)];case 3:c.sent(),c.label=4;case 4:return[2]}})})}.bind(null,e),e.vo._r=function(t,e){for(var n=f(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=s.query,u=n.queries.get(a);if(u){for(var c=0,h=u.listeners;c<h.length;c++)h[c].Hr(s)&&(r=!0);u.Wr=s}}r&&Rn(n)}.bind(null,e.eventManager),e.vo.Mo=function(t,e,n){var r=f(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}.bind(null,e.eventManager),e}function $n(t){var e=f(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Fn.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=function(t,e,n){return Object(hi.b)(this,void 0,void 0,function(){var r,i;return Object(hi.d)(this,function(o){switch(o.label){case 0:r=f(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=f(t);return n.persistence.runTransaction(\"Reject batch\",\"readwrite-primary\",function(t){var r;return n._n.lookupMutationBatch(t,e).next(function(e){return l(null!==e),r=e.keys(),n._n.removeMutationBatch(t,e)}).next(function(){return n._n.performConsistencyCheck(t)}).next(function(){return n.Mn.pn(t,r)})})}(r.localStore,e)];case 2:return i=o.sent(),qn(r,e,n),Un(r,e),r.sharedClientState.updateMutationState(e,\"rejected\",n),[4,Hn(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Ue(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}.bind(null,e),e}\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function Jn(t,e){return Object(hi.b)(this,void 0,void 0,function(){var n,r,i=this;return Object(hi.d)(this,function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),s(\"FirestoreClient\",\"Initializing OfflineComponentProvider\"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.initialUser,t.setCredentialChangeListener(function(t){return Object(hi.b)(i,void 0,void 0,function(){return Object(hi.d)(this,function(n){switch(n.label){case 0:return r.isEqual(t)?[3,2]:[4,$e(e.localStore,t)];case 1:n.sent(),r=t,n.label=2;case 2:return[2]}})})}),e.persistence.setDatabaseDeletedListener(function(){return t.terminate()}),t.offlineComponents=e,[2]}})})}function Zn(t,e){return Object(hi.b)(this,void 0,void 0,function(){var n,r;return Object(hi.d)(this,function(i){switch(i.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,tr(t)];case 1:return n=i.sent(),s(\"FirestoreClient\",\"Initializing OnlineComponentProvider\"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.setCredentialChangeListener(function(t){return function(t,e){return Object(hi.b)(this,void 0,void 0,function(){var n,r;return Object(hi.d)(this,function(i){switch(i.label){case 0:return(n=f(t)).asyncQueue.verifyOperationInProgress(),s(\"RemoteStore\",\"RemoteStore received new credentials\"),r=wn(n),n.Or.add(3),[4,dn(n)];case 1:return i.sent(),r&&n.Br.set(\"Unknown\"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.Or.delete(3),[4,fn(n)];case 3:return i.sent(),[2]}})})}(e.remoteStore,t)}),t.onlineComponents=e,[2]}})})}function tr(t){return Object(hi.b)(this,void 0,void 0,function(){return Object(hi.d)(this,function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(s(\"FirestoreClient\",\"Using default OfflineComponentProvider\"),[4,Jn(t,new wa)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}})})}function er(t){return Object(hi.b)(this,void 0,void 0,function(){return Object(hi.d)(this,function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(s(\"FirestoreClient\",\"Using default OnlineComponentProvider\"),[4,Zn(t,new Ia)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}})})}function nr(t){return tr(t).then(function(t){return t.persistence})}function rr(t){return tr(t).then(function(t){return t.localStore})}function ir(t){return er(t).then(function(t){return t.remoteStore})}function or(t){return er(t).then(function(t){return t.syncEngine})}function sr(t){return Object(hi.b)(this,void 0,void 0,function(){var e,n;return Object(hi.d)(this,function(r){switch(r.label){case 0:return[4,er(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nfunction(t,e){return Object(hi.b)(this,void 0,void 0,function(){var n,r,i,o,s,a;return Object(hi.d)(this,function(u){switch(u.label){case 0:return n=Xn(t),(o=n.Po.get(e))?(r=o.targetId,n.sharedClientState.addLocalQueryTarget(r),i=o.view.Ro(),[3,4]):[3,1];case 1:return[4,tn(n.localStore,ot(e))];case 2:return s=u.sent(),a=n.sharedClientState.addLocalQueryTarget(s.targetId),r=s.targetId,[4,xn(n,e,r,\"current\"===a)];case 3:i=u.sent(),n.isPrimaryClient&&pn(n.remoteStore,s),u.label=4;case 4:return[2,i]}})})}.bind(null,e.syncEngine),n.onUnlisten=function(t,e){return Object(hi.b)(this,void 0,void 0,function(){var n,r,i;return Object(hi.d)(this,function(o){switch(o.label){case 0:return n=f(t),r=n.Po.get(e),1<(i=n.Vo.get(r.targetId)).length?[2,(n.Vo.set(r.targetId,i.filter(function(t){return!at(t,e)})),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,en(n.localStore,r.targetId,!1).then(function(){n.sharedClientState.clearQueryState(r.targetId),yn(n.remoteStore,r.targetId),Bn(n,r.targetId)}).catch(Ue)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Bn(n,r.targetId),[4,en(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}})})}.bind(null,e.syncEngine),n)]}})})}function ar(t,e,n){var r=this;void 0===n&&(n={});var i=new Go;return t.asyncQueue.enqueueAndForget(function(){return Object(hi.b)(r,void 0,void 0,function(){var r;return Object(hi.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Ta({next:function(o){e.enqueueAndForget(function(){return kn(t,s)});var a=o.docs.has(n);!a&&o.fromCache?i.reject(new gi(yi.UNAVAILABLE,\"Failed to get document because the client is offline.\")):a&&o.fromCache&&r&&\"server\"===r.source?i.reject(new gi(yi.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to \"server\" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new la(J(n.path),o,{includeMetadataChanges:!0,so:!0});return jn(t,s)},[4,sr(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}})})}),i.promise}function ur(t,e,n){var r=this;void 0===n&&(n={});var i=new Go;return t.asyncQueue.enqueueAndForget(function(){return Object(hi.b)(r,void 0,void 0,function(){var r;return Object(hi.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Ta({next:function(n){e.enqueueAndForget(function(){return kn(t,s)}),n.fromCache&&\"server\"===r.source?i.reject(new gi(yi.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to \"server\" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new la(n,o,{includeMetadataChanges:!0,so:!0});return jn(t,s)},[4,sr(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}})})}),i.promise}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function cr(t,e,n){if(!n)throw new gi(yi.INVALID_ARGUMENT,\"Function \"+t+\"() cannot be called with an empty \"+e+\".\")}function hr(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new gi(yi.INVALID_ARGUMENT,\"Invalid options passed to function \"+t+'(): You cannot specify both \"merge\" and \"mergeFields\".');return e}function lr(t,e,n,r){if(!0===e&&!0===r)throw new gi(yi.INVALID_ARGUMENT,t+\" and \"+n+\" cannot be used together.\")}function fr(t){if(!Ci.isDocumentKey(t))throw new gi(yi.INVALID_ARGUMENT,\"Invalid document reference. Document references must have an even number of segments, but \"+t+\" has \"+t.length+\".\")}function dr(t){if(Ci.isDocumentKey(t))throw new gi(yi.INVALID_ARGUMENT,\"Invalid collection reference. Collection references must have an odd number of segments, but \"+t+\" has \"+t.length+\".\")}function pr(t){if(void 0===t)return\"undefined\";if(null===t)return\"null\";if(\"string\"==typeof t)return 20<t.length&&(t=t.substring(0,20)+\"...\"),JSON.stringify(t);if(\"number\"==typeof t||\"boolean\"==typeof t)return\"\"+t;if(\"object\"==typeof t){if(t instanceof Array)return\"an array\";var e=function(t){if(t.constructor){var e=/function\\s+([^\\s(]+)\\s*\\(/.exec(t.constructor.toString());if(e&&1<e.length)return e[1]}return null}(t);return e?\"a custom \"+e+\" object\":\"an object\"}return\"function\"==typeof t?\"a function\":h()}function yr(t,e){if(\"_delegate\"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new gi(yi.INVALID_ARGUMENT,\"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?\");var n=pr(t);throw new gi(yi.INVALID_ARGUMENT,\"Expected type '\"+e.name+\"', but it was: \"+n)}return t}function gr(t,e){if(0>=e)throw new gi(yi.INVALID_ARGUMENT,\"Function \"+t+\"() requires a positive number, but it was: \"+e+\".\")}\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function vr(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=Object(li.h)(t),cr(\"collection\",\"path\",e),t instanceof Fa)return dr(n=_i.fromString.apply(_i,Object(hi.f)([e],r))),new qa(t,null,n);if(!(t instanceof Va||t instanceof qa))throw new gi(yi.INVALID_ARGUMENT,\"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore\");return dr(n=_i.fromString.apply(_i,Object(hi.f)([t.path],r)).child(_i.fromString(e))),new qa(t.firestore,null,n)}function mr(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=Object(li.h)(t),1===arguments.length&&(e=mi.u()),cr(\"doc\",\"path\",e),t instanceof Fa)return fr(n=_i.fromString.apply(_i,Object(hi.f)([e],r))),new Va(t,null,new Ci(n));if(!(t instanceof Va||t instanceof qa))throw new gi(yi.INVALID_ARGUMENT,\"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore\");return fr(n=t._path.child(_i.fromString.apply(_i,Object(hi.f)([e],r)))),new Va(t.firestore,t instanceof qa?t.converter:null,new Ci(n))}function br(t,e){return t=Object(li.h)(t),e=Object(li.h)(e),(t instanceof Va||t instanceof qa)&&(e instanceof Va||e instanceof qa)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function wr(t,e){return t=Object(li.h)(t),e=Object(li.h)(e),t instanceof Ua&&e instanceof Ua&&t.firestore===e.firestore&&at(t._query,e._query)&&t.converter===e.converter\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */}function Er(t){return function(t){if(\"object\"!=typeof t||null===t)return!1;for(var e,n=t,r=0,i=[\"next\",\"error\",\"complete\"];r<i.length;r++)if((e=i[r])in n&&\"function\"==typeof n[e])return!0;return!1}(t)}\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function _r(t){return t._firestoreClient||Ir(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Ir(t){var e,n=t._freezeSettings(),r=function(t,e,n,r){return new Da(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||\"\",t._persistenceKey,n);t._firestoreClient=new Aa(t._credentials,t._queue,r)}function Tr(t,e,n){var r=this,i=new Go;return t.asyncQueue.enqueue(function(){return Object(hi.b)(r,void 0,void 0,function(){var r;return Object(hi.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,Jn(t,n)];case 1:return o.sent(),[4,Zn(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return\"FirebaseError\"===t.name?t.code===yi.FAILED_PRECONDITION||t.code===yi.UNIMPLEMENTED:!(\"undefined\"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn(\"Error enabling offline persistence. Falling back to persistence disabled: \"+r),i.reject(r),[3,4];case 4:return[2]}})})}).then(function(){return i.promise})}function Or(t){if(t._initialized||t._terminated)throw new gi(yi.FAILED_PRECONDITION,\"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.\")}\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function Sr(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw h()}}function Ar(t){var e=t._freezeSettings(),n=ln(t._databaseId);return new Za(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Dr(t,e,n,r,i,o){void 0===o&&(o={});var s=t.qc(o.merge||o.mergeFields?2:0,e,n,i);Pr(\"Data must be an object, but it was:\",s,r);var a,u,c=xr(r,s);if(o.merge)a=new Oi(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){for(var h,l=[],f=0,d=o.mergeFields;f<d.length;f++){if(h=Mr(e,d[f],n),!s.contains(h))throw new gi(yi.INVALID_ARGUMENT,\"Field '\"+h+\"' is specified in your field mask but missing from your input data.\");Ur(l,h)||l.push(h)}a=new Oi(l),u=s.fieldTransforms.filter(function(t){return a.covers(t.field)})}else a=null,u=s.fieldTransforms;return new Xa(new ji(c),a,u)}function Nr(t,e,n){return new Ja({Cc:3,Bc:e.settings.Bc,methodName:t._methodName,Fc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}function Cr(t,e,n,r){var i=t.qc(1,e,n);Pr(\"Data must be an object, but it was:\",i,r);var o=[],s=ji.empty();m(r,function(t,r){var a=Fr(e,t,n);r=Object(li.h)(r);var u=i.$c(a);if(r instanceof tu)o.push(a);else{var c=Rr(r,u);null!=c&&(o.push(a),s.set(a,c))}});var a=new Oi(o);return new $a(s,a,i.fieldTransforms)}function jr(t,e,n,r,i,o){var s=t.qc(1,e,n),a=[Mr(e,r,n)],u=[i];if(0!=o.length%2)throw new gi(yi.INVALID_ARGUMENT,\"Function \"+e+\"() needs to be called with an even number of arguments that alternate between field names and values.\");for(var c=0;c<o.length;c+=2)a.push(Mr(e,o[c])),u.push(o[c+1]);for(var h=[],l=ji.empty(),f=a.length-1;0<=f;--f)if(!Ur(h,a[f])){var d=a[f],p=u[f];p=Object(li.h)(p);var y=s.$c(d);if(p instanceof tu)h.push(d);else{var g=Rr(p,y);null!=g&&(h.push(d),l.set(d,g))}}var v=new Oi(h);return new $a(l,v,s.fieldTransforms)}function kr(t,e,n,r){return void 0===r&&(r=!1),Rr(n,t.qc(r?4:3,e))}function Rr(t,e){if(Lr(t=Object(li.h)(t)))return Pr(\"Unsupported field value:\",e,t),xr(t,e);if(t instanceof Ha)return function(t,e){if(!Sr(e.Cc))throw e.Mc(t._methodName+\"() can only be used with update() and set()\");if(!e.path)throw e.Mc(t._methodName+\"() is not currently supported inside arrays\");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Fc&&4!==e.Cc)throw e.Mc(\"Nested arrays are not supported\");return function(e,n){for(var r,i=[],o=0,s=0,a=t;s<a.length;s++)null==(r=Rr(a[s],n.Oc(o)))&&(r={nullValue:\"NULL_VALUE\"}),i.push(r),o++;return{arrayValue:{values:i}}}(0,e)}return function(t,e){if(null===(t=Object(li.h)(t)))return{nullValue:\"NULL_VALUE\"};if(\"number\"==typeof t)return yt(e.R,t);if(\"boolean\"==typeof t)return{booleanValue:t};if(\"string\"==typeof t)return{stringValue:t};if(t instanceof Date){var n=bi.fromDate(t);return{timestampValue:qt(e.R,n)}}if(t instanceof bi)return n=new bi(t.seconds,1e3*i(t.nanoseconds/1e3)),{timestampValue:qt(e.R,n)};if(t instanceof Wa)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Qa)return{bytesValue:Bt(e.R,t._byteString)};if(t instanceof Va){n=e.databaseId;var r=t.firestore._databaseId;if(!r.isEqual(n))throw e.Mc(\"Document reference is for database \"+r.projectId+\"/\"+r.database+\" but should be for database \"+n.projectId+\"/\"+n.database);return{referenceValue:zt(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Mc(\"Unsupported field value: \"+pr(t))}(t,e)}function xr(t,e){var n={};return b(t)?e.path&&0<e.path.length&&e.fieldMask.push(e.path):m(t,function(t,r){var i=Rr(r,e.xc(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function Lr(t){return!(\"object\"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof bi||t instanceof Wa||t instanceof Qa||t instanceof Va||t instanceof Ha)}function Pr(t,e,n){if(!Lr(n)||!function(t){return\"object\"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=pr(n);throw\"an object\"===r?e.Mc(t+\" a custom object\"):e.Mc(t+\" \"+r)}}function Mr(t,e,n){if((e=Object(li.h)(e))instanceof Ga)return e._internalPath;if(\"string\"==typeof e)return Fr(t,e);throw Vr(\"Field path arguments must be of type string or FieldPath.\",t,!1,void 0,n)}function Fr(t,e,n){if(0<=e.search(ou))throw Vr(\"Invalid field path (\"+e+\"). Paths must not contain '~', '*', '/', '[', or ']'\",t,!1,void 0,n);try{return(new(Ga.bind.apply(Ga,Object(hi.f)([void 0],e.split(\".\")))))._internalPath}catch(r){throw Vr(\"Invalid field path (\"+e+\"). Paths must not be empty, begin with '.', end with '.', or contain '..'\",t,!1,void 0,n)}}function Vr(t,e,n,r,i){var o=r&&!r.isEmpty(),s=void 0!==i,a=\"Function \"+e+\"() called with invalid data\";n&&(a+=\" (via `toFirestore()`)\");var u=\"\";return(o||s)&&(u+=\" (found\",o&&(u+=\" in field \"+r),s&&(u+=\" in document \"+i),u+=\")\"),new gi(yi.INVALID_ARGUMENT,(a+=\". \")+t+u)}function Ur(t,e){return t.some(function(t){return t.isEqual(e)})}\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function qr(t,e){return\"string\"==typeof e?Fr(t,e):e instanceof Ga?e._internalPath:e._delegate._internalPath}\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function Br(t,e){return t instanceof cu&&e instanceof cu?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof lu&&e instanceof lu&&t._firestore===e._firestore&&wr(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function Kr(t){if(tt(t)&&0===t.explicitOrderBy.length)throw new gi(yi.UNIMPLEMENTED,\"limitToLast() queries require specifying at least one orderBy() clause\")}function zr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++)t=i[r]._apply(t);return t}function Gr(t,e,n,r){if(n[0]=Object(li.h)(n[0]),n[0]instanceof su)return function(t,e,n,r,i){if(!r)throw new gi(yi.NOT_FOUND,\"Can't use a DocumentSnapshot that doesn't exist for \"+n+\"().\");for(var o,s=[],a=0,u=it(t);a<u.length;a++)if((o=u[a]).field.isKeyField())s.push(x(e,r.key));else{var c=r.data.field(o.field);if(I(c))throw new gi(yi.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field \"'+o.field+'\" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=o.field.canonicalString();throw new gi(yi.INVALID_ARGUMENT,\"Invalid query. You are trying to start or end a query using a document for which the field '\"+h+\"' (used as the orderBy) does not exist.\")}s.push(c)}return new Bi(s,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var i=Ar(t.firestore);return function(t,e,n,r,i,o){var s=t.explicitOrderBy;if(i.length>s.length)throw new gi(yi.INVALID_ARGUMENT,\"Too many arguments provided to \"+r+\"(). The number of arguments must be less than or equal to the number of orderBy() clauses\");for(var a,u=[],c=0;c<i.length;c++)if(a=i[c],s[c].field.isKeyField()){if(\"string\"!=typeof a)throw new gi(yi.INVALID_ARGUMENT,\"Invalid query. Expected a string for document ID in \"+r+\"(), but got a \"+typeof a);if(!rt(t)&&-1!==a.indexOf(\"/\"))throw new gi(yi.INVALID_ARGUMENT,\"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to \"+r+\"() must be a plain document ID, but '\"+a+\"' contains a slash.\");var h=t.path.child(_i.fromString(a));if(!Ci.isDocumentKey(h))throw new gi(yi.INVALID_ARGUMENT,\"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to \"+r+\"() must result in a valid document path, but '\"+h+\"' is not because it contains an odd number of segments.\");var l=new Ci(h);u.push(x(e,l))}else{var f=kr(n,r,a);u.push(f)}return new Bi(u,o)}(t._query,t.firestore._databaseId,i,e,n,r)}function Qr(t,e,n){if(\"string\"==typeof(n=Object(li.h)(n))){if(\"\"===n)throw new gi(yi.INVALID_ARGUMENT,\"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.\");if(!rt(e)&&-1!==n.indexOf(\"/\"))throw new gi(yi.INVALID_ARGUMENT,\"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '\"+n+\"' contains a '/' character.\");var r=e.path.child(_i.fromString(n));if(!Ci.isDocumentKey(r))throw new gi(yi.INVALID_ARGUMENT,\"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '\"+r+\"' is not because it has an odd number of segments (\"+r.length+\").\");return x(t,new Ci(r))}if(n instanceof Va)return x(t,n._key);throw new gi(yi.INVALID_ARGUMENT,\"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: \"+pr(n)+\".\")}function Hr(t,e){if(!Array.isArray(t)||0===t.length)throw new gi(yi.INVALID_ARGUMENT,\"Invalid Query. A non-empty array is required for '\"+e.toString()+\"' filters.\");if(10<t.length)throw new gi(yi.INVALID_ARGUMENT,\"Invalid Query. '\"+e.toString()+\"' filters support a maximum of 10 elements in the value array.\")}function Wr(t,e,n){if(!n.isEqual(e))throw new gi(yi.INVALID_ARGUMENT,\"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '\"+e.toString()+\"' and so you must also use '\"+e.toString()+\"' as your first argument to orderBy(), but your first orderBy() is on field '\"+n.toString()+\"' instead.\")}\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function Yr(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function Xr(t,e){if((t=Object(li.h)(t)).firestore!==e)throw new gi(yi.INVALID_ARGUMENT,\"Provided document reference is from a different Firestore instance.\");return t}\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function $r(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=yr(t,Va);var o=yr(t.firestore,za),s=Ar(o);return Zr(o,[(\"string\"==typeof(e=Object(li.h)(e))||e instanceof Ga?jr(s,\"updateDoc\",t._key,e,n,r):Cr(s,\"updateDoc\",t._key,e)).toMutation(t._key,Ji.exists(!0))])}function Jr(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t=Object(li.h)(t);var s={includeMetadataChanges:!1},a=0;\"object\"!=typeof i[a]||Er(i[a])||(s=i[a],a++);var u,c,h,l={includeMetadataChanges:s.includeMetadataChanges};if(Er(i[a])){var f=i[a];i[a]=null===(e=f.next)||void 0===e?void 0:e.bind(f),i[a+1]=null===(n=f.error)||void 0===n?void 0:n.bind(f),i[a+2]=null===(r=f.complete)||void 0===r?void 0:r.bind(f)}if(t instanceof Va)c=yr(t.firestore,za),h=J(t._key.path),u={next:function(e){i[a]&&i[a](ti(c,t,e))},error:i[a+1],complete:i[a+2]};else{var d=yr(t,Ua);c=yr(d.firestore,za),h=d._query;var p=new Eu(c);u={next:function(t){i[a]&&i[a](new lu(c,p,d,t))},error:i[a+1],complete:i[a+2]},Kr(t._query)}return function(t,e,n,r){var i=this,o=new Ta(u),s=new la(e,o,n);return t.asyncQueue.enqueueAndForget(function(){return Object(hi.b)(i,void 0,void 0,function(){var e;return Object(hi.d)(this,function(n){switch(n.label){case 0:return e=jn,[4,sr(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})}),function(){o.Wo(),t.asyncQueue.enqueueAndForget(function(){return Object(hi.b)(i,void 0,void 0,function(){var e;return Object(hi.d)(this,function(n){switch(n.label){case 0:return e=kn,[4,sr(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})})}}(_r(c),h,l)}function Zr(t,e){return function(t,e){var n=this,r=new Go;return t.asyncQueue.enqueueAndForget(function(){return Object(hi.b)(n,void 0,void 0,function(){var n;return Object(hi.d)(this,function(i){switch(i.label){case 0:return n=Ln,[4,or(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(_r(t),e)}function ti(t,e,n){var r=n.docs.get(e._key),i=new Eu(t);return new cu(t,i,e._key,r,new uu(n.hasPendingWrites,n.fromCache),e.converter)}\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function ei(){if(\"undefined\"==typeof Uint8Array)throw new gi(yi.UNIMPLEMENTED,\"Uint8Arrays are not available in this environment.\")}function ni(){if(\"undefined\"==typeof atob)throw new gi(yi.UNIMPLEMENTED,\"Blobs are unavailable in Firestore in this environment.\")}function ri(t){var e;e=t,vi.setLogLevel(e)}function ii(t,e,n){return t.message=t.message.replace(e,n),t}function oi(t){for(var e,n=0,r=t;n<r.length;n++)if(\"object\"==typeof(e=r[n])&&!Er(e))return e;return{}}function si(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=Er(t[0])?t[0]:Er(t[1])?t[1]:\"function\"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}function ai(t){return yr(t,Va)}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */var ui=Number.POSITIVE_INFINITY,ci=Number.NEGATIVE_INFINITY;n.d(e,\"a\",function(){return Tu}),n.d(e,\"b\",function(){return Wa}),n.d(e,\"c\",function(){return za}),n.d(e,\"d\",function(){return Cu}),n.d(e,\"e\",function(){return ri}),n.d(e,\"f\",function(){return bi}),n.d(e,\"g\",function(){return Au}),n.d(e,\"h\",function(){return ku}),n.d(e,\"i\",function(){return ju}),n.d(e,\"j\",function(){return Ru}),n.d(e,\"k\",function(){return Iu}),n.d(e,\"l\",function(){return Lu}),n.d(e,\"m\",function(){return Mu}),n.d(e,\"n\",function(){return Du}),n.d(e,\"o\",function(){return Pu}),n.d(e,\"p\",function(){return Ka}),n.d(e,\"q\",function(){return Ou}),n.d(e,\"r\",function(){return Fu});var hi=n(0),li=n(1),fi=n(4),di=n(3),pi=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=r(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();\n/**\n * @license\n * Copyright 2018 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */pi.o=-1;\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar yi={OK:\"ok\",CANCELLED:\"cancelled\",UNKNOWN:\"unknown\",INVALID_ARGUMENT:\"invalid-argument\",DEADLINE_EXCEEDED:\"deadline-exceeded\",NOT_FOUND:\"not-found\",ALREADY_EXISTS:\"already-exists\",PERMISSION_DENIED:\"permission-denied\",UNAUTHENTICATED:\"unauthenticated\",RESOURCE_EXHAUSTED:\"resource-exhausted\",FAILED_PRECONDITION:\"failed-precondition\",ABORTED:\"aborted\",OUT_OF_RANGE:\"out-of-range\",UNIMPLEMENTED:\"unimplemented\",INTERNAL:\"internal\",UNAVAILABLE:\"unavailable\",DATA_LOSS:\"data-loss\"},gi=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name=\"FirebaseError\",r.toString=function(){return r.name+\": [code=\"+r.code+\"]: \"+r.message},r}return Object(hi.c)(e,t),e}(Error),vi=new fi.b(\"@firebase/firestore\"),mi=function(){function t(){}return t.u=function(){for(var t=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\",e=i(256/t.length)*t.length,n=\"\";20>n.length;)for(var r=d(40),o=0;o<r.length;++o)20>n.length&&r[o]<e&&(n+=t.charAt(r[o]%t.length));return n},t}(),bi=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,0>e)throw new gi(yi.INVALID_ARGUMENT,\"Timestamp nanoseconds out of range: \"+e);if(1e9<=e)throw new gi(yi.INVALID_ARGUMENT,\"Timestamp nanoseconds out of range: \"+e);if(-62135596800>t)throw new gi(yi.INVALID_ARGUMENT,\"Timestamp seconds out of range: \"+t);if(253402300800<=t)throw new gi(yi.INVALID_ARGUMENT,\"Timestamp seconds out of range: \"+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=i(e/1e3);return new t(n,i(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?p(this.nanoseconds,t.nanoseconds):p(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return\"Timestamp(seconds=\"+this.seconds+\", nanoseconds=\"+this.nanoseconds+\")\"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){return(this.seconds- -62135596800+\"\").padStart(12,\"0\")+\".\"+(this.nanoseconds+\"\").padStart(9,\"0\")},t}(),wi=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new bi(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return\"SnapshotVersion(\"+this.timestamp.toString()+\")\"},t.prototype.toTimestamp=function(){return this.timestamp},t}(),Ei=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&h(),void 0===n?n=t.length-e:n>t.length-e&&h(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,\"length\",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),_i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(hi.c)(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join(\"/\")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r,i=[],o=0,s=t;o<s.length;o++){if(0<=(r=s[o]).indexOf(\"//\"))throw new gi(yi.INVALID_ARGUMENT,\"Invalid segment (\"+r+\"). Paths must not contain // in them.\");i.push.apply(i,r.split(\"/\").filter(function(t){return 0<t.length}))}return new e(i)},e.emptyPath=function(){return new e([])},e}(Ei),Ii=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ti=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(hi.c)(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return Ii.test(t)},e.prototype.canonicalString=function(){return this.toArray().map(function(t){return t=t.replace(/\\\\/g,\"\\\\\\\\\").replace(/`/g,\"\\\\`\"),e.isValidIdentifier(t)||(t=\"`\"+t+\"`\"),t}).join(\".\")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&\"__name__\"===this.get(0)},e.keyField=function(){return new e([\"__name__\"])},e.fromServerFormat=function(t){for(var n,r=[],i=\"\",o=0,s=function(){if(0===i.length)throw new gi(yi.INVALID_ARGUMENT,\"Invalid field path (\"+t+\"). Paths must not be empty, begin with '.', end with '.', or contain '..'\");r.push(i),i=\"\"},a=!1;o<t.length;)if(\"\\\\\"===(n=t[o])){if(o+1===t.length)throw new gi(yi.INVALID_ARGUMENT,\"Path has trailing escape character: \"+t);var u=t[o+1];if(\"\\\\\"!==u&&\".\"!==u&&\"`\"!==u)throw new gi(yi.INVALID_ARGUMENT,\"Path has invalid escape sequence: \"+t);i+=u,o+=2}else\"`\"===n?(a=!a,o++):\".\"!==n||a?(i+=n,o++):(s(),o++);if(s(),a)throw new gi(yi.INVALID_ARGUMENT,\"Unterminated ` in path: \"+t);return new e(r)},e.emptyPath=function(){return new e([])},e}(Ei),Oi=function(){function t(t){this.fields=t,t.sort(Ti.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return y(this.fields,t.fields,function(t,e){return t.isEqual(e)})},t}(),Si=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e=\"\",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.binaryString,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return p(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();Si.EMPTY_BYTE_STRING=new Si(\"\");var Ai,Di,Ni=new RegExp(/^\\d{4}-\\d\\d-\\d\\dT\\d\\d:\\d\\d:\\d\\d(?:\\.(\\d+))?Z$/),Ci=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(_i.fromString(e))},t.fromName=function(e){return new t(_i.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===_i.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return _i.comparator(t.path,e.path)},t.isDocumentKey=function(t){return 0==t.length%2},t.fromSegments=function(e){return new t(new _i(e.slice()))},t}(),ji=function(){function t(t){this.value=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!V(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},t.prototype.set=function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=U(e)},t.prototype.setAll=function(t){var e=this,n=Ti.emptyPath(),r={},i=[];t.forEach(function(t,o){if(!n.isImmediateParentOf(o)){var s=e.getFieldsMap(n);e.applyChanges(s,r,i),r={},i=[],n=o.popLast()}t?r[o.lastSegment()]=U(t):i.push(o.lastSegment())});var o=this.getFieldsMap(n);this.applyChanges(o,r,i)},t.prototype.delete=function(t){var e=this.field(t.popLast());V(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]},t.prototype.isEqual=function(t){return N(this.value,t.value)},t.prototype.getFieldsMap=function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n,r=0;r<t.length;++r)V(n=e.mapValue.fields[t.get(r)])&&n.mapValue.fields||(n={mapValue:{fields:{}}},e.mapValue.fields[t.get(r)]=n),e=n;return e.mapValue.fields},t.prototype.applyChanges=function(t,e,n){m(e,function(e,n){return t[e]=n});for(var r,i=0,o=n;i<o.length;i++)r=o[i],delete t[r]},t.prototype.clone=function(){return new t(U(this.value))},t}(),ki=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,wi.min(),ji.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,ji.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,ji.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=ji.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=ji.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,\"hasLocalMutations\",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"hasCommittedMutations\",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"hasPendingWrites\",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return\"Document(\"+this.key+\", \"+this.version+\", \"+JSON.stringify(this.data.value)+\", {documentType: \"+this.documentType+\"}), {documentState: \"+this.documentState+\"})\"},t}(),Ri=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.h=null},xi=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Object(hi.c)(e,t),e.create=function(t,n,r){return t.isKeyField()?\"in\"===n||\"not-in\"===n?this.l(t,n,r):new Li(t,n,r):\"array-contains\"===n?new Fi(t,r):\"in\"===n?new Vi(t,r):\"not-in\"===n?new Ui(t,r):\"array-contains-any\"===n?new qi(t,r):new e(t,n,r)},e.l=function(t,e,n){return\"in\"===e?new Pi(t,n):new Mi(t,n)},e.prototype.matches=function(t){var e=t.data.field(this.field);return\"!=\"===this.op?null!==e&&this.m(j(e,this.value)):null!==e&&D(this.value)===D(e)&&this.m(j(e,this.value))},e.prototype.m=function(t){switch(this.op){case\"<\":return 0>t;case\"<=\":return 0>=t;case\"==\":return 0===t;case\"!=\":return 0!==t;case\">\":return 0<t;case\">=\":return 0<=t;default:return h()}},e.prototype.g=function(){return 0<=[\"<\",\"<=\",\">\",\">=\",\"!=\",\"not-in\"].indexOf(this.op)},e}(function(){}),Li=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=Ci.fromName(r.referenceValue),i}return Object(hi.c)(e,t),e.prototype.matches=function(t){var e=Ci.comparator(t.key,this.key);return this.m(e)},e}(xi),Pi=function(t){function e(e,n){var r=this;return(r=t.call(this,e,\"in\",n)||this).keys=Q(0,n),r}return Object(hi.c)(e,t),e.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},e}(xi),Mi=function(t){function e(e,n){var r=this;return(r=t.call(this,e,\"not-in\",n)||this).keys=Q(0,n),r}return Object(hi.c)(e,t),e.prototype.matches=function(t){return!this.keys.some(function(e){return e.isEqual(t.key)})},e}(xi),Fi=function(t){function e(e,n){return t.call(this,e,\"array-contains\",n)||this}return Object(hi.c)(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return P(e)&&C(e.arrayValue,this.value)},e}(xi),Vi=function(t){function e(e,n){return t.call(this,e,\"in\",n)||this}return Object(hi.c)(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&C(this.value.arrayValue,e)},e}(xi),Ui=function(t){function e(e,n){return t.call(this,e,\"not-in\",n)||this}return Object(hi.c)(e,t),e.prototype.matches=function(t){if(C(this.value.arrayValue,{nullValue:\"NULL_VALUE\"}))return!1;var e=t.data.field(this.field);return null!==e&&!C(this.value.arrayValue,e)},e}(xi),qi=function(t){function e(e,n){return t.call(this,e,\"array-contains-any\",n)||this}return Object(hi.c)(e,t),e.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return P(n)&&n.arrayValue.values&&n.arrayValue.values.some(function(t){return C(e.value.arrayValue,t)})},e}(xi),Bi=function(t,e){this.position=t,this.before=e},Ki=function(t,e){void 0===e&&(e=\"asc\"),this.field=t,this.dir=e},zi=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=\"F\"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.p=null,this.T=null,this.startAt,this.endAt},Gi=function(){this._=void 0},Qi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(hi.c)(e,t),e}(Gi),Hi=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(hi.c)(e,t),e}(Gi),Wi=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(hi.c)(e,t),e}(Gi),Yi=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return Object(hi.c)(e,t),e}(Gi),Xi=function(t,e){this.field=t,this.transform=e},$i=function(t,e){this.version=t,this.transformResults=e},Ji=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,\"isNone\",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}(),Zi=function(){},to=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return Object(hi.c)(e,t),e}(Zi),eo=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.fieldMask=r,s.precondition=i,s.fieldTransforms=o,s.type=1,s}return Object(hi.c)(e,t),e}(Zi),no=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return Object(hi.c)(e,t),e}(Zi),ro=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return Object(hi.c)(e,t),e}(Zi),io=function(t){this.count=t};(Di=Ai||(Ai={}))[Di.OK=0]=\"OK\",Di[Di.CANCELLED=1]=\"CANCELLED\",Di[Di.UNKNOWN=2]=\"UNKNOWN\",Di[Di.INVALID_ARGUMENT=3]=\"INVALID_ARGUMENT\",Di[Di.DEADLINE_EXCEEDED=4]=\"DEADLINE_EXCEEDED\",Di[Di.NOT_FOUND=5]=\"NOT_FOUND\",Di[Di.ALREADY_EXISTS=6]=\"ALREADY_EXISTS\",Di[Di.PERMISSION_DENIED=7]=\"PERMISSION_DENIED\",Di[Di.UNAUTHENTICATED=16]=\"UNAUTHENTICATED\",Di[Di.RESOURCE_EXHAUSTED=8]=\"RESOURCE_EXHAUSTED\",Di[Di.FAILED_PRECONDITION=9]=\"FAILED_PRECONDITION\",Di[Di.ABORTED=10]=\"ABORTED\",Di[Di.OUT_OF_RANGE=11]=\"OUT_OF_RANGE\",Di[Di.UNIMPLEMENTED=12]=\"UNIMPLEMENTED\",Di[Di.INTERNAL=13]=\"INTERNAL\",Di[Di.UNAVAILABLE=14]=\"UNAVAILABLE\",Di[Di.DATA_LOSS=15]=\"DATA_LOSS\";\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar oo=function(){function t(t,e){this.comparator=t,this.root=e||ao.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ao.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ao.BLACK,null,null))},t.prototype.get=function(t){for(var e,n=this.root;!n.isEmpty();){if(0===(e=this.comparator(t,n.key)))return n.value;0>e?n=n.left:0<e&&(n=n.right)}return null},t.prototype.indexOf=function(t){for(var e,n=0,r=this.root;!r.isEmpty();){if(0===(e=this.comparator(t,r.key)))return n+r.left.size;0>e?r=r.left:(n+=r.left.size+1,r=r.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,\"size\",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.inorderTraversal(function(e,n){return t.push(e+\":\"+n),!1}),\"{\"+t.join(\", \")+\"}\"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new so(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new so(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new so(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new so(this.root,t,this.comparator,!0)},t}(),so=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),0>i)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return 0<this.nodeStack.length},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),ao=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null==r?t.RED:r,this.left=null==i?t.EMPTY:i,this.right=null==o?t.EMPTY:o,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null==e?this.key:e,null==n?this.value:n,null==r?this.color:r,null==i?this.left:i,null==o?this.right:o)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=0>i?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(0>n(e,i.key))i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw h();if(this.right.isRed())throw h();var t=this.left.check();if(t!==this.right.check())throw h();return t+(this.isRed()?0:1)},t}();ao.EMPTY=null,ao.RED=!0,ao.BLACK=!1,ao.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,\"key\",{get:function(){throw h()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"value\",{get:function(){throw h()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"color\",{get:function(){throw h()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"left\",{get:function(){throw h()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"right\",{get:function(){throw h()},enumerable:!1,configurable:!0}),t.prototype.copy=function(){return this},t.prototype.insert=function(t,e){return new ao(t,e)},t.prototype.remove=function(){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(){return!1},t.prototype.reverseTraversal=function(){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar uo=function(){function t(t){this.comparator=t,this.data=new oo(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,\"size\",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal(function(e){return t(e),!1})},t.prototype.forEachInRange=function(t,e){for(var n,r=this.data.getIteratorFrom(t[0]);r.hasNext();){if(n=r.getNext(),0<=this.comparator(n.key,t[1]))return;e(n.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0===e?this.data.getIterator():this.data.getIteratorFrom(e);n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new co(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new co(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),\"SortedSet(\"+t.toString()+\")\"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),co=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),ho=new oo(Ci.comparator),lo=new oo(Ci.comparator),fo=new oo(Ci.comparator),po=new uo(Ci.comparator),yo=new uo(p),go=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,vo.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(wi.min(),r,Ft(),xt(),Mt())},t}(),vo=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(Si.EMPTY_BYTE_STRING,n,Mt(),Mt(),Mt())},t}(),mo=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},bo=function(t,e){this.targetId=t,this.V=e},wo=function(t,e,n,r){void 0===n&&(n=Si.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Eo=function(){function t(){this.S=0,this.D=Ut(),this.C=Si.EMPTY_BYTE_STRING,this.N=!1,this.F=!0}return Object.defineProperty(t.prototype,\"current\",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"resumeToken\",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"k\",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"$\",{get:function(){return this.F},enumerable:!1,configurable:!0}),t.prototype.O=function(t){0<t.approximateByteSize()&&(this.F=!0,this.C=t)},t.prototype.M=function(){var t=Mt(),e=Mt(),n=Mt();return this.D.forEach(function(r,i){0===i?t=t.add(r):2===i?e=e.add(r):1===i?n=n.add(r):h()}),new vo(this.C,this.N,t,e,n)},t.prototype.L=function(){this.F=!1,this.D=Ut()},t.prototype.B=function(t,e){this.F=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.F=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.F=!0,this.N=!0},t}(),_o=function(){function t(t){this.W=t,this.G=new Map,this.H=xt(),this.J=Vt(),this.Y=new uo(p)}return t.prototype.X=function(t){for(var e,n=0,r=t.v;n<r.length;n++)e=r[n],t.P&&t.P.isFoundDocument()?this.Z(e,t.P):this.tt(e,t.key,t.P);for(var i=0,o=t.removedTargetIds;i<o.length;i++)e=o[i],this.tt(e,t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.O(t.resumeToken);break;case 1:r.K(),r.k||r.L(),r.O(t.resumeToken);break;case 2:r.K(),r.k||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.O(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.O(t.resumeToken));break;default:h()}})},t.prototype.forEachTarget=function(t,e){var n=this;0<t.targetIds.length?t.targetIds.forEach(e):this.G.forEach(function(t,r){n.st(r)&&e(r)})},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(G(i))if(0===n){var o=new Ci(i.path);this.tt(e,o,ki.newNoDocument(o,wi.min()))}else l(1===n);else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.ut=function(t){var e=this,n=new Map;this.G.forEach(function(r,i){var o=e.ot(i);if(o){if(r.current&&G(o.target)){var s=new Ci(o.target.path);null!==e.H.get(s)||e.at(i,s)||e.tt(i,s,ki.newNoDocument(s,t))}r.$&&(n.set(i,r.M()),r.L())}});var r=Mt();this.J.forEach(function(t,n){var i=!0;n.forEachWhile(function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)}),i&&(r=r.add(t))});var i=new go(t,n,this.Y,this.H,r);return this.H=xt(),this.J=Vt(),this.Y=new uo(p),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.at(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new Eo,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new uo(p),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||s(\"WatchChangeAggregator\",\"Detected inactive target\",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.k?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new Eo),this.W.getRemoteKeysForTarget(t).forEach(function(n){e.tt(t,n,null)})},t.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}(),Io={asc:\"ASCENDING\",desc:\"DESCENDING\"},To={\"<\":\"LESS_THAN\",\"<=\":\"LESS_THAN_OR_EQUAL\",\">\":\"GREATER_THAN\",\">=\":\"GREATER_THAN_OR_EQUAL\",\"==\":\"EQUAL\",\"!=\":\"NOT_EQUAL\",\"array-contains\":\"ARRAY_CONTAINS\",in:\"IN\",\"not-in\":\"NOT_IN\",\"array-contains-any\":\"ARRAY_CONTAINS_ANY\"},Oo=function(t,e){this.databaseId=t,this.I=e},So=function(t,e){this.seconds=t,this.nanoseconds=e},Ao=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Ao.store=\"owner\",Ao.key=\"owner\";var Do=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Do.store=\"mutationQueues\",Do.keyPath=\"userId\";var No=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};No.store=\"mutations\",No.keyPath=\"batchId\",No.userMutationsIndex=\"userMutationsIndex\",No.userMutationsKeyPath=[\"userId\",\"batchId\"];var Co=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,he(e)]},t.key=function(t,e,n){return[t,he(e),n]},t}();Co.store=\"documentMutations\",Co.PLACEHOLDER=new Co;var jo=function(t,e){this.path=t,this.readTime=e},ko=function(t,e){this.path=t,this.version=e},Ro=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Ro.store=\"remoteDocuments\",Ro.readTimeIndex=\"readTimeIndex\",Ro.readTimeIndexPath=\"readTime\",Ro.collectionReadTimeIndex=\"collectionReadTimeIndex\",Ro.collectionReadTimeIndexPath=[\"parentPath\",\"readTime\"];var xo=function(t){this.byteSize=t};xo.store=\"remoteDocumentGlobal\",xo.key=\"remoteDocumentGlobalKey\";var Lo=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Lo.store=\"targets\",Lo.keyPath=\"targetId\",Lo.queryTargetsIndexName=\"queryTargetsIndex\",Lo.queryTargetsKeyPath=[\"canonicalId\",\"targetId\"];var Po=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Po.store=\"targetDocuments\",Po.keyPath=[\"targetId\",\"path\"],Po.documentTargetsIndex=\"documentTargetsIndex\",Po.documentTargetsKeyPath=[\"path\",\"targetId\"];var Mo=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Mo.key=\"targetGlobalKey\",Mo.store=\"targetGlobal\";var Fo=function(t,e){this.collectionId=t,this.parent=e};Fo.store=\"collectionParents\",Fo.keyPath=[\"collectionId\",\"parent\"];var Vo=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Vo.store=\"clientMetadata\",Vo.keyPath=\"clientId\";var Uo=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Uo.store=\"bundles\",Uo.keyPath=\"bundleId\";var qo=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};qo.store=\"namedQueries\",qo.keyPath=\"name\";var Bo=Object(hi.f)(Object(hi.f)([],Object(hi.f)(Object(hi.f)([],Object(hi.f)(Object(hi.f)([],Object(hi.f)(Object(hi.f)([],[Do.store,No.store,Co.store,Ro.store,Lo.store,Ao.store,Mo.store,Po.store]),[Vo.store])),[xo.store])),[Fo.store])),[Uo.store,qo.store]),Ko=\"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.\",zo=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach(function(t){return t()})},t}(),Go=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})},Qo=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)},function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&h(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t(function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}})},t.prototype.toPromise=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.waitFor=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i==r&&t()},function(t){return n(t)})}),o=!0,i==r&&t()})},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.waitFor(r)},t}(),Ho=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new Go,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new Xo(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=ge(e.target.error);n.ft.reject(new Xo(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new Xo(n,e)}},Object.defineProperty(t.prototype,\"dt\",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(s(\"SimpleDb\",\"Aborting transaction:\",t?t.message:\"Client-initiated abort\"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new $o(e)},t}(),Wo=function(){function e(t,n,r){this.name=t,this.version=n,this.wt=r,12.2===e._t(Object(li.i)())&&a(\"Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.\")}return e.delete=function(t){return s(\"SimpleDb\",\"Removing database:\",t),ye(window.indexedDB.deleteDatabase(t)).toPromise()},e.yt=function(){if(\"undefined\"==typeof indexedDB)return!1;if(e.gt())return!0;var t=Object(li.i)(),n=e._t(t),r=e.Et(t);return!(0<t.indexOf(\"MSIE \")||0<t.indexOf(\"Trident/\")||0<t.indexOf(\"Edge/\")||0<n&&10>n||0<r&&4.5>r)},e.gt=function(){var e;return void 0!==t&&\"YES\"===(null===(e=t.env)||void 0===e?void 0:e.Tt)},e.It=function(t,e){return t.store(e)},e._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\\d_]+)/i);return+(e?e[1].split(\"_\").slice(0,2).join(\".\"):\"-1\")},e.Et=function(t){var e=t.match(/Android ([\\d.]+)/i);return+(e?e[1].split(\".\").slice(0,2).join(\".\"):\"-1\")},e.prototype.At=function(t){return Object(hi.b)(this,void 0,void 0,function(){var e,n=this;return Object(hi.d)(this,function(r){switch(r.label){case 0:return this.db?[3,2]:(s(\"SimpleDb\",\"Opening database:\",this.name),e=this,[4,new Promise(function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new Xo(t,\"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed.\"))},i.onerror=function(e){var n=e.target.error;\"VersionError\"===n.name?r(new gi(yi.FAILED_PRECONDITION,\"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.\")):r(new Xo(t,n))},i.onupgradeneeded=function(t){s(\"SimpleDb\",'Database \"'+n.name+'\" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.wt.Rt(e,i.transaction,t.oldVersion,n.version).next(function(){s(\"SimpleDb\",\"Database upgrade to version \"+n.version+\" complete\")})}})]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}})})},e.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},e.prototype.runTransaction=function(t,e,n,r){return Object(hi.b)(this,void 0,void 0,function(){var i,o,a,u,c;return Object(hi.d)(this,function(h){switch(h.label){case 0:i=\"readonly\"===e,o=0,a=function(){var e,a,c,h,l;return Object(hi.d)(this,function(f){switch(f.label){case 0:++o,f.label=1;case 1:return f.trys.push([1,4,,5]),[4,u.At(t)];case 2:return u.db=f.sent(),e=Ho.open(u.db,t,i?\"readonly\":\"readwrite\",n),a=r(e).catch(function(t){return e.abort(t),Qo.reject(t)}).toPromise(),c={},a.catch(function(){}),[4,e.dt];case 3:return[2,(c.value=(f.sent(),a),c)];case 4:return h=f.sent(),l=\"FirebaseError\"!==h.name&&3>o,s(\"SimpleDb\",\"Transaction failed with error:\",h.message,\"Retrying:\",l),u.close(),l?[3,5]:[2,{value:Promise.reject(h)}];case 5:return[2]}})},u=this,h.label=1;case 1:return[5,a()];case 2:if(\"object\"==typeof(c=h.sent()))return[2,c.value];h.label=3;case 3:return[3,1];case 4:return[2]}})})},e.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},e}(),Yo=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,\"isDone\",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"Dt\",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"cursor\",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return ye(this.Pt.delete())},t}(),Xo=function(t){function e(e,n){var r=this;return(r=t.call(this,yi.UNAVAILABLE,\"IndexedDB transaction '\"+e+\"' failed: \"+n)||this).name=\"IndexedDbTransactionError\",r}return Object(hi.c)(e,t),e}(gi),$o=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0===e?(s(\"SimpleDb\",\"PUT\",this.store.name,\"<auto-key>\",t),n=this.store.put(t)):(s(\"SimpleDb\",\"PUT\",this.store.name,t,e),n=this.store.put(e,t)),ye(n)},t.prototype.add=function(t){return s(\"SimpleDb\",\"ADD\",this.store.name,t,t),ye(this.store.add(t))},t.prototype.get=function(t){var e=this;return ye(this.store.get(t)).next(function(n){return void 0===n&&(n=null),s(\"SimpleDb\",\"GET\",e.store.name,t,n),n})},t.prototype.delete=function(t){return s(\"SimpleDb\",\"DELETE\",this.store.name,t),ye(this.store.delete(t))},t.prototype.count=function(){return s(\"SimpleDb\",\"COUNT\",this.store.name),ye(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.Ft=function(t,e){s(\"SimpleDb\",\"DELETE ALL\",this.store.name);var n=this.options(t,e);n.kt=!1;var r=this.cursor(n);return this.xt(r,function(t,e,n){return n.delete()})},t.prototype.$t=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.xt(r,e)},t.prototype.Ot=function(t){var e=this.cursor({});return new Qo(function(n,r){e.onerror=function(t){var e=ge(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.xt=function(t,e){var n=[];return new Qo(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Yo(i),s=e(i.primaryKey,i.value,o);if(s instanceof Qo){var a=s.catch(function(t){return o.done(),Qo.reject(t)});n.push(a)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}}).next(function(){return Qo.waitFor(n)})},t.prototype.options=function(t,e){var n;return void 0!==t&&(\"string\"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e=\"next\";if(t.reverse&&(e=\"prev\"),t.index){var n=this.store.index(t.index);return t.kt?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}(),Jo=!1,Zo=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return Object(hi.c)(e,t),e}(zo),ts=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n,r=e.mutationResults,i=0;i<this.mutations.length;i++)(n=this.mutations[i]).key.isEqual(t.key)&&Tt(n,t,r[i])},t.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(o=n[e]).key.isEqual(t.key)&&Ot(o,t,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(t.key)&&Ot(o,t,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach(function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(wi.min())})},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Mt())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&y(this.mutations,t.mutations,function(t,e){return At(t,e)})&&y(this.baseMutations,t.baseMutations,function(t,e){return At(t,e)})},t}(),es=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){l(e.mutations.length===r.length);for(var i=Pt(),o=e.mutations,s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),ns=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=wi.min()),void 0===o&&(o=wi.min()),void 0===s&&(s=Si.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),rs=function(t){this.Lt=t},is=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return De(t).get(e).next(function(t){if(t)return{id:(e=t).bundleId,createTime:Ie(e.createTime),version:e.version};var e})},t.prototype.saveBundleMetadata=function(t,e){return De(t).put({bundleId:(n=e).id,createTime:_e(Kt(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return Ne(t).get(e).next(function(t){if(t)return{name:(e=t).name,query:Ae(e.bundledQuery),readTime:Ie(e.readTime)};var e})},t.prototype.saveNamedQuery=function(t,e){return Ne(t).put({name:(n=e).name,readTime:_e(Kt(n.readTime)),bundledQuery:n.bundledQuery});var n},t}(),os=function(){function t(){this.Bt=new ss}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),Qo.resolve()},t.prototype.getCollectionParents=function(t,e){return Qo.resolve(this.Bt.getEntries(e))},t}(),ss=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new uo(_i.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new uo(_i.comparator)).toArray()},t}(),as=function(){function t(){this.qt=new ss}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener(function(){n.qt.add(e)});var o={collectionId:r,parent:he(i)};return Ce(t).put(o)}return Qo.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,\"\"],[g(e),\"\"],!1,!0);return Ce(t).Nt(r).next(function(t){for(var r,i=0,o=t;i<o.length&&(r=o[i]).collectionId===e;i++)n.push(de(r.parent));return n})},t}(),us={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},cs=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();cs.DEFAULT_COLLECTION_PERCENTILE=10,cs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,cs.DEFAULT=new cs(41943040,cs.DEFAULT_COLLECTION_PERCENTILE,cs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),cs.DISABLED=new cs(-1,0,0);var hs=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Kt={}}return t.Qt=function(e,n,r,i){return l(\"\"!==e.uid),new t(e.isAuthenticated()?e.uid:\"\",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,ci],[this.userId,ui]);return xe(t).$t({index:No.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=Le(t),s=xe(t);return s.add({}).next(function(a){l(\"number\"==typeof a);for(var u=new ts(a,e,n,r),c=function(t,e,n){var r=n.baseMutations.map(function(e){return te(t.Lt,e)}),i=n.mutations.map(function(e){return te(t.Lt,e)});return new No(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),h=[],f=new uo(function(t,e){return p(t.canonicalString(),e.canonicalString())}),d=0,y=r;d<y.length;d++){var g=y[d],v=Co.key(i.userId,g.key.path,a);f=f.add(g.key.path.popLast()),h.push(s.put(c)),h.push(o.put(v,Co.PLACEHOLDER))}return f.forEach(function(e){h.push(i.Ut.addToCollectionParentIndex(t,e))}),t.addOnCommittedListener(function(){i.Kt[a]=u.keys()}),Qo.waitFor(h).next(function(){return u})})},t.prototype.lookupMutationBatch=function(t,e){var n=this;return xe(t).get(e).next(function(t){return t?(l(t.userId===n.userId),Te(n.R,t)):null})},t.prototype.jt=function(t,e){var n=this;return this.Kt[e]?Qo.resolve(this.Kt[e]):this.lookupMutationBatch(t,e).next(function(t){if(t){var r=t.keys();return n.Kt[e]=r,r}return null})},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return xe(t).$t({index:No.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(l(e.batchId>=r),o=Te(n.R,e)),i.done()}).next(function(){return o})},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,ui]),n=-1;return xe(t).$t({index:No.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,ui]);return xe(t).Nt(No.userMutationsIndex,n).next(function(t){return t.map(function(t){return Te(e.R,t)})})},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=Co.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Le(t).$t({range:i},function(r,i,s){var a=r[0],u=r[1],c=r[2],f=de(u);return a===n.userId&&e.path.isEqual(f)?xe(t).get(c).next(function(t){if(!t)throw h();l(t.userId===n.userId),o.push(Te(n.R,t))}):void s.done()}).next(function(){return o})},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new uo(p),i=[];return e.forEach(function(e){var o=Co.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=Le(t).$t({range:s},function(t,i,o){var s=t[0],a=t[1],u=t[2],c=de(a);s===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()});i.push(a)}),Qo.waitFor(i).next(function(){return n.Wt(t,r)})},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=Co.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new uo(p);return Le(t).$t({range:s},function(t,e,o){var s=t[0],u=t[1],c=t[2],h=de(u);s===n.userId&&r.isPrefixOf(h)?h.length===i&&(a=a.add(c)):o.done()}).next(function(){return n.Wt(t,a)})},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(xe(t).get(e).next(function(t){if(null===t)throw h();l(t.userId===n.userId),r.push(Te(n.R,t))}))}),Qo.waitFor(i).next(function(){return r})},t.prototype.removeMutationBatch=function(t,e){var n=this;return je(t.Mt,this.userId,e).next(function(r){return t.addOnCommittedListener(function(){n.Gt(e.batchId)}),Qo.forEach(r,function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)})})},t.prototype.Gt=function(t){delete this.Kt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next(function(n){if(!n)return Qo.resolve();var r=IDBKeyRange.lowerBound(Co.prefixForUser(e.userId)),i=[];return Le(t).$t({range:r},function(t,n,r){if(t[0]===e.userId){var o=de(t[1]);i.push(o)}else r.done()}).next(function(){l(0===i.length)})})},t.prototype.containsKey=function(t,e){return Re(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return Pe(t).get(this.userId).next(function(t){return t||new Do(e.userId,-1,\"\")})},t}(),ls=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),fs=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next(function(n){var r=new ls(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next(function(){return n.highestTargetId})})},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next(function(t){return wi.fromTimestamp(new bi(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next(function(t){return t.highestListenSequenceNumber})},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)})},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next(function(){return n.Xt(t).next(function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)})})},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next(function(){return Me(t).delete(e.targetId)}).next(function(){return n.Xt(t)}).next(function(e){return l(0<e.targetCount),e.targetCount-=1,n.Zt(t,e)})},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return Me(t).$t(function(s,a){var u=Oe(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))}).next(function(){return Qo.waitFor(o)}).next(function(){return i})},t.prototype.forEachTarget=function(t,e){return Me(t).$t(function(t,n){var r=Oe(n);e(r)})},t.prototype.Xt=function(t){return Fe(t).get(Mo.key).next(function(t){return l(null!==t),t})},t.prototype.Zt=function(t,e){return Fe(t).put(Mo.key,e)},t.prototype.te=function(t,e){return Me(t).put(Se(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next(function(t){return t.targetCount})},t.prototype.getTargetData=function(t,e){var n=K(e),r=IDBKeyRange.bound([n,ci],[n,ui]),i=null;return Me(t).$t({range:r,index:Lo.queryTargetsIndexName},function(t,n,r){var o=Oe(n);z(e,o.target)&&(i=o,r.done())}).next(function(){return i})},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=Ve(t);return e.forEach(function(e){var s=he(e.path);i.push(o.put(new Po(n,s))),i.push(r.referenceDelegate.addReference(t,n,e))}),Qo.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=Ve(t);return Qo.forEach(e,function(e){var o=he(e.path);return Qo.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])})},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=Ve(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Ve(t),i=Mt();return r.$t({range:n,kt:!0},function(t){var e=de(t[1]),n=new Ci(e);i=i.add(n)}).next(function(){return i})},t.prototype.containsKey=function(t,e){var n=he(e.path),r=IDBKeyRange.bound([n],[g(n)],!1,!0),i=0;return Ve(t).$t({index:Po.documentTargetsIndex,kt:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},t.prototype.lt=function(t,e){return Me(t).get(e).next(function(t){return t?Oe(t):null})},t}(),ds=function(){function t(t){this.ne=t,this.buffer=new uo(qe),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();0>qe(e,n)&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,\"maxValue\",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),ps=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,\"started\",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ue=function(t){var e=this,n=this.oe?3e5:6e4;s(\"LruGarbageCollector\",\"Garbage collection scheduled in \"+n+\"ms\"),this.ce=this.asyncQueue.enqueueAfterDelay(\"lru_garbage_collection\",n,function(){return Object(hi.b)(e,void 0,void 0,function(){var e;return Object(hi.d)(this,function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return pe(e=n.sent())?(s(\"LruGarbageCollector\",\"Ignoring IndexedDB error during garbage collection: \",e),[3,6]):[3,4];case 4:return[4,Ue(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(t)];case 8:return n.sent(),[2]}})})})},t}(),ys=function(){function t(t,e){this.ae=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ae.he(t).next(function(t){return i(e/100*t)})},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return Qo.resolve(pi.o);var r=new ds(e);return this.ae.forEachTarget(t,function(t){return r.re(t.sequenceNumber)}).next(function(){return n.ae.le(t,function(t){return r.re(t)})}).next(function(){return r.maxValue})},t.prototype.removeTargets=function(t,e,n){return this.ae.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ae.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(s(\"LruGarbageCollector\",\"Garbage collection skipped; disabled\"),Qo.resolve(us)):this.getCacheSize(t).next(function(r){return r<n.params.cacheSizeCollectionThreshold?(s(\"LruGarbageCollector\",\"Garbage collection skipped; Cache size \"+r+\" is lower than threshold \"+n.params.cacheSizeCollectionThreshold),us):n.fe(t,e)})},t.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},t.prototype.fe=function(t,e){var n,r,i,a,u,c,h,l=this,f=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(function(e){return e>l.params.maximumSequenceNumbersToCollect?(s(\"LruGarbageCollector\",\"Capping sequence numbers to collect down to the maximum of \"+l.params.maximumSequenceNumbersToCollect+\" from \"+e),r=l.params.maximumSequenceNumbersToCollect):r=e,a=Date.now(),l.nthSequenceNumber(t,r)}).next(function(r){return n=r,u=Date.now(),l.removeTargets(t,n,e)}).next(function(e){return i=e,c=Date.now(),l.removeOrphanedDocuments(t,n)}).next(function(t){return h=Date.now(),o()<=fi.a.DEBUG&&s(\"LruGarbageCollector\",\"LRU Garbage Collection\\n\\tCounted targets in \"+(a-f)+\"ms\\n\\tDetermined least recently used \"+r+\" in \"+(u-a)+\"ms\\n\\tRemoved \"+i+\" targets in \"+(c-u)+\"ms\\n\\tRemoved \"+t+\" documents in \"+(h-c)+\"ms\\nTotal Duration: \"+(h-f)+\"ms\"),Qo.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})})},t}(),gs=function(){function t(t,e){this.db=t,this.garbageCollector=function(t,n){return new ys(t,e)}(this)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.de=function(t){var e=0;return this.le(t,function(){e++}).next(function(){return e})},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,function(t,n){return e(n)})},t.prototype.addReference=function(t,e,n){return Be(t,n)},t.prototype.removeReference=function(t,e,n){return Be(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return Be(t,e)},t.prototype._e=function(t,e){return function(t,e){var n=!1;return Pe(t).Ot(function(r){return Re(t,r,e).next(function(t){return t&&(n=!0),Qo.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,function(s,a){if(a<=e){var u=n._e(t,s).next(function(e){if(!e)return o++,r.getEntry(t,s).next(function(){return r.removeEntry(s),Ve(t).delete([0,he(s.path)])})});i.push(u)}}).next(function(){return Qo.waitFor(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return Be(t,e)},t.prototype.we=function(t,e){var n,r=Ve(t),i=pi.o;return r.$t({index:Po.documentTargetsIndex},function(t,r){var o=t[0];t[1];var s=r.path,a=r.sequenceNumber;0===o?(i!==pi.o&&e(new Ci(de(n)),i),i=a,n=s):i=pi.o}).next(function(){i!==pi.o&&e(new Ci(de(n)),i)})},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}(),vs=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(this.equalsFn(s,t))return a}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){m(this.inner,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];t(s,a)}})},t.prototype.isEmpty=function(){return b(this.inner)},t}(),ms=function(){function t(){this.changes=new vs(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:wi.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:ki.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0===n?this.getFromCache(t,e):Qo.resolve(n.document)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),bs=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return ze(t).put(Ge(e),n)},t.prototype.removeEntry=function(t,e){var n=ze(t),r=Ge(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.me(t,r)})},t.prototype.getEntry=function(t,e){var n=this;return ze(t).get(Ge(e)).next(function(t){return n.ye(e,t)})},t.prototype.ge=function(t,e){var n=this;return ze(t).get(Ge(e)).next(function(t){return{document:n.ye(e,t),size:ke(t)}})},t.prototype.getEntries=function(t,e){var n=this,r=xt();return this.pe(t,e,function(t,e){var i=n.ye(t,e);r=r.insert(t,i)}).next(function(){return r})},t.prototype.Ee=function(t,e){var n=this,r=xt(),i=new oo(Ci.comparator);return this.pe(t,e,function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,ke(e))}).next(function(){return{documents:r,Te:i}})},t.prototype.pe=function(t,e,n){if(e.isEmpty())return Qo.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return ze(t).$t({range:r},function(t,e,r){for(var s=Ci.fromSegments(t);o&&0>Ci.comparator(o,s);)n(o,null),o=i.getNext();o&&o.isEqual(s)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()}).next(function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null})},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=xt(),o=e.path.length+1,s={};if(n.isEqual(wi.min())){var a=e.path.toArray();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.toArray(),c=we(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=Ro.collectionReadTimeIndex}return ze(t).$t(s,function(t,n,s){if(t.length===o){var a=me(r.R,n);e.path.isPrefixOf(a.key.path)?ht(e,a)&&(i=i.insert(a.key,a)):s.done()}}).next(function(){return i})},t.prototype.newChangeBuffer=function(t){return new ws(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return Ke(t).get(xo.key).next(function(t){return l(!!t),t})},t.prototype.me=function(t,e){return Ke(t).put(xo.key,e)},t.prototype.ye=function(t,e){if(e){var n=me(this.R,e);if(!n.isNoDocument()||!n.version.isEqual(wi.min()))return n}return ki.newInvalidDocument(t)},t}(),ws=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new vs(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),r}return Object(hi.c)(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new uo(function(t,e){return p(t.canonicalString(),e.canonicalString())});return this.changes.forEach(function(o,s){var a=e.Ae.get(o);if(s.document.isValidDocument()){var u=be(e.Ie.R,s.document,e.getReadTime(o));i=i.add(o.path.popLast());var c=ke(u);r+=c-a,n.push(e.Ie.addEntry(t,o,u))}else if(r-=a,e.trackRemovals){var h=be(e.Ie.R,ki.newNoDocument(o,wi.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,h))}else n.push(e.Ie.removeEntry(t,o))}),i.forEach(function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))}),n.push(this.Ie.updateMetadata(t,r)),Qo.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next(function(t){return n.Ae.set(e,t.size),t.document})},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next(function(t){var e=t.documents;return t.Te.forEach(function(t,e){n.Ae.set(t,e)}),e})},e}(ms),Es=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;l(n<r&&0<=n&&11>=r);var o=new Ho(\"createOrUpgrade\",e);1>n&&1<=r&&(t.createObjectStore(Ao.store),function(t){t.createObjectStore(Do.store,{keyPath:Do.keyPath}),t.createObjectStore(No.store,{keyPath:No.keyPath,autoIncrement:!0}).createIndex(No.userMutationsIndex,No.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Co.store)}(t),Qe(t),t.createObjectStore(Ro.store));var s=Qo.resolve();return 3>n&&3<=r&&(0!==n&&(function(t){t.deleteObjectStore(Po.store),t.deleteObjectStore(Lo.store),t.deleteObjectStore(Mo.store)}(t),Qe(t)),s=s.next(function(){return t=o.store(Mo.store),e=new Mo(0,0,wi.min().toTimestamp(),0),t.put(Mo.key,e);var t,e})),4>n&&4<=r&&(0!==n&&(s=s.next(function(){return e=t,(n=o).store(No.store).Nt().next(function(t){e.deleteObjectStore(No.store),e.createObjectStore(No.store,{keyPath:No.keyPath,autoIncrement:!0}).createIndex(No.userMutationsIndex,No.userMutationsKeyPath,{unique:!0});var r=n.store(No.store),i=t.map(function(t){return r.put(t)});return Qo.waitFor(i)});var e,n})),s=s.next(function(){t.createObjectStore(Vo.store,{keyPath:Vo.keyPath})})),5>n&&5<=r&&(s=s.next(function(){return i.Re(o)})),6>n&&6<=r&&(s=s.next(function(){return t.createObjectStore(xo.store),i.be(o)})),7>n&&7<=r&&(s=s.next(function(){return i.ve(o)})),8>n&&8<=r&&(s=s.next(function(){return i.Pe(t,o)})),9>n&&9<=r&&(s=s.next(function(){var n;(n=t).objectStoreNames.contains(\"remoteDocumentChanges\")&&n.deleteObjectStore(\"remoteDocumentChanges\"),function(t){var e=t.objectStore(Ro.store);e.createIndex(Ro.readTimeIndex,Ro.readTimeIndexPath,{unique:!1}),e.createIndex(Ro.collectionReadTimeIndex,Ro.collectionReadTimeIndexPath,{unique:!1})}(e)})),10>n&&10<=r&&(s=s.next(function(){return i.Ve(o)})),11>n&&11<=r&&(s=s.next(function(){t.createObjectStore(Uo.store,{keyPath:Uo.keyPath}),t.createObjectStore(qo.store,{keyPath:qo.keyPath})})),s},t.prototype.be=function(t){var e=0;return t.store(Ro.store).$t(function(t,n){e+=ke(n)}).next(function(){var n=new xo(e);return t.store(xo.store).put(xo.key,n)})},t.prototype.Re=function(t){var e=this,n=t.store(Do.store),r=t.store(No.store);return n.Nt().next(function(n){return Qo.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(No.userMutationsIndex,i).next(function(r){return Qo.forEach(r,function(r){l(r.userId===n.userId);var i=Te(e.R,r);return je(t,n.userId,i).next(function(){})})})})})},t.prototype.ve=function(t){var e=t.store(Po.store),n=t.store(Ro.store);return t.store(Mo.store).get(Mo.key).next(function(t){var r=[];return n.$t(function(n){var i=new _i(n),o=[0,he(i)];r.push(e.get(o).next(function(n){return n?Qo.resolve():function(n){return e.put(new Po(0,he(n),t.highestListenSequenceNumber))}(i)}))}).next(function(){return Qo.waitFor(r)})})},t.prototype.Pe=function(t,e){t.createObjectStore(Fo.store,{keyPath:Fo.keyPath});var n=e.store(Fo.store),r=new ss,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:he(i)})}};return e.store(Ro.store).$t({kt:!0},function(t){var e=new _i(t);return i(e.popLast())}).next(function(){return e.store(Co.store).$t({kt:!0},function(t){t[0];var e=t[1];t[2];var n=de(e);return i(n.popLast())})})},t.prototype.Ve=function(t){var e=this,n=t.store(Lo.store);return n.$t(function(t,r){var i=Oe(r),o=Se(e.R,i);return n.put(o)})},t}(),_s=\"Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.\",Is=function(){function t(e,n,r,i,o,s,u,c,h,l){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=s,this.document=u,this.De=h,this.Ce=l,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Fe=null,this.inForeground=!1,this.ke=null,this.$e=null,this.Oe=ci,this.Me=function(){return Promise.resolve()},!t.yt())throw new gi(yi.UNIMPLEMENTED,\"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.\");this.referenceDelegate=new gs(this,i),this.Le=n+\"main\",this.R=new rs(c),this.Be=new Wo(this.Le,11,new Es(this.R)),this.qe=new fs(this.referenceDelegate,this.R),this.Ut=new as,this.Ue=function(t,e){return new bs(t,e)}(this.R,this.Ut),this.Ke=new is,this.window&&this.window.localStorage?this.Qe=this.window.localStorage:(this.Qe=null,!1===l&&a(\"IndexedDbPersistence\",\"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page.\"))}return t.prototype.start=function(){var t=this;return this.je().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new gi(yi.FAILED_PRECONDITION,_s);return t.We(),t.Ge(),t.ze(),t.runTransaction(\"getHighestListenSequenceNumber\",\"readonly\",function(e){return t.qe.getHighestSequenceNumber(e)})}).then(function(e){t.Ne=new pi(e,t.De)}).then(function(){t.xe=!0}).catch(function(e){return t.Be&&t.Be.close(),Promise.reject(e)})},t.prototype.He=function(t){var e=this;return this.Me=function(n){return Object(hi.b)(e,void 0,void 0,function(){return Object(hi.d)(this,function(){return this.started?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt(function(n){return Object(hi.b)(e,void 0,void 0,function(){return Object(hi.d)(this,function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget(function(){return Object(hi.b)(e,void 0,void 0,function(){return Object(hi.d)(this,function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.je=function(){var t=this;return this.runTransaction(\"updateClientMetadataAndTryBecomePrimary\",\"readwrite\",function(e){return We(e).put(new Vo(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.Je(e).next(function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable(function(){return t.Me(!1)}))})}).next(function(){return t.Ye(e)}).next(function(n){return t.isPrimary&&!n?t.Xe(e).next(function(){return!1}):!!n&&t.Ze(e).next(function(){return!0})})}).catch(function(e){if(pe(e))return s(\"IndexedDbPersistence\",\"Failed to extend owner lease: \",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return s(\"IndexedDbPersistence\",\"Releasing owner lease after error during lease refresh\",e),!1}).then(function(e){t.isPrimary!==e&&t.Se.enqueueRetryable(function(){return t.Me(e)}),t.isPrimary=e})},t.prototype.Je=function(t){var e=this;return He(t).get(Ao.key).next(function(t){return Qo.resolve(e.tn(t))})},t.prototype.en=function(t){return We(t).delete(this.clientId)},t.prototype.nn=function(){return Object(hi.b)(this,void 0,void 0,function(){var t,e,n,r,i=this;return Object(hi.d)(this,function(o){switch(o.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction(\"maybeGarbageCollectMultiClientState\",\"readwrite-primary\",function(t){var e=ve(t,Vo.store);return e.Nt().next(function(t){var n=i.rn(t,18e5),r=t.filter(function(t){return-1===n.indexOf(t)});return Qo.forEach(r,function(t){return e.delete(t.clientId)}).next(function(){return r})})}).catch(function(){return[]})]);case 1:if(t=o.sent(),this.Qe)for(e=0,n=t;e<n.length;e++)r=n[e],this.Qe.removeItem(this.on(r.clientId));o.label=2;case 2:return[2]}})})},t.prototype.ze=function(){var t=this;this.$e=this.Se.enqueueAfterDelay(\"client_metadata_refresh\",4e3,function(){return t.je().then(function(){return t.nn()}).then(function(){return t.ze()})})},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?Qo.resolve(!0):He(t).get(Ao.key).next(function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new gi(yi.FAILED_PRECONDITION,_s);return!1}}return e.networkEnabled&&e.inForeground||We(t).Nt().next(function(t){return void 0===e.rn(t,5e3).find(function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1})})}).next(function(t){return e.isPrimary!==t&&s(\"IndexedDbPersistence\",\"Client \"+(t?\"is\":\"is not\")+\" eligible for a primary lease.\"),t})},t.prototype.shutdown=function(){return Object(hi.b)(this,void 0,void 0,function(){var t=this;return Object(hi.d)(this,function(e){switch(e.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction(\"shutdown\",\"readwrite\",[Ao.store,Vo.store],function(e){var n=new Zo(e,pi.o);return t.Xe(n).next(function(){return t.en(n)})})];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}})})},t.prototype.rn=function(t,e){var n=this;return t.filter(function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)})},t.prototype.fn=function(){var t=this;return this.runTransaction(\"getActiveClients\",\"readonly\",function(e){return We(e).Nt().next(function(e){return t.rn(e,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(t.prototype,\"started\",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return hs.Qt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;s(\"IndexedDbPersistence\",\"Starting transaction:\",t);var i,o=\"readonly\"===e?\"readonly\":\"readwrite\";return this.Be.runTransaction(t,o,Bo,function(o){return i=new Zo(o,r.Ne?r.Ne.next():pi.o),\"readwrite-primary\"===e?r.Je(i).next(function(t){return!!t||r.Ye(i)}).next(function(e){if(!e)throw a(\"Failed to obtain primary lease for action '\"+t+\"'.\"),r.isPrimary=!1,r.Se.enqueueRetryable(function(){return r.Me(!1)}),new gi(yi.FAILED_PRECONDITION,Ko);return n(i)}).next(function(t){return r.Ze(i).next(function(){return t})}):r.dn(i).next(function(){return n(i)})}).then(function(t){return i.raiseOnCommittedEvent(),t})},t.prototype.dn=function(t){var e=this;return He(t).get(Ao.key).next(function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new gi(yi.FAILED_PRECONDITION,_s)})},t.prototype.Ze=function(t){var e=new Ao(this.clientId,this.allowTabSynchronization,Date.now());return He(t).put(Ao.key,e)},t.yt=function(){return Wo.yt()},t.prototype.Xe=function(t){var e=this,n=He(t);return n.get(Ao.key).next(function(t){return e.tn(t)?(s(\"IndexedDbPersistence\",\"Releasing primary lease.\"),n.delete(Ao.key)):Qo.resolve()})},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(a(\"Detected an update time that is in the future: \"+t+\" > \"+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&\"function\"==typeof this.document.addEventListener&&(this.ke=function(){t.Se.enqueueAndForget(function(){return t.inForeground=\"visible\"===t.document.visibilityState,t.je()})},this.document.addEventListener(\"visibilitychange\",this.ke),this.inForeground=\"visible\"===this.document.visibilityState)},t.prototype.an=function(){this.ke&&(this.document.removeEventListener(\"visibilitychange\",this.ke),this.ke=null)},t.prototype.Ge=function(){var t,e=this;\"function\"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Fe=function(){e.un(),e.Se.enqueueAndForget(function(){return e.shutdown()})},this.window.addEventListener(\"pagehide\",this.Fe))},t.prototype.hn=function(){this.Fe&&(this.window.removeEventListener(\"pagehide\",this.Fe),this.Fe=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Qe)||void 0===e?void 0:e.getItem(this.on(t)));return s(\"IndexedDbPersistence\",\"Client '\"+t+\"' \"+(n?\"is\":\"is not\")+\" zombied in LocalStorage\"),n}catch(n){return a(\"IndexedDbPersistence\",\"Failed to get zombied client id.\",n),!1}},t.prototype.un=function(){if(this.Qe)try{this.Qe.setItem(this.on(this.clientId),Date.now()+\"\")}catch(t){a(\"Failed to set zombie client id.\",t)}},t.prototype.ln=function(){if(this.Qe)try{this.Qe.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return\"firestore_zombie_\"+this.persistenceKey+\"_\"+t},t}(),Ts=function(t,e){this.progress=t,this.wn=e},Os=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next(function(r){return n.yn(t,e,r)})},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next(function(t){for(var e=0,r=n;e<r.length;e++)r[e].applyToLocalView(t);return t})},t.prototype.gn=function(t,e){t.forEach(function(t,n){for(var r=0,i=e;r<i.length;r++)i[r].applyToLocalView(n)})},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next(function(e){return n.En(t,e).next(function(){return e})})},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next(function(t){return n.gn(e,t)})},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return function(t){return Ci.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Tn(t,e.path):rt(e)?this.In(t,e,n):this.An(t,e,n)},t.prototype.Tn=function(t,e){return this.mn(t,new Ci(e)).next(function(t){var e=Lt();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e})},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=Lt();return this.Ut.getCollectionParents(t,i).next(function(s){return Qo.forEach(s,function(s){var a=function(t,e){return new zi(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.An(t,a,n).next(function(t){t.forEach(function(t,e){o=o.insert(t,e)})})}).next(function(){return o})})},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next(function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)}).next(function(e){return i=e,o.Rn(t,i,r).next(function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key,h=r.get(c);null==h&&(h=ki.newInvalidDocument(c),r=r.insert(c,h)),Ot(u,h,o.localWriteTime),h.isFoundDocument()||(r=r.remove(c))}})}).next(function(){return r.forEach(function(t,n){ht(e,n)||(r=r.remove(t))}),r})},t.prototype.Rn=function(t,e,n){for(var r=Mt(),i=0,o=e;i<o.length;i++)for(var s,a=0,u=o[i].mutations;a<u.length;a++)(s=u[a])instanceof eo&&null===n.get(s.key)&&(r=r.add(s.key));var c=n;return this.Ue.getEntries(t,r).next(function(t){return t.forEach(function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))}),c})},t}(),Ss=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r,i=Mt(),o=Mt(),s=0,a=n.docChanges;s<a.length;s++)switch(r=a[s],r.type){case 0:i=i.add(r.doc.key);break;case 1:o=o.add(r.doc.key)}return new t(e,n.fromCache,i,o)},t}(),As=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(wi.min())?this.Dn(t,e):this.Sn.pn(t,r).next(function(a){var u=i.Cn(e,a);return(Z(e)||tt(e))&&i.Nn(e.limitType,u,r,n)?i.Dn(t,e):(o()<=fi.a.DEBUG&&s(\"QueryEngine\",\"Re-using previous result from %s to execute query: %s\",n.toString(),ct(e)),i.Sn.getDocumentsMatchingQuery(t,e,n).next(function(t){return u.forEach(function(e){t=t.insert(e.key,e)}),t}))})},t.prototype.Cn=function(t,e){var n=new uo(lt(t));return e.forEach(function(e,r){ht(t,r)&&(n=n.add(r))}),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i=\"F\"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.compareTo(r))},t.prototype.Dn=function(t,e){return o()<=fi.a.DEBUG&&s(\"QueryEngine\",\"Using full collection scan to execute query:\",ct(e)),this.Sn.getDocumentsMatchingQuery(t,e,wi.min())},t}(),Ds=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.Fn=new oo(p),this.kn=new vs(function(t){return K(t)},z),this.$n=wi.min(),this._n=t.getMutationQueue(n),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new Os(this.On,this._n,this.persistence.getIndexManager()),this.Ke=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction(\"Collect garbage\",\"readwrite-primary\",function(n){return t.collect(n,e.Fn)})},t}(),Ns=function(){function t(t){this.R=t,this.Qn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return Qo.resolve(this.Qn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Qn.set(e.id,{id:(n=e).id,version:n.version,createTime:Kt(n.createTime)}),Qo.resolve()},t.prototype.getNamedQuery=function(t,e){return Qo.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,{name:(n=e).name,query:Ae(n.bundledQuery),readTime:Kt(n.readTime)}),Qo.resolve();var n},t}(),Cs=function(){function t(){this.Wn=new uo(js.Gn),this.zn=new uo(js.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new js(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach(function(t){return n.addReference(t,e)})},t.prototype.removeReference=function(t,e){this.Yn(new js(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach(function(t){return n.removeReference(t,e)})},t.prototype.Zn=function(t){var e=this,n=new Ci(new _i([])),r=new js(n,t),i=new js(n,t+1),o=[];return this.zn.forEachInRange([r,i],function(t){e.Yn(t),o.push(t.key)}),o},t.prototype.ts=function(){var t=this;this.Wn.forEach(function(e){return t.Yn(e)})},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new Ci(new _i([])),n=new js(e,t),r=new js(e,t+1),i=Mt();return this.zn.forEachInRange([n,r],function(t){i=i.add(t.key)}),i},t.prototype.containsKey=function(t){var e=new js(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),js=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return Ci.comparator(t.key,e.key)||p(t.ns,e.ns)},t.Hn=function(t,e){return p(t.ns,e.ns)||Ci.comparator(t.key,e.key)},t}(),ks=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new uo(js.Gn)}return t.prototype.checkEmpty=function(){return Qo.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++,0<this._n.length&&this._n[this._n.length-1];var o=new ts(i,e,n,r);this._n.push(o);for(var s,a=0,u=r;a<u.length;a++)s=u[a],this.rs=this.rs.add(new js(s.key,i)),this.Ut.addToCollectionParentIndex(t,s.key.path.popLast());return Qo.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return Qo.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this.cs(e+1),r=0>n?0:n;return Qo.resolve(this._n.length>r?this._n[r]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return Qo.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(){return Qo.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new js(e,0),i=new js(e,ui),o=[];return this.rs.forEachInRange([r,i],function(t){var e=n.os(t.ns);o.push(e)}),Qo.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new uo(p);return e.forEach(function(t){var e=new js(t,0),i=new js(t,ui);n.rs.forEachInRange([e,i],function(t){r=r.add(t.ns)})}),Qo.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;Ci.isDocumentKey(i)||(i=i.child(\"\"));var o=new js(new Ci(i),0),s=new uo(p);return this.rs.forEachWhile(function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(s=s.add(t.ns)),!0)},o),Qo.resolve(this.us(s))},t.prototype.us=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.os(t);null!==r&&n.push(r)}),n},t.prototype.removeMutationBatch=function(t,e){var n=this;l(0===this.hs(e.batchId,\"removed\")),this._n.shift();var r=this.rs;return Qo.forEach(e.mutations,function(i){var o=new js(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(function(){n.rs=r})},t.prototype.Gt=function(){},t.prototype.containsKey=function(t,e){var n=new js(e,0),r=this.rs.firstAfterOrEqual(n);return Qo.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(){return this._n.length,Qo.resolve()},t.prototype.hs=function(t){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return 0>e||e>=this._n.length?null:this._n[e]},t}(),Rs=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new oo(Ci.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:s,readTime:n}),this.size+=s-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return Qo.resolve(n?n.document.clone():ki.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=xt();return e.forEach(function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():ki.newInvalidDocument(t))}),Qo.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=xt(),i=new Ci(e.path.child(\"\")),o=this.docs.getIteratorFrom(i);o.hasNext();){var s=o.getNext(),a=s.key,u=s.value,c=u.document,h=u.readTime;if(!e.path.isPrefixOf(a.path))break;0>=h.compareTo(n)||ht(e,c)&&(r=r.insert(c.key,c.clone()))}return Qo.resolve(r)},t.prototype.fs=function(t,e){return Qo.forEach(this.docs,function(t){return e(t)})},t.prototype.newChangeBuffer=function(){return new xs(this)},t.prototype.getSize=function(){return Qo.resolve(this.size)},t}(),xs=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return Object(hi.c)(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach(function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)}),Qo.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},e}(ms),Ls=function(){function t(t){this.persistence=t,this.ds=new vs(function(t){return K(t)},z),this.lastRemoteSnapshotVersion=wi.min(),this.highestTargetId=0,this.ws=0,this._s=new Cs,this.targetCount=0,this.ys=ls.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach(function(t,n){return e(n)}),Qo.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(){return Qo.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(){return Qo.resolve(this.ws)},t.prototype.allocateTargetId=function(){return this.highestTargetId=this.ys.next(),Qo.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),Qo.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new ls(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,Qo.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),Qo.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,Qo.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach(function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.ds.delete(s),o.push(r.removeMatchingKeysForTargetId(t,a.targetId)),i++)}),Qo.waitFor(o).next(function(){return i})},t.prototype.getTargetCount=function(){return Qo.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return Qo.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),Qo.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach(function(e){i.push(r.markPotentiallyOrphaned(t,e))}),Qo.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),Qo.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return Qo.resolve(n)},t.prototype.containsKey=function(t,e){return Qo.resolve(this._s.containsKey(e))},t}(),Ps=function(){function t(t,e){var n,r=this;this.gs={},this.Ne=new pi(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new Ls(this),this.Ut=new os,this.Ue=(n=this.Ut,new Rs(n,function(t){return r.referenceDelegate.ps(t)})),this.R=new rs(e),this.Ke=new Ns(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,\"started\",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new ks(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;s(\"MemoryPersistence\",\"Starting transaction:\",t);var i=new Ms(this.Ne.next());return this.referenceDelegate.Es(),n(i).next(function(t){return r.referenceDelegate.Ts(i).next(function(){return t})}).toPromise().then(function(t){return i.raiseOnCommittedEvent(),t})},t.prototype.Is=function(t,e){return Qo.or(Object.values(this.gs).map(function(n){return function(){return n.containsKey(t,e)}}))},t}(),Ms=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return Object(hi.c)(e,t),e}(zo),Fs=function(){function t(t){this.persistence=t,this.As=new Cs,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,\"vs\",{get:function(){if(this.Rs)return this.Rs;throw h()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),Qo.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),Qo.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),Qo.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach(function(t){return n.vs.add(t.toString())});var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next(function(t){t.forEach(function(t){return n.vs.add(t.toString())})}).next(function(){return r.removeTargetData(t,e)})},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Qo.forEach(this.vs,function(r){var i=Ci.fromPath(r);return e.Ps(t,i).next(function(t){t||n.removeEntry(i)})}).next(function(){return e.Rs=null,n.apply(t)})},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next(function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())})},t.prototype.ps=function(){return 0},t.prototype.Ps=function(t,e){var n=this;return Qo.or([function(){return Qo.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),Vs=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?\"uid:\"+this.uid:\"anonymous-user\"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();Vs.UNAUTHENTICATED=new Vs(null),Vs.GOOGLE_CREDENTIALS=new Vs(\"google-credentials-uid\"),Vs.FIRST_PARTY=new Vs(\"first-party-uid\");var Us=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),s=\"object\"==typeof o&&-1!==[\"pending\",\"acknowledged\",\"rejected\"].indexOf(o.state)&&(void 0===o.error||\"object\"==typeof o.error);return s&&o.error&&(s=\"string\"==typeof o.error.message&&\"string\"==typeof o.error.code)&&(i=new gi(o.error.code,o.error.message)),s?new t(e,n,o.state,i):(a(\"SharedClientState\",\"Failed to parse mutation state for ID '\"+n+\"': \"+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),qs=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o=\"object\"==typeof i&&-1!==[\"not-current\",\"current\",\"rejected\"].indexOf(i.state)&&(void 0===i.error||\"object\"==typeof i.error);return o&&i.error&&(o=\"string\"==typeof i.error.message&&\"string\"==typeof i.error.code)&&(r=new gi(i.error.code,i.error.message)),o?new t(e,i.state,r):(a(\"SharedClientState\",\"Failed to parse target state for ID '\"+e+\"': \"+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Bs=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i=\"object\"==typeof r&&r.activeTargetIds instanceof Array,o=Ft(),s=0;i&&s<r.activeTargetIds.length;++s)i=A(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(a(\"SharedClientState\",\"Failed to parse client data for instance '\"+e+\"': \"+n),null)},t}(),Ks=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return\"object\"==typeof n&&-1!==[\"Unknown\",\"Online\",\"Offline\"].indexOf(n.onlineState)&&\"string\"==typeof n.clientId?new t(n.clientId,n.onlineState):(a(\"SharedClientState\",\"Failed to parse online state: \"+e),null)},t}(),zs=function(){function t(){this.activeTargetIds=Ft()}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Gs=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.Fs.bind(this),this.ks=new oo(p),this.started=!1,this.$s=[];var o=n.replace(/[.*+?^${}()|[\\]\\\\]/g,\"\\\\$&\");this.storage=this.window.localStorage,this.currentUser=i,this.Os=sn(this.persistenceKey,this.Ns),this.Ms=function(t){return\"firestore_sequence_number_\"+t}(this.persistenceKey),this.ks=this.ks.insert(this.Ns,new zs),this.Ls=new RegExp(\"^firestore_clients_\"+o+\"_([^_]*)$\"),this.Bs=new RegExp(\"^firestore_mutations_\"+o+\"_(\\\\d+)(?:_(.*))?$\"),this.qs=new RegExp(\"^firestore_targets_\"+o+\"_(\\\\d+)$\"),this.Us=function(t){return\"firestore_online_state_\"+t}(this.persistenceKey),this.Ks=function(t){return\"firestore_bundle_loaded_\"+t}(this.persistenceKey),this.window.addEventListener(\"storage\",this.xs)}return t.yt=function(t){return t&&t.localStorage},t.prototype.start=function(){return Object(hi.b)(this,void 0,void 0,function(){var t,e,n,r,i,o,s,a,u,c,h,l=this;return Object(hi.d)(this,function(f){switch(f.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(i=this.getItem(sn(this.persistenceKey,r)))&&(o=Bs.Vs(r,i))&&(this.ks=this.ks.insert(o.clientId,o));for(this.Qs(),(s=this.storage.getItem(this.Us))&&(a=this.js(s))&&this.Ws(a),u=0,c=this.$s;u<c.length;u++)h=c[u],this.Fs(h);return this.$s=[],this.window.addEventListener(\"pagehide\",function(){return l.shutdown()}),this.started=!0,[2]}})})},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.ks)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.ks.forEach(function(n,r){r.activeTargetIds.has(t)&&(e=!0)}),e},t.prototype.addPendingMutation=function(t){this.zs(t,\"pending\")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e=\"not-current\";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(un(this.persistenceKey,t));if(n){var r=qs.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Qs(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Qs()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(un(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach(function(t){r.Hs(t)}),this.currentUser=t,n.forEach(function(t){r.addPendingMutation(t)})},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener(\"storage\",this.xs),this.removeItem(this.Os),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return s(\"SharedClientState\",\"READ\",t,e),e},t.prototype.setItem=function(t,e){s(\"SharedClientState\",\"SET\",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){s(\"SharedClientState\",\"REMOVE\",t),this.storage.removeItem(t)},t.prototype.Fs=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(s(\"SharedClientState\",\"EVENT\",n.key,n.newValue),n.key===this.Os)return void a(\"Received WebStorage notification for local change. Another client might have garbage-collected our state\");this.Se.enqueueRetryable(function(){return Object(hi.b)(e,void 0,void 0,function(){var t,e,r,i,o,s;return Object(hi.d)(this,function(){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return t=this.ti(n.key),[2,this.ei(t,null)];if(e=this.ni(n.key,n.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(o=this.js(n.newValue)))return[2,this.Ws(o)]}else if(n.key===this.Ms)(s=function(t){var e=pi.o;if(null!=t)try{var n=JSON.parse(t);l(\"number\"==typeof n),e=n}catch(n){a(\"SharedClientState\",\"Failed to read sequence number from WebStorage\",n)}return e}(n.newValue))!==pi.o&&this.sequenceNumberHandler(s);else if(n.key===this.Ks)return[2,this.syncEngine.ci()]}else this.$s.push(n);return[2]})})})}},Object.defineProperty(t.prototype,\"Js\",{get:function(){return this.ks.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Qs=function(){this.setItem(this.Os,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new Us(this.currentUser,t,e,n),i=an(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=an(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){var e={clientId:this.Ns,onlineState:t};this.storage.setItem(this.Us,JSON.stringify(e))},t.prototype.Ys=function(t,e,n){var r=un(this.persistenceKey,t),i=new qs(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Ks,\"value-not-used\")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return Bs.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=+n[1],i=void 0===n[2]?null:n[2];return Us.Vs(new Vs(i),r,e)},t.prototype.ri=function(t,e){var n=+this.qs.exec(t)[1];return qs.Vs(n,e)},t.prototype.js=function(t){return Ks.Vs(t)},t.prototype.ii=function(t){return Object(hi.b)(this,void 0,void 0,function(){return Object(hi.d)(this,function(){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(t.batchId,t.state,t.error)]:(s(\"SharedClientState\",\"Ignoring mutation for non-active user \"+t.user.uid),[2])})})},t.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.ks.insert(t,e):this.ks.remove(t),i=this.Gs(this.ks),o=this.Gs(r),s=[],a=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||a.push(t)}),this.syncEngine.hi(s,a).then(function(){n.ks=r})},t.prototype.Ws=function(t){this.ks.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=Ft();return t.forEach(function(t,n){e=e.unionWith(n.activeTargetIds)}),e},t}(),Qs=function(){function t(){this.li=new zs,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(){},t.prototype.updateMutationState=function(){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||\"not-current\"},t.prototype.updateQueryState=function(t,e){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new zs,Promise.resolve()},t.prototype.handleUserChange=function(){},t.prototype.setOnlineState=function(){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(){},t.prototype.notifyBundleLoaded=function(){},t}(),Hs=function(){function t(){}return t.prototype.di=function(){},t.prototype.shutdown=function(){},t}(),Ws=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener(\"online\",this.wi),window.removeEventListener(\"offline\",this.mi)},t.prototype.pi=function(){window.addEventListener(\"online\",this.wi),window.addEventListener(\"offline\",this.mi)},t.prototype._i=function(){s(\"ConnectivityMonitor\",\"Network connectivity changed: AVAILABLE\");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){s(\"ConnectivityMonitor\",\"Network connectivity changed: UNAVAILABLE\");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return\"undefined\"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Ys={BatchGetDocuments:\"batchGet\",Commit:\"commit\",RunQuery:\"runQuery\"},Xs=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),$s=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n.useFetchStreams=e.useFetchStreams,n}return Object(hi.c)(e,t),e.prototype.ki=function(t,e,n,r){return new Promise(function(i,o){var a=new di.g;a.listenOnce(di.c.COMPLETE,function(){try{switch(a.getLastErrorCode()){case di.a.NO_ERROR:var e=a.getResponseJson();s(\"Connection\",\"XHR received:\",JSON.stringify(e)),i(e);break;case di.a.TIMEOUT:s(\"Connection\",'RPC \"'+t+'\" timed out'),o(new gi(yi.DEADLINE_EXCEEDED,\"Request time out\"));break;case di.a.HTTP_ERROR:var n=a.getStatus();if(s(\"Connection\",'RPC \"'+t+'\" failed with status:',n,\"response text:\",a.getResponseText()),0<n){var r=a.getResponseJson().error;if(r&&r.status&&r.message){var u=function(t){var e=t.toLowerCase().replace(/_/g,\"-\");return 0<=Object.values(yi).indexOf(e)?e:yi.UNKNOWN}(r.status);o(new gi(u,r.message))}else o(new gi(yi.UNKNOWN,\"Server responded with status \"+a.getStatus()))}else o(new gi(yi.UNAVAILABLE,\"Connection failed.\"));break;default:h()}}finally{s(\"Connection\",'RPC \"'+t+'\" completed.')}});var u=JSON.stringify(r);a.send(e,\"POST\",u,n,15)})},e.prototype.Oi=function(t,e){var n=[this.Di,\"/\",\"google.firestore.v1.Firestore\",\"/\",t,\"/channel\"],r=Object(di.h)(),i=Object(di.i)(),o={httpSessionIdParam:\"gsessionid\",initMessageHeaders:{},messageUrlParams:{database:\"projects/\"+this.databaseId.projectId+\"/databases/\"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new di.d({})),this.Fi(o.initMessageHeaders,e),Object(li.n)()||Object(li.p)()||Object(li.l)()||Object(li.m)()||Object(li.q)()||Object(li.k)()||(o.httpHeadersOverwriteParam=\"$httpHeaders\");var a=n.join(\"\");s(\"Connection\",\"Creating WebChannel: \"+a,o);var c=r.createWebChannel(a,o),h=!1,f=!1,d=new Xs({Ei:function(t){f?s(\"Connection\",\"Not sending because WebChannel is closed:\",t):(h||(s(\"Connection\",\"Opening WebChannel transport.\"),c.open(),h=!0),s(\"Connection\",\"WebChannel sending:\",t),c.send(t))},Ti:function(){return c.close()}}),p=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return p(c,di.f.EventType.OPEN,function(){f||s(\"Connection\",\"WebChannel transport opened.\")}),p(c,di.f.EventType.CLOSE,function(){f||(f=!0,s(\"Connection\",\"WebChannel transport closed\"),d.Vi())}),p(c,di.f.EventType.ERROR,function(t){f||(f=!0,u(\"Connection\",\"WebChannel transport errored:\",t),d.Vi(new gi(yi.UNAVAILABLE,\"The operation could not be completed\")))}),p(c,di.f.EventType.MESSAGE,function(t){var e;if(!f){var n=t.data[0];l(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){s(\"Connection\",\"WebChannel received error:\",i);var o=i.status,a=function(t){var e=Ai[o];if(void 0!==e)return Rt(e)}(),u=i.message;void 0===a&&(a=yi.INTERNAL,u=\"Unknown error status: \"+o+\" with message \"+i.message),f=!0,d.Vi(new gi(a,u)),c.close()}else s(\"Connection\",\"WebChannel received:\",n),d.Si(n)}}),p(i,di.b.STAT_EVENT,function(t){t.stat===di.e.PROXY?s(\"Connection\",\"Detected buffering proxy\"):t.stat===di.e.NOPROXY&&s(\"Connection\",\"Detected no buffering proxy\")}),setTimeout(function(){d.Pi()},0),d},e}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId;var e=t.ssl?\"https\":\"http\";this.Di=e+\"://\"+t.host,this.Ci=\"projects/\"+this.databaseId.projectId+\"/databases/\"+this.databaseId.database+\"/documents\"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);s(\"RestConnection\",\"Sending: \",i,n);var o={};return this.Fi(o,r),this.ki(t,i,o,n).then(function(t){return s(\"RestConnection\",\"Received: \",t),t},function(e){throw u(\"RestConnection\",t+\" failed with error: \",e,\"url: \",i,\"request:\",n),e})},t.prototype.$i=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.Fi=function(t,e){if(t[\"X-Goog-Api-Client\"]=\"gl-js/ fire/8.7.0\",t[\"Content-Type\"]=\"text/plain\",this.databaseInfo.appId&&(t[\"X-Firebase-GMPID\"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){var n=Ys[t];return this.Di+\"/v1/\"+e+\":\"+n},t}()),Js=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Ki=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Qi=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=i(this.qi+this.Wi()),o=r(0,Date.now()-this.Ki),a=r(0,n-o);0<a&&s(\"ExponentialBackoff\",\"Backing off for \"+a+\" ms (base delay: \"+this.qi+\" ms, delay with jitter: \"+n+\" ms, last attempt: \"+o+\" ms ago)\"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,a,function(){return e.Ki=Date.now(),t()}),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),Zs=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new Js(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3===this.state?this.nr():this.auth()},t.prototype.stop=function(){return Object(hi.b)(this,void 0,void 0,function(){return Object(hi.d)(this,function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,function(){return t.rr()}))},t.prototype.cr=function(t){this.ur(),this.stream.send(t)},t.prototype.rr=function(){return Object(hi.b)(this,void 0,void 0,function(){return Object(hi.d)(this,function(){return this.er()?[2,this.close(0)]:[2]})})},t.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return Object(hi.b)(this,void 0,void 0,function(){return Object(hi.d)(this,function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3===t?e&&e.code===yi.RESOURCE_EXHAUSTED?(a(e.toString()),a(\"Using maximum backoff delay to prevent overloading the backend.\"),this.Zi.Qi()):e&&e.code===yi.UNAUTHENTICATED&&this.Ji.invalidateToken():this.Zi.reset(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}})})},t.prototype.ar=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then(function(e){t.Yi===n&&t.lr(e)},function(n){e(function(){var e=new gi(yi.UNKNOWN,\"Fetching auth token failed: \"+n.message);return t.dr(e)})})},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii(function(){n(function(){return e.state=2,e.listener.Ii()})}),this.stream.Ri(function(t){n(function(){return e.dr(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji(function(){return Object(hi.b)(t,void 0,void 0,function(){return Object(hi.d)(this,function(){return this.state=0,this.start(),[2]})})})},t.prototype.dr=function(t){return s(\"PersistentStream\",\"close with error: \"+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget(function(){return e.Yi===t?n():(s(\"PersistentStream\",\"stream callback skipped by getCloseGuardedDispatcher.\"),Promise.resolve())})}},t}(),ta=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,\"listen_stream_connection_backoff\",\"listen_stream_idle\",n,r,o)||this).R=i,s}return Object(hi.c)(e,t),e.prototype.wr=function(t){return this.Hi.Oi(\"Listen\",t)},e.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n;if(\"targetChange\"in e){e.targetChange;var r=function(t){return\"NO_CHANGE\"===t?0:\"ADD\"===t?1:\"REMOVE\"===t?2:\"CURRENT\"===t?3:\"RESET\"===t?4:h()}(e.targetChange.targetChangeType||\"NO_CHANGE\"),i=e.targetChange.targetIds||[],o=function(t,e){return t.I?(l(void 0===e||\"string\"==typeof e),Si.fromBase64String(e||\"\")):(l(void 0===e||e instanceof Uint8Array),Si.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(a=e.targetChange.cause)&&function(t){var e=void 0===t.code?yi.UNKNOWN:Rt(t.code);return new gi(e,t.message||\"\")}(a);n=new wo(r,i,o,s||null)}else if(\"documentChange\"in e){e.documentChange,(r=e.documentChange).document,r.document.name,r.document.updateTime,i=Ht(t,r.document.name),o=Kt(r.document.updateTime);var a=new ji({mapValue:{fields:r.document.fields}}),u=(s=ki.newFoundDocument(i,o,a),r.targetIds||[]),c=r.removedTargetIds||[];n=new mo(u,c,s.key,s)}else if(\"documentDelete\"in e)e.documentDelete,(r=e.documentDelete).document,i=Ht(t,r.document),o=r.readTime?Kt(r.readTime):wi.min(),a=ki.newNoDocument(i,o),s=r.removedTargetIds||[],n=new mo([],s,a.key,a);else if(\"documentRemove\"in e)e.documentRemove,(r=e.documentRemove).document,i=Ht(t,r.document),o=r.removedTargetIds||[],n=new mo([],o,i,null);else{if(!(\"filter\"in e))return h();e.filter;var f=e.filter;f.targetId,r=f.count||0,i=new io(r),o=f.targetId,n=new bo(o,i)}return n}(this.R,t),n=function(t){if(!(\"targetChange\"in t))return wi.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?wi.min():e.readTime?Kt(e.readTime):wi.min()}(t);return this.listener._r(e,n)},e.prototype.mr=function(t){var e={database:Xt(this.R),addTarget:function(t,e){var n,r=e.target;return(n=G(r)?{documents:ne(t,r)}:{query:re(t,r)}).targetId=e.targetId,0<e.resumeToken.approximateByteSize()?n.resumeToken=Bt(t,e.resumeToken):0<e.snapshotVersion.compareTo(wi.min())&&(n.readTime=qt(t,e.snapshotVersion.toTimestamp())),n}(this.R,t)},n=function(t,e){var n=function(t,e){return 0===e?null:1===e?\"existence-filter-mismatch\":2===e?\"limbo-document\":h()}(0,e.purpose);return null==n?null:{\"goog-listen-tags\":n}}(this.R,t);n&&(e.labels=n),this.cr(e)},e.prototype.yr=function(t){var e={};e.database=Xt(this.R),e.removeTarget=t,this.cr(e)},e}(Zs),ea=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,\"write_stream_connection_backoff\",\"write_stream_idle\",n,r,o)||this).R=i,s.gr=!1,s}return Object(hi.c)(e,t),Object.defineProperty(e.prototype,\"pr\",{get:function(){return this.gr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ar=function(){this.gr&&this.Er([])},e.prototype.wr=function(t){return this.Hi.Oi(\"Write\",t)},e.prototype.onMessage=function(t){if(l(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=function(t,e){return t&&0<t.length?(l(void 0!==e),t.map(function(t){return function(t,e){var n=t.updateTime?Kt(t.updateTime):Kt(e);return n.isEqual(wi.min())&&(n=Kt(e)),new $i(n,t.transformResults||[])}(t,e)})):[]}(t.writeResults,t.commitTime),n=Kt(t.commitTime);return this.listener.Tr(n,e)}return l(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},e.prototype.Ar=function(){var t={};t.database=Xt(this.R),this.cr(t)},e.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return te(e.R,t)})};this.cr(n)},e}(Zs),na=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return Object(hi.c)(e,t),e.prototype.br=function(){if(this.Rr)throw new gi(yi.FAILED_PRECONDITION,\"The client has already been terminated.\")},e.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then(function(i){return r.Hi.Ni(t,e,n,i)}).catch(function(t){throw\"FirebaseError\"===t.name?(t.code===yi.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new gi(yi.UNKNOWN,t.toString())})},e.prototype.$i=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then(function(i){return r.Hi.$i(t,e,n,i)}).catch(function(t){throw\"FirebaseError\"===t.name?(t.code===yi.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new gi(yi.UNKNOWN,t.toString())})},e.prototype.terminate=function(){this.Rr=!0},e}(function(){}),ra=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state=\"Unknown\",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr(\"Unknown\"),this.Pr=this.asyncQueue.enqueueAfterDelay(\"online_state_timeout\",1e4,function(){return t.Pr=null,t.Cr(\"Backend didn't respond within 10 seconds.\"),t.Dr(\"Offline\"),Promise.resolve()}))},t.prototype.Nr=function(t){\"Online\"===this.state?this.Dr(\"Unknown\"):(this.vr++,1<=this.vr&&(this.Fr(),this.Cr(\"Connection failed 1 times. Most recent error: \"+t.toString()),this.Dr(\"Offline\")))},t.prototype.set=function(t){this.Fr(),this.vr=0,\"Online\"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e=\"Could not reach Cloud Firestore backend. \"+t+\"\\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.\";this.Vr?(a(e),this.Vr=!1):s(\"OnlineStateTracker\",e)},t.prototype.Fr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),ia=function(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.kr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=i,this.Lr.di(function(){n.enqueueAndForget(function(){return Object(hi.b)(o,void 0,void 0,function(){return Object(hi.d)(this,function(t){switch(t.label){case 0:return wn(this)?(s(\"RemoteStore\",\"Restarting streams for network reachability change.\"),[4,function(t){return Object(hi.b)(this,void 0,void 0,function(){var e;return Object(hi.d)(this,function(n){switch(n.label){case 0:return(e=f(t)).Or.add(4),[4,dn(e)];case 1:return n.sent(),e.Br.set(\"Unknown\"),e.Or.delete(4),[4,fn(e)];case 2:return n.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Br=new ra(n,r)},oa=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Go,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(){})}return t.createAndSchedule=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout(function(){return e.handleDelayElapsed()},t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new gi(yi.CANCELLED,\"Operation cancelled\"+(t?\": \"+t:\"\"))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget(function(){return null===t.timerHandle?Promise.resolve():(t.clearTimeout(),t.op().then(function(e){return t.deferred.resolve(e)}))})},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}(),sa=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||Ci.comparator(e.key,n.key)}:function(t,e){return Ci.comparator(t.key,e.key)},this.keyedMap=Lt(),this.sortedSet=new oo(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,\"size\",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal(function(e){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?\"DocumentSet ()\":\"DocumentSet (\\n  \"+t.join(\"  \\n\")+\"\\n)\"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),aa=function(){function t(){this.Qr=new oo(Ci.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Qr.get(e);n?0!==t.type&&3===n.type?this.Qr=this.Qr.insert(e,t):3===t.type&&1!==n.type?this.Qr=this.Qr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Qr=this.Qr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Qr=this.Qr.remove(e):1===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):h():this.Qr=this.Qr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Qr.inorderTraversal(function(e,n){t.push(n)}),t},t}(),ua=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:0,doc:t})}),new t(e,n,sa.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,\"hasPendingWrites\",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&at(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),ca=function(){this.Wr=void 0,this.listeners=[]},ha=function(){this.queries=new vs(function(t){return ut(t)},at),this.onlineState=\"Unknown\",this.Gr=new Set},la=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState=\"Unknown\",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e,n=[],r=0,i=t.docChanges;r<i.length;r++)3!==(e=i[r]).type&&n.push(e);t=new ua(t.query,t.docs,t.oldDocs,n,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){return!t.fromCache||!(this.options.so&&\"Offline\"!==e||t.docs.isEmpty()&&\"Offline\"!==e)},t.prototype.Zr=function(t){if(0<t.docChanges.length)return!0;var e=this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites;return(t.syncStateChanged||e)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=ua.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),fa=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.io=function(){return\"metadata\"in this.payload},t}(),da=function(){function t(t){this.R=t}return t.prototype.qn=function(t){return Ht(this.R,t)},t.prototype.Un=function(t){return t.metadata.exists?Zt(this.R,t.document,!1):ki.newNoDocument(this.qn(t.metadata.name),this.Kn(t.metadata.readTime))},t.prototype.Kn=function(t){return Kt(t)},t}(),pa=(function(){function t(t,e,n){this.ro=t,this.localStore=e,this.R=n,this.queries=[],this.documents=[],this.progress=function(t){return{taskState:\"Running\",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(t)}t.prototype.oo=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e===this.progress.documentsLoaded?null:(this.progress.documentsLoaded=e,Object.assign({},this.progress))},t.prototype.co=function(t){for(var e,n=new Map,r=new da(this.R),i=0,o=t;i<o.length;i++)if((e=o[i]).metadata.queries)for(var s=r.qn(e.metadata.name),a=0,u=e.metadata.queries;a<u.length;a++){var c=u[a],h=(n.get(c)||Mt()).add(s);n.set(c,h)}return n},t.prototype.complete=function(){return Object(hi.b)(this,void 0,void 0,function(){var t,e,n,r,i;return Object(hi.d)(this,function(o){switch(o.label){case 0:return[4,function(t,e,n,r){return Object(hi.b)(this,void 0,void 0,function(){var i,o,s,a,u,c,h,l,d,p;return Object(hi.d)(this,function(y){switch(y.label){case 0:for(i=f(t),o=Mt(),s=xt(),a=Pt(),u=0,c=n;u<c.length;u++)h=c[u],l=e.qn(h.metadata.name),h.document&&(o=o.add(l)),s=s.insert(l,e.Un(h)),a=a.insert(l,e.Kn(h.metadata.readTime));return d=i.On.newChangeBuffer({trackRemovals:!0}),[4,tn(i,function(t){return ot(J(_i.fromString(\"__bundle__/docs/\"+t)))}(r))];case 1:return p=y.sent(),[2,i.persistence.runTransaction(\"Apply bundle documents\",\"readwrite\",function(t){return Ze(t,d,s,wi.min(),a).next(function(e){return d.apply(t),e}).next(function(e){return i.qe.removeMatchingKeysForTargetId(t,p.targetId).next(function(){return i.qe.addMatchingKeys(t,o,p.targetId)}).next(function(){return i.Mn.En(t,e)}).next(function(){return e})})})]}})})}(this.localStore,new da(this.R),this.documents,this.ro.id)];case 1:t=o.sent(),e=this.co(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?(i=r[n],[4,function(t,e,n){return void 0===n&&(n=Mt()),Object(hi.b)(this,void 0,void 0,function(){var r,i;return Object(hi.d)(this,function(o){switch(o.label){case 0:return[4,tn(t,ot(Ae(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=f(t)).persistence.runTransaction(\"Save named query\",\"readwrite\",function(t){var o=Kt(e.readTime);if(0<=r.snapshotVersion.compareTo(o))return i.Ke.saveNamedQuery(t,e);var s=r.withResumeToken(Si.EMPTY_BYTE_STRING,o);return i.Fn=i.Fn.insert(s.targetId,s),i.qe.updateTargetData(t,s).next(function(){return i.qe.removeMatchingKeysForTargetId(t,r.targetId)}).next(function(){return i.qe.addMatchingKeys(t,n,r.targetId)}).next(function(){return i.Ke.saveNamedQuery(t,e)})})]}})})}(this.localStore,i,e.get(i.name))]):[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState=\"Success\",new Ts(Object.assign({},this.progress),t))]}})})}}(),function(t){this.key=t}),ya=function(t){this.key=t},ga=function(){function t(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=Mt(),this.mutatedKeys=Mt(),this.lo=lt(t),this.fo=new sa(this.lo)}return Object.defineProperty(t.prototype,\"wo\",{get:function(){return this.uo},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new aa,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,s=i,a=!1,u=Z(this.query)&&i.size===this.query.limit?i.last():null,c=tt(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal(function(t,e){var h=i.get(t),l=ht(n.query,e)?e:null,f=!!h&&n.mutatedKeys.has(h.key),d=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations),p=!1;h&&l?h.data.isEqual(l.data)?f!==d&&(r.track({type:3,doc:l}),p=!0):n.yo(h,l)||(r.track({type:2,doc:l}),p=!0,(u&&0<n.lo(l,u)||c&&0>n.lo(l,c))&&(a=!0)):!h&&l?(r.track({type:0,doc:l}),p=!0):h&&!l&&(r.track({type:1,doc:h}),p=!0,(u||c)&&(a=!0)),p&&(l?(s=s.add(l),o=d?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))}),Z(this.query)||tt(this.query))for(;s.size>this.query.limit;){var h=Z(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{fo:s,mo:r,Nn:a,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort(function(t,e){return function(t,e){var n=function(t){return 0===t?1:2===t||3===t?2:1===t?0:h()};return n(t)-n(e)}(t.type,e.type)||r.lo(t.doc,e.doc)}),this.po(n);var s=e?this.Eo():[],a=0===this.ho.size&&this.current?1:0,u=a!==this.ao;return this.ao=a,0!==o.length||u?{snapshot:new ua(this.query,t.fo,i,o,t.mutatedKeys,0==a,u,!1),To:s}:{To:s}},t.prototype.zr=function(t){return this.current&&\"Offline\"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new aa,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach(function(t){return e.uo=e.uo.add(t)}),t.modifiedDocuments.forEach(function(){}),t.removedDocuments.forEach(function(t){return e.uo=e.uo.delete(t)}),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=Mt(),this.fo.forEach(function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))});var n=[];return e.forEach(function(e){t.ho.has(e)||n.push(new ya(e))}),this.ho.forEach(function(t){e.has(t)||n.push(new pa(t))}),n},t.prototype.Ao=function(t){this.uo=t.Bn,this.ho=Mt();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return ua.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},t}(),va=function(t,e,n){this.query=t,this.targetId=e,this.view=n},ma=function(t){this.key=t,this.bo=!1},ba=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new vs(function(t){return ut(t)},at),this.Vo=new Map,this.So=new Set,this.Do=new oo(Ci.comparator),this.Co=new Map,this.No=new Cs,this.xo={},this.Fo=new Map,this.ko=ls.Yt(),this.onlineState=\"Unknown\",this.$o=void 0}return Object.defineProperty(t.prototype,\"isPrimaryClient\",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),t}(),wa=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Object(hi.b)(this,void 0,void 0,function(){return Object(hi.d)(this,function(e){switch(e.label){case 0:return this.R=ln(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Ko(t),[2]}})})},t.prototype.Uo=function(){return null},t.prototype.Ko=function(t){return Xe(this.persistence,new As,t.initialUser,this.R)},t.prototype.qo=function(){return new Ps(Fs.bs,this.R)},t.prototype.Bo=function(){return new Qs},t.prototype.terminate=function(){return Object(hi.b)(this,void 0,void 0,function(){return Object(hi.d)(this,function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}})})},t}(),Ea=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Qo=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(hi.c)(e,t),e.prototype.initialize=function(e){return Object(hi.b)(this,void 0,void 0,function(){return Object(hi.d)(this,function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,function(t){return Object(hi.b)(this,void 0,void 0,function(){var e;return Object(hi.d)(this,function(){return[2,(e=f(t)).persistence.runTransaction(\"Synchronize last document change read time\",\"readonly\",function(t){return e=ze(t),n=wi.min(),e.$t({index:Ro.readTimeIndex,reverse:!0},function(t,e,r){e.readTime&&(n=Ee(e.readTime)),r.done()}).next(function(){return n});var e,n}).then(function(t){e.$n=t})]})})}(this.localStore)];case 2:return n.sent(),[4,this.Qo.initialize(this,e)];case 3:return n.sent(),[4,$n(this.Qo.syncEngine)];case 4:return n.sent(),[4,Tn(this.Qo.remoteStore)];case 5:return n.sent(),[2]}})})},e.prototype.Ko=function(t){return Xe(this.persistence,new As,t.initialUser,this.R)},e.prototype.Uo=function(t){var e=this.persistence.referenceDelegate.garbageCollector;return new ps(e,t.asyncQueue)},e.prototype.qo=function(t){var e=Ye(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0===this.cacheSizeBytes?cs.DEFAULT:cs.withCacheSize(this.cacheSizeBytes);return new Is(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,cn(),hn(),this.R,this.sharedClientState,!!this.forceOwnership)},e.prototype.Bo=function(){return new Qs},e}(wa),_a=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Qo=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(hi.c)(e,t),e.prototype.initialize=function(e){return Object(hi.b)(this,void 0,void 0,function(){var n,r=this;return Object(hi.d)(this,function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Qo.syncEngine,this.sharedClientState instanceof Gs?(this.sharedClientState.syncEngine={ui:function(t,e,n,r){return Object(hi.b)(this,void 0,void 0,function(){var i,o;return Object(hi.d)(this,function(a){switch(a.label){case 0:return[4,function(t,e){var n=f(t),r=f(n._n);return n.persistence.runTransaction(\"Lookup mutation documents\",\"readonly\",function(t){return r.jt(t,e).next(function(e){return e?n.Mn.pn(t,e):Qo.resolve(null)})})}((i=f(t)).localStore,e)];case 1:return null===(o=a.sent())?[3,6]:\"pending\"===n?[4,Tn(i.remoteStore)]:[3,3];case 2:return a.sent(),[3,4];case 3:\"acknowledged\"===n||\"rejected\"===n?(qn(i,e,r||null),Un(i,e),function(t,e){f(f(t)._n).Gt(e)}(i.localStore,e)):h(),a.label=4;case 4:return[4,Hn(i,o)];case 5:return a.sent(),[3,7];case 6:s(\"SyncEngine\",\"Cannot apply mutation batch with id: \"+e),a.label=7;case 7:return[2]}})})}.bind(null,n),ai:function(t,e,n,r){return Object(hi.b)(this,void 0,void 0,function(){var i,o,a;return Object(hi.d)(this,function(u){switch(u.label){case 0:return(i=f(t)).$o?(s(\"SyncEngine\",\"Ignoring unexpected query state notification.\"),[3,8]):[3,1];case 1:return i.Vo.has(e)?\"current\"===n||\"not-current\"===n?[3,2]:\"rejected\"===n?[3,5]:[3,7]:[3,8];case 2:return[4,on(i.localStore)];case 3:return o=u.sent(),a=go.createSynthesizedRemoteEventForCurrentChange(e,\"current\"===n),[4,Hn(i,o,a)];case 4:return u.sent(),[3,8];case 5:return[4,en(i.localStore,e,!0)];case 6:return u.sent(),Bn(i,e,r),[3,8];case 7:h(),u.label=8;case 8:return[2]}})})}.bind(null,n),hi:function(t,e,n){return Object(hi.b)(this,void 0,void 0,function(){var r,i,o,a,u,c,h,l,f,d;return Object(hi.d)(this,function(p){switch(p.label){case 0:if(!(r=Xn(t)).$o)return[3,10];i=0,o=e,p.label=1;case 1:return i<o.length?(a=o[i],r.Vo.has(a)?(s(\"SyncEngine\",\"Adding an already active target \"+a),[3,5]):[4,rn(r.localStore,a)]):[3,6];case 2:return u=p.sent(),[4,tn(r.localStore,u)];case 3:return c=p.sent(),[4,xn(r,Yn(u),c.targetId,!1)];case 4:p.sent(),pn(r.remoteStore,c),p.label=5;case 5:return i++,[3,1];case 6:h=function(t){return Object(hi.d)(this,function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,en(r.localStore,t,!1).then(function(){yn(r.remoteStore,t),Bn(r,t)}).catch(Ue)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})},l=0,f=n,p.label=7;case 7:return l<f.length?(d=f[l],[5,h(d)]):[3,10];case 8:p.sent(),p.label=9;case 9:return l++,[3,7];case 10:return[2]}})})}.bind(null,n),fn:function(t){var e=f(t);return f(f(e.localStore).persistence).fn()}.bind(null,n),ci:function(t){return Object(hi.b)(this,void 0,void 0,function(){var e;return Object(hi.d)(this,function(){return[2,on((e=f(t)).localStore).then(function(t){return Hn(e,t)})]})})}.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He(function(t){return Object(hi.b)(r,void 0,void 0,function(){return Object(hi.d)(this,function(e){switch(e.label){case 0:return[4,function(t,e){return Object(hi.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u,c;return Object(hi.d)(this,function(h){switch(h.label){case 0:return Xn(n=f(t)),$n(n),!0!==e||!0===n.$o?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,Wn(n,r.toArray())]);case 1:return i=h.sent(),n.$o=!0,[4,An(n.remoteStore,!0)];case 2:for(h.sent(),o=0,s=i;o<s.length;o++)a=s[o],pn(n.remoteStore,a);return[3,7];case 3:return!1!==e||!1===n.$o?[3,7]:(u=[],c=Promise.resolve(),n.Vo.forEach(function(t,e){n.sharedClientState.isLocalQueryTarget(e)?u.push(e):c=c.then(function(){return Bn(n,e),en(n.localStore,e,!0)}),yn(n.remoteStore,e)}),[4,c]);case 4:return h.sent(),[4,Wn(n,u)];case 5:return h.sent(),(l=f(n)).Co.forEach(function(t,e){yn(l.remoteStore,e)}),l.No.ts(),l.Co=new Map,l.Do=new oo(Ci.comparator),n.$o=!1,[4,An(n.remoteStore,!1)];case 6:h.sent(),h.label=7;case 7:return[2]}var l})})}(this.Qo.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}})})})];case 4:return i.sent(),[2]}})})},e.prototype.Bo=function(t){var e=cn();if(!Gs.yt(e))throw new gi(yi.UNIMPLEMENTED,\"IndexedDB persistence is only available on platforms that support LocalStorage.\");var n=Ye(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new Gs(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(Ea),Ia=function(){function t(){}return t.prototype.initialize=function(t,e){return Object(hi.b)(this,void 0,void 0,function(){var n=this;return Object(hi.d)(this,function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return Mn(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=function(t,e){return Object(hi.b)(this,void 0,void 0,function(){var n,r;return Object(hi.d)(this,function(i){switch(i.label){case 0:return(n=f(t)).currentUser.isEqual(e)?[3,3]:(s(\"SyncEngine\",\"User change. New user:\",e.toKey()),[4,$e(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t){t.Fo.forEach(function(t){t.forEach(function(t){t.reject(new gi(yi.CANCELLED,\"'waitForPendingWrites' promise is rejected due to a user change.\"))})}),t.Fo.clear()}(n),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,Hn(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}.bind(null,this.syncEngine),[4,An(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}})})},t.prototype.createEventManager=function(){return new ha},t.prototype.createDatastore=function(t){var e,n=ln(t.databaseInfo.databaseId),r=(e=t.databaseInfo,new $s(e));return function(t,e,n){return new na(t,r,n)}(t.credentials,0,n)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,s=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return Mn(s.syncEngine,t,0)},o=Ws.yt()?new Ws:new Hs,new ia(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,s){var a=new ba(t,e,n,r,i,o);return s&&(a.$o=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},t.prototype.terminate=function(){return function(t){return Object(hi.b)(this,void 0,void 0,function(){var e;return Object(hi.d)(this,function(n){switch(n.label){case 0:return e=f(t),s(\"RemoteStore\",\"RemoteStore shutting down.\"),e.Or.add(5),[4,dn(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set(\"Unknown\"),[2]}})})}(this.remoteStore)},t}(),Ta=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error(\"Uncaught Error in snapshot listener:\",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),Oa=(function(){function t(t,e){var n=this;this.Go=t,this.R=e,this.metadata=new Go,this.buffer=new Uint8Array,this.zo=new TextDecoder(\"utf-8\"),this.Ho().then(function(t){t&&t.io()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error(\"The first element of the bundle is not a metadata, it is\\n             \"+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}t.prototype.close=function(){return this.Go.cancel()},t.prototype.getMetadata=function(){return Object(hi.b)(this,void 0,void 0,function(){return Object(hi.d)(this,function(){return[2,this.metadata.promise]})})},t.prototype.Lo=function(){return Object(hi.b)(this,void 0,void 0,function(){return Object(hi.d)(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Ho())]}})})},t.prototype.Ho=function(){return Object(hi.b)(this,void 0,void 0,function(){var t,e,n,r;return Object(hi.d)(this,function(i){switch(i.label){case 0:return[4,this.Jo()];case 1:return null===(t=i.sent())?[2,null]:(e=this.zo.decode(t),n=+e,isNaN(n)&&this.Yo(\"length string (\"+e+\") is not valid number\"),[4,this.Xo(n)]);case 2:return r=i.sent(),[2,new fa(JSON.parse(r),t.length+n)]}})})},t.prototype.Zo=function(){return this.buffer.findIndex(function(t){return 123===t})},t.prototype.Jo=function(){return Object(hi.b)(this,void 0,void 0,function(){var t,e;return Object(hi.d)(this,function(n){switch(n.label){case 0:return 0>this.Zo()?[4,this.tc()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:(0>(t=this.Zo())&&this.Yo(\"Reached the end of bundle when a length string is expected.\"),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}})})},t.prototype.Xo=function(t){return Object(hi.b)(this,void 0,void 0,function(){var e;return Object(hi.d)(this,function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.tc()]:[3,3];case 1:n.sent()&&this.Yo(\"Reached the end of bundle when more is expected.\"),n.label=2;case 2:return[3,0];case 3:return e=this.zo.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}})})},t.prototype.Yo=function(t){throw this.Go.cancel(),new Error(\"Invalid bundle format: \"+t)},t.prototype.tc=function(){return Object(hi.b)(this,void 0,void 0,function(){var t,e;return Object(hi.d)(this,function(n){switch(n.label){case 0:return[4,this.Go.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}})})}}(),function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return Object(hi.b)(this,void 0,void 0,function(){var e,n=this;return Object(hi.d)(this,function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),0<this.mutations.length)throw new gi(yi.INVALID_ARGUMENT,\"Firestore transactions require all reads to be executed before all writes.\");return[4,function(t,e){return Object(hi.b)(this,void 0,void 0,function(){var n,r,i,o,s,a;return Object(hi.d)(this,function(u){switch(u.label){case 0:return n=f(t),r=Xt(n.R)+\"/documents\",i={documents:e.map(function(t){return Qt(n.R,t)})},[4,n.$i(\"BatchGetDocuments\",r,i)];case 1:return o=u.sent(),s=new Map,o.forEach(function(t){var e=function(t,e){return\"found\"in e?function(t,e){l(!!e.found),e.found.name,e.found.updateTime;var n=Ht(t,e.found.name),r=Kt(e.found.updateTime),i=new ji({mapValue:{fields:e.found.fields}});return ki.newFoundDocument(n,r,i)}(t,e):\"missing\"in e?function(t,e){l(!!e.missing),l(!!e.readTime);var n=Ht(t,e.missing),r=Kt(e.readTime);return ki.newNoDocument(n,r)}(t,e):h()}(n.R,t);s.set(e.key.toString(),e)}),a=[],[2,(e.forEach(function(t){var e=s.get(t.toString());l(!!e),a.push(e)}),a)]}})})}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach(function(t){return n.recordVersion(t)}),e)]}})})},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new no(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return Object(hi.b)(this,void 0,void 0,function(){var t,e=this;return Object(hi.d)(this,function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(t,n){var r=Ci.fromPath(n);e.mutations.push(new ro(r,e.precondition(r)))}),[4,function(t,e){return Object(hi.b)(this,void 0,void 0,function(){var n,r,i;return Object(hi.d)(this,function(o){switch(o.label){case 0:return n=f(t),r=Xt(n.R)+\"/documents\",i={writes:e.map(function(t){return te(n.R,t)})},[4,n.Ni(\"Commit\",r,i)];case 1:return o.sent(),[2]}})})}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}})})},t.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw h();e=wi.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new gi(yi.ABORTED,\"Document version changed between two reads.\")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?Ji.updateTime(e):Ji.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(wi.min()))throw new gi(yi.INVALID_ARGUMENT,\"Can't update a document that doesn't exist.\");return Ji.updateTime(e)}return Ji.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}()),Sa=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new Js(this.asyncQueue,\"transaction_retry\")}return t.prototype.run=function(){this.ec-=1,this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji(function(){return Object(hi.b)(t,void 0,void 0,function(){var t,e,n=this;return Object(hi.d)(this,function(){return t=new Oa(this.datastore),(e=this.sc(t))&&e.then(function(e){n.asyncQueue.enqueueAndForget(function(){return t.commit().then(function(){n.deferred.resolve(e)}).catch(function(t){n.ic(t)})})}).catch(function(t){n.ic(t)}),[2]})})})},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!O(e)&&e.catch&&e.then?e:(this.deferred.reject(Error(\"Transaction callback must return a Promise\")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.ic=function(t){var e=this;0<this.ec&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget(function(){return e.nc(),Promise.resolve()})):this.deferred.reject(t)},t.prototype.rc=function(t){if(\"FirebaseError\"===t.name){var e=t.code;return\"aborted\"===e||\"failed-precondition\"===e||!kt(e)}return!1},t}(),Aa=function(){function t(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=Vs.UNAUTHENTICATED,this.clientId=mi.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,function(t){return Object(hi.b)(r,void 0,void 0,function(){return Object(hi.d)(this,function(e){switch(e.label){case 0:return s(\"FirestoreClient\",\"Received user=\",t.uid),[4,this.credentialListener(t)];case 1:return e.sent(),this.user=t,[2]}})})})}return t.prototype.getConfiguration=function(){return Object(hi.b)(this,void 0,void 0,function(){return Object(hi.d)(this,function(){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]})})},t.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new gi(yi.FAILED_PRECONDITION,\"The client has already been terminated.\")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new Go;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(function(){return Object(hi.b)(t,void 0,void 0,function(){var t,n;return Object(hi.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=Cn(t,\"Failed to shutdown persistence\"),e.reject(n),[3,6];case 6:return[2]}})})}),e.promise},t}(),Da=function(t,e,n,r,i,o,s,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=a},Na=function(){function t(t,e){this.projectId=t,this.database=e||\"(default)\"}return Object.defineProperty(t.prototype,\"isDefaultDatabase\",{get:function(){return\"(default)\"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Ca=new Map,ja=function(t,e){this.user=e,this.type=\"OAuth\",this.authHeaders={},this.authHeaders.Authorization=\"Bearer \"+t},ka=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable(function(){return e(Vs.UNAUTHENTICATED)})},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Ra=function(){function t(t){this.token=t,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable(function(){return e(n.token.user)})},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),xa=function(){function t(t){var e=this;this.currentUser=Vs.UNAUTHENTICATED,this.oc=new Go,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){e.cc++,e.currentUser=e.ac(),e.oc.resolve(),e.changeListener&&e.asyncQueue.enqueueRetryable(function(){return e.changeListener(e.currentUser)})};var n=function(t){s(\"FirebaseCredentialsProvider\",\"Auth detected\"),e.auth=t,e.auth.addAuthTokenListener(e.uc)};t.onInit(function(t){return n(t)}),setTimeout(function(){if(!e.auth){var r=t.getImmediate({optional:!0});r?n(r):(s(\"FirebaseCredentialsProvider\",\"Auth not yet detected\"),e.oc.resolve())}},0)}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return t.cc===e?n?(l(\"string\"==typeof n.accessToken),new ja(n.accessToken,t.currentUser)):null:(s(\"FirebaseCredentialsProvider\",\"getToken aborted due to token change.\"),t.getToken())}):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t,e){var n=this;this.asyncQueue=t,this.asyncQueue.enqueueRetryable(function(){return Object(hi.b)(n,void 0,void 0,function(){return Object(hi.d)(this,function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,e(this.currentUser)];case 2:return t.sent(),this.changeListener=e,[2]}})})})},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},t.prototype.ac=function(){var t=this.auth&&this.auth.getUid();return l(null===t||\"string\"==typeof t),new Vs(t)},t}(),La=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n,this.type=\"FirstParty\",this.user=Vs.FIRST_PARTY}return Object.defineProperty(t.prototype,\"authHeaders\",{get:function(){var t={\"X-Goog-AuthUser\":this.lc},e=this.hc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.fc&&(t[\"X-Goog-Iam-Authorization-Token\"]=this.fc),t},enumerable:!1,configurable:!0}),t}(),Pa=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n}return t.prototype.getToken=function(){return Promise.resolve(new La(this.hc,this.lc,this.fc))},t.prototype.setChangeListener=function(t,e){t.enqueueRetryable(function(){return e(Vs.FIRST_PARTY)})},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}(),Ma=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new gi(yi.INVALID_ARGUMENT,\"Can't provide ssl option if host option is not set\");this.host=\"firestore.googleapis.com\",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&1048576>t.cacheSizeBytes)throw new gi(yi.INVALID_ARGUMENT,\"cacheSizeBytes must be at least 1048576\");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,lr(\"experimentalForceLongPolling\",t.experimentalForceLongPolling,\"experimentalAutoDetectLongPolling\",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams},t}(),Fa=function(){function t(t,e){this.type=\"firestore-lite\",this._persistenceKey=\"(lite)\",this._settings=new Ma({}),this._settingsFrozen=!1,t instanceof Na?(this._databaseId=t,this._credentials=new ka):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,[\"projectId\"]))throw new gi(yi.INVALID_ARGUMENT,'\"projectId\" not provided in firebase.initializeApp.');return new Na(t.options.projectId)}(t),this._credentials=new xa(e))}return Object.defineProperty(t.prototype,\"app\",{get:function(){if(!this._app)throw new gi(yi.FAILED_PRECONDITION,\"Firestore was not initialized using the Firebase SDK. 'app' is not available\");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"_initialized\",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"_terminated\",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new gi(yi.FAILED_PRECONDITION,\"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.\");this._settings=new Ma(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new ka;switch(t.type){case\"gapi\":var e=t.client;return l(\"object\"==typeof e&&null!==e&&e.auth&&e.auth.getAuthHeaderValueForFirstParty),new Pa(e,t.sessionIndex||\"0\",t.iamToken||null);case\"provider\":return t.client;default:throw new gi(yi.INVALID_ARGUMENT,\"makeCredentialsProvider failed due to invalid credential type\")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return this,(t=Ca.get(this))&&(s(\"ComponentProvider\",\"Removing Datastore\"),Ca.delete(this),t.terminate()),Promise.resolve();var t},t}(),Va=function(){function t(t,e,n){this.converter=e,this._key=n,this.type=\"document\",this.firestore=t}return Object.defineProperty(t.prototype,\"_path\",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"id\",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"path\",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"parent\",{get:function(){return new qa(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),Ua=function(){function t(t,e,n){this.converter=e,this._query=n,this.type=\"query\",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),qa=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,J(r))||this)._path=r,i.type=\"collection\",i}return Object(hi.c)(e,t),Object.defineProperty(e.prototype,\"id\",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"path\",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"parent\",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new Va(this.firestore,null,new Ci(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}(Ua),Ba=function(){function t(){var t=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=[],this.Zi=new Js(this,\"async_queue_retry\"),this.Tc=function(){var e=hn();e&&s(\"AsyncQueue\",\"Visibility state changed to \"+e.visibilityState),t.Zi.Gi()};var e=hn();e&&\"function\"==typeof e.addEventListener&&e.addEventListener(\"visibilitychange\",this.Tc)}return Object.defineProperty(t.prototype,\"isShuttingDown\",{get:function(){return this._c},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Ic(),this.Ac(t)},t.prototype.enterRestrictedMode=function(){if(!this._c){this._c=!0;var t=hn();t&&\"function\"==typeof t.removeEventListener&&t.removeEventListener(\"visibilitychange\",this.Tc)}},t.prototype.enqueue=function(t){return this.Ic(),this._c?new Promise(function(){}):this.Ac(t)},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget(function(){return e.wc.push(t),e.Rc()})},t.prototype.Rc=function(){return Object(hi.b)(this,void 0,void 0,function(){var t,e=this;return Object(hi.d)(this,function(n){switch(n.label){case 0:if(0===this.wc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return n.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!pe(t=n.sent()))throw t;return s(\"AsyncQueue\",\"Operation failed with retryable error: \"+t),[3,4];case 4:0<this.wc.length&&this.Zi.ji(function(){return e.Rc()}),n.label=5;case 5:return[2]}})})},t.prototype.Ac=function(t){var e=this,n=this.dc.then(function(){return e.gc=!0,t().catch(function(t){throw e.yc=t,e.gc=!1,a(\"INTERNAL UNHANDLED ERROR: \",(r=(n=t).message||\"\",n.stack&&(r=n.stack.includes(n.message)?n.stack:n.message+\"\\n\"+n.stack),r)),t;var n,r}).then(function(t){return e.gc=!1,t})});return this.dc=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Ic(),-1<this.Ec.indexOf(t)&&(e=0);var i=oa.createAndSchedule(this,t,e,n,function(t){return r.bc(t)});return this.mc.push(i),i},t.prototype.Ic=function(){this.yc&&h()},t.prototype.verifyOperationInProgress=function(){},t.prototype.vc=function(){return Object(hi.b)(this,void 0,void 0,function(){var t;return Object(hi.d)(this,function(e){switch(e.label){case 0:return[4,t=this.dc];case 1:e.sent(),e.label=2;case 2:if(t!==this.dc)return[3,0];e.label=3;case 3:return[2]}})})},t.prototype.Pc=function(t){for(var e=0,n=this.mc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Vc=function(t){var e=this;return this.vc().then(function(){e.mc.sort(function(t,e){return t.targetTimeMs-e.targetTimeMs});for(var n,r=0,i=e.mc;r<i.length&&((n=i[r]).skipDelay(),\"all\"===t||n.timerId!==t);r++);return e.vc()})},t.prototype.Sc=function(t){this.Ec.push(t)},t.prototype.bc=function(t){var e=this.mc.indexOf(t);this.mc.splice(e,1)},t}(),Ka=(function(){function t(){this._progressObserver={},this._taskCompletionResolver=new Go,this._lastProgress={taskState:\"Running\",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}t.prototype.onProgress=function(t,e,n){this._progressObserver={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this._taskCompletionResolver.promise.catch(t)},t.prototype.then=function(t,e){return this._taskCompletionResolver.promise.then(t,e)},t.prototype._completeWith=function(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)},t.prototype._failWith=function(t){this._lastProgress.taskState=\"Error\",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)},t.prototype._updateProgress=function(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)}}(),-1),za=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).type=\"firestore\",r._queue=new Ba,r._persistenceKey=\"name\"in e?e.name:\"[DEFAULT]\",r}return Object(hi.c)(e,t),e.prototype._terminate=function(){return this._firestoreClient||Ir(this),this._firestoreClient.terminate()},e}(Fa),Ga=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new gi(yi.INVALID_ARGUMENT,\"Invalid field name at argument $(i + 1). Field names must not be empty.\");this._internalPath=new Ti(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),Qa=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(Si.fromBase64String(e))}catch(e){throw new gi(yi.INVALID_ARGUMENT,\"Failed to construct data from Base64 string: \"+e)}},t.fromUint8Array=function(e){return new t(Si.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return\"Bytes(base64: \"+this.toBase64()+\")\"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),Ha=function(t){this._methodName=t},Wa=function(){function t(t,e){if(!isFinite(t)||-90>t||90<t)throw new gi(yi.INVALID_ARGUMENT,\"Latitude must be a number between -90 and 90, but was: \"+t);if(!isFinite(e)||-180>e||180<e)throw new gi(yi.INVALID_ARGUMENT,\"Longitude must be a number between -180 and 180, but was: \"+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,\"latitude\",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"longitude\",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return p(this._lat,t._lat)||p(this._long,t._long)},t}(),Ya=/^__.*__$/,Xa=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null===this.fieldMask?new to(t,this.data,e,this.fieldTransforms):new eo(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}(),$a=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new eo(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}(),Ja=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Dc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,\"path\",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"Cc\",{get:function(){return this.settings.Cc},enumerable:!1,configurable:!0}),t.prototype.Nc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.xc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Nc({path:n,Fc:!1});return r.kc(t),r},t.prototype.$c=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Nc({path:n,Fc:!1});return r.Dc(),r},t.prototype.Oc=function(){return this.Nc({path:void 0,Fc:!0})},t.prototype.Mc=function(t){return Vr(t,this.settings.methodName,this.settings.Lc||!1,this.path,this.settings.Bc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find(function(e){return t.isPrefixOf(e)})||void 0!==this.fieldTransforms.find(function(e){return t.isPrefixOf(e.field)})},t.prototype.Dc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.kc(this.path.get(t))},t.prototype.kc=function(t){if(0===t.length)throw this.Mc(\"Document fields must not be empty\");if(Sr(this.Cc)&&Ya.test(t))throw this.Mc('Document fields cannot begin and end with \"__\"')},t}(),Za=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||ln(t)}return t.prototype.qc=function(t,e,n,r){return void 0===r&&(r=!1),new Ja({Cc:t,methodName:e,Bc:n,path:Ti.emptyPath(),Fc:!1,Lc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}(),tu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(hi.c)(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.Cc)throw 1===t.Cc?t.Mc(this._methodName+\"() can only appear at the top level of your update data\"):t.Mc(this._methodName+\"() cannot be used with set() unless you pass {merge:true}\");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(Ha),eu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(hi.c)(e,t),e.prototype._toFieldTransform=function(t){return new Xi(t.path,new Qi)},e.prototype.isEqual=function(t){return t instanceof e},e}(Ha),nu=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Uc=n,r}return Object(hi.c)(e,t),e.prototype._toFieldTransform=function(t){var e=Nr(this,t,!0),n=this.Uc.map(function(t){return Rr(t,e)}),r=new Hi(n);return new Xi(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Ha),ru=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Uc=n,r}return Object(hi.c)(e,t),e.prototype._toFieldTransform=function(t){var e=Nr(this,t,!0),n=this.Uc.map(function(t){return Rr(t,e)}),r=new Wi(n);return new Xi(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Ha),iu=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return Object(hi.c)(e,t),e.prototype._toFieldTransform=function(t){var e=new Yi(t.R,yt(t.R,this.Kc));return new Xi(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(Ha),ou=/[~\\*/\\[\\]]/,su=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,\"id\",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"ref\",{get:function(){return new Va(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new au(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(qr(\"DocumentSnapshot.get\",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),au=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(hi.c)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(su),uu=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),cu=function(t){function e(e,n,r,i,o,s){var a=this;return(a=t.call(this,e,n,r,i,s)||this)._firestore=e,a._firestoreImpl=e,a.metadata=o,a}return Object(hi.c)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new hu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(qr(\"DocumentSnapshot.get\",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}(su),hu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(hi.c)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(cu),lu=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new uu(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,\"docs\",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"size\",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"empty\",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach(function(r){t.call(e,new hu(n._firestore,n._userDataWriter,r.key,r,new uu(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))})},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new gi(yi.INVALID_ARGUMENT,\"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().\");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map(function(e){return{type:\"added\",doc:new hu(t._firestore,t._userDataWriter,e.doc.key,e.doc,new uu(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:n++}})}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter(function(t){return e||3!==t.type}).map(function(e){var n=new hu(t._firestore,t._userDataWriter,e.doc.key,e.doc,new uu(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:function(t){return 0===t?\"added\":2===t||3===t?\"modified\":1===t?\"removed\":h()}(e.type),doc:n,oldIndex:i,newIndex:o}})}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}(),fu=function(){},du=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Qc=e,i.jc=n,i.Wc=r,i.type=\"where\",i}return Object(hi.c)(e,t),e.prototype._apply=function(t){var e=Ar(t.firestore),n=function(t,e,n,r,i,o,s){var a;if(i.isKeyField()){if(\"array-contains\"===o||\"array-contains-any\"===o)throw new gi(yi.INVALID_ARGUMENT,\"Invalid Query. You can't perform '\"+o+\"' queries on FieldPath.documentId().\");if(\"in\"===o||\"not-in\"===o){Hr(s,o);for(var u,c=[],h=0,l=s;h<l.length;h++)u=l[h],c.push(Qr(r,t,u));a={arrayValue:{values:c}}}else a=Qr(r,t,s)}else\"in\"!==o&&\"not-in\"!==o&&\"array-contains-any\"!==o||Hr(s,o),a=kr(n,\"where\",s,\"in\"===o||\"not-in\"===o);var f=xi.create(i,o,a);return function(t,e){if(e.g()){var n=nt(t);if(null!==n&&!n.isEqual(e.field))throw new gi(yi.INVALID_ARGUMENT,\"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '\"+n.toString()+\"' and '\"+e.field.toString()+\"'\");var r=et(t);null!==r&&Wr(0,e.field,r)}var i=function(t,e){for(var n,r=0,i=t.filters;r<i.length;r++)if(n=i[r],0<=e.indexOf(n.op))return n.op;return null}(t,function(t){return\"!=\"===t?[\"!=\",\"not-in\"]:\"array-contains\"===t?[\"array-contains\",\"array-contains-any\",\"not-in\"]:\"in\"===t?[\"array-contains-any\",\"in\",\"not-in\"]:\"array-contains-any\"===t?[\"array-contains\",\"array-contains-any\",\"in\",\"not-in\"]:\"not-in\"===t?[\"array-contains\",\"array-contains-any\",\"in\",\"not-in\",\"!=\"]:[]}(e.op));if(null!==i)throw i===e.op?new gi(yi.INVALID_ARGUMENT,\"Invalid query. You cannot use more than one '\"+e.op.toString()+\"' filter.\"):new gi(yi.INVALID_ARGUMENT,\"Invalid query. You cannot use '\"+e.op.toString()+\"' filters with '\"+i.toString()+\"' filters.\")}(t,f),f}(t._query,0,e,t.firestore._databaseId,this.Qc,this.jc,this.Wc);return new Ua(t.firestore,t.converter,function(t,e){var n=t.filters.concat([e]);return new zi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))},e}(fu),pu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Qc=e,r.Gc=n,r.type=\"orderBy\",r}return Object(hi.c)(e,t),e.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new gi(yi.INVALID_ARGUMENT,\"Invalid query. You must not call startAt() or startAfter() before calling orderBy().\");if(null!==t.endAt)throw new gi(yi.INVALID_ARGUMENT,\"Invalid query. You must not call endAt() or endBefore() before calling orderBy().\");var r=new Ki(e,n);return function(t,e){if(null===et(t)){var n=nt(t);null!==n&&Wr(0,n,e.field)}}(t,r),r}(t._query,this.Qc,this.Gc);return new Ua(t.firestore,t.converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new zi(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))},e}(fu),yu=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.zc=n,i.Hc=r,i}return Object(hi.c)(e,t),e.prototype._apply=function(t){return new Ua(t.firestore,t.converter,st(t._query,this.zc,this.Hc))},e}(fu),gu=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return Object(hi.c)(e,t),e.prototype._apply=function(t){var e=Gr(t,this.type,this.Jc,this.Yc);return new Ua(t.firestore,t.converter,function(t,e){return new zi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))},e}(fu),vu=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return Object(hi.c)(e,t),e.prototype._apply=function(t){var e=Gr(t,this.type,this.Jc,this.Yc);return new Ua(t.firestore,t.converter,function(t,e){return new zi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))},e}(fu),mu=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e=\"none\"),D(t)){case 0:return null;case 1:return t.booleanValue;case 2:return E(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(_(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw h()}},t.prototype.convertObject=function(t,e){var n=this,r={};return m(t.fields,function(t,i){r[t]=n.convertValue(i,e)}),r},t.prototype.convertGeoPoint=function(t){return new Wa(E(t.latitude),E(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.convertValue(t,e)})},t.prototype.convertServerTimestamp=function(t,e){switch(e){case\"previous\":var n=function t(e){var n=e.mapValue.fields.__previous_value__;return I(n)?t(n):n}(t);return null==n?null:this.convertValue(n,e);case\"estimate\":return this.convertTimestamp(T(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=w(t);return new bi(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=_i.fromString(t);l(ce(n));var r=new Na(n.get(1),n.get(3)),i=new Ci(n.popFirst(5));return r.isEqual(e)||a(\"Document \"+i+\" contains a document reference within a different database (\"+r.projectId+\"/\"+r.database+\") which is not supported. It will be treated as a reference in the current database (\"+e.projectId+\"/\"+e.database+\") instead.\"),i},t}(),bu=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(hi.c)(e,t),e.prototype.convertBytes=function(t){return new Qa(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Va(this.firestore,null,e)},e}(mu),wu=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=Ar(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=Xr(t,this._firestore),i=Yr(r.converter,e,n),o=Dr(this._dataReader,\"WriteBatch.set\",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,Ji.none())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var o,s=Xr(t,this._firestore);return o=\"string\"==typeof(e=Object(li.h)(e))||e instanceof Ga?jr(this._dataReader,\"WriteBatch.update\",s._key,e,n,r):Cr(this._dataReader,\"WriteBatch.update\",s._key,e),this._mutations.push(o.toMutation(s._key,Ji.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=Xr(t,this._firestore);return this._mutations=this._mutations.concat(new no(e._key,Ji.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,0<this._mutations.length?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new gi(yi.FAILED_PRECONDITION,\"A write batch can no longer be used after commit() has been called.\")},t}(),Eu=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(hi.c)(e,t),e.prototype.convertBytes=function(t){return new Qa(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Va(this.firestore,null,e)},e}(mu),_u=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return Object(hi.c)(e,t),e.prototype.get=function(e){var n=this,r=Xr(e,this._firestore),i=new Eu(this._firestore);return t.prototype.get.call(this,e).then(function(t){return new cu(n._firestore,i,r._key,t._document,new uu(!1,!1),r.converter)})},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=Ar(t)}return t.prototype.get=function(t){var e=this,n=Xr(t,this._firestore),r=new bu(this._firestore);return this._transaction.lookup([n._key]).then(function(t){if(!t||1!==t.length)return h();var i=t[0];if(i.isFoundDocument())return new su(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new su(e._firestore,r,n._key,null,n.converter);throw h()})},t.prototype.set=function(t,e,n){var r=Xr(t,this._firestore),i=Yr(r.converter,e,n),o=Dr(this._dataReader,\"Transaction.set\",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=Xr(t,this._firestore);return o=\"string\"==typeof(e=Object(li.h)(e))||e instanceof Ga?jr(this._dataReader,\"Transaction.update\",s._key,e,n,r):Cr(this._dataReader,\"Transaction.update\",s._key,e),this._transaction.update(s._key,o),this},t.prototype.delete=function(t){var e=Xr(t,this._firestore);return this._transaction.delete(e._key),this},t}()),Iu=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return ni(),new t(Qa.fromBase64String(e))},t.fromUint8Array=function(e){return ei(),new t(Qa.fromUint8Array(e))},t.prototype.toBase64=function(){return ni(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return ei(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return\"Blob(base64: \"+this.toBase64()+\")\"},t}(),Tu=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){Or(t=yr(t,za));var n=_r(t),r=t._freezeSettings(),i=new Ia;return Tr(n,i,new Ea(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){Or(t=yr(t,za));var e=_r(t),n=t._freezeSettings(),r=new Ia;return Tr(e,r,new _a(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new gi(yi.FAILED_PRECONDITION,\"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.\");var n=new Go;return t._queue.enqueueAndForgetEvenWhileRestricted(function(){return Object(hi.b)(e,void 0,void 0,function(){var e;return Object(hi.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Object(hi.b)(this,void 0,void 0,function(){var e;return Object(hi.d)(this,function(n){switch(n.label){case 0:return Wo.yt()?(e=t+\"main\",[4,Wo.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}})})}(Ye(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise}(t._delegate)},t}(),Ou=function(){function t(t,e,n){var r=this;this._delegate=e,this.Xc=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof Na||(this.Zc=t)}return Object.defineProperty(t.prototype,\"_databaseId\",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){var e=this._delegate._getSettings();t.merge||e.host===t.host||u(\"You are overriding the original host. If you did not intend to override your settings, use {merge: true}.\"),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){void 0===r&&(r={});var i=(t=yr(t,Fa))._getSettings();if(\"firestore.googleapis.com\"!==i.host&&i.host!==e&&u(\"Host has been set in both settings() and useEmulator(), emulator host will be used\"),t._setSettings(Object.assign(Object.assign({},i),{host:e+\":\"+n,ssl:!1})),r.mockUserToken){var o=Object(li.d)(r.mockUserToken),s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new gi(yi.INVALID_ARGUMENT,\"mockUserToken must contain 'sub' or 'user_id' field!\");t._credentials=new Ra(new ja(o,new Vs(s)))}}(this._delegate,t,e,n)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue(function(){return Object(hi.b)(e,void 0,void 0,function(){var e,n;return Object(hi.d)(this,function(r){switch(r.label){case 0:return[4,nr(t)];case 1:return e=r.sent(),[4,ir(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),function(t){var e=f(n);return e.Or.delete(0),fn(e)}())]}})})})}(_r(yr(this._delegate,za)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue(function(){return Object(hi.b)(e,void 0,void 0,function(){var e,n;return Object(hi.d)(this,function(r){switch(r.label){case 0:return[4,nr(t)];case 1:return e=r.sent(),[4,ir(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return Object(hi.b)(this,void 0,void 0,function(){var e;return Object(hi.d)(this,function(n){switch(n.label){case 0:return(e=f(t)).Or.add(0),[4,dn(e)];case 1:return n.sent(),e.Br.set(\"Offline\"),[2]}})})}(n))]}})})})}(_r(yr(this._delegate,za)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&lr(\"synchronizeTabs\",e=!!t.synchronizeTabs,\"experimentalForceOwningTab\",n=!!t.experimentalForceOwningTab),e?this.Xc.enableMultiTabIndexedDbPersistence(this):this.Xc.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.Xc.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.Zc&&(this.Zc._removeServiceInstance(\"firestore\"),this.Zc._removeServiceInstance(\"firestore-exp\")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new Go;return t.asyncQueue.enqueueAndForget(function(){return Object(hi.b)(e,void 0,void 0,function(){var e;return Object(hi.d)(this,function(r){switch(r.label){case 0:return e=Vn,[4,or(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}})})}),n.promise}(_r(yr(this._delegate,za)))},t.prototype.onSnapshotsInSync=function(t){return e=this._delegate,n=t,function(t,e){var n=this,r=new Ta(e);return t.asyncQueue.enqueueAndForget(function(){return Object(hi.b)(n,void 0,void 0,function(){var e;return Object(hi.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){f(t).Gr.add(e),e.next()},[4,sr(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})}),function(){r.Wo(),t.asyncQueue.enqueueAndForget(function(){return Object(hi.b)(n,void 0,void 0,function(){var e;return Object(hi.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){f(t).Gr.delete(e)},[4,sr(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})})}}(_r(e=yr(e,za)),Er(n)?n:{next:n});var e,n},Object.defineProperty(t.prototype,\"app\",{get:function(){if(!this.Zc)throw new gi(yi.FAILED_PRECONDITION,\"Firestore was not initialized using the Firebase SDK. 'app' is not available\");return this.Zc},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Pu(this,vr(this._delegate,t))}catch(t){throw ii(t,\"collection()\",\"Firestore.collection()\")}},t.prototype.doc=function(t){try{return new Cu(this,mr(this._delegate,t))}catch(t){throw ii(t,\"doc()\",\"Firestore.doc()\")}},t.prototype.collectionGroup=function(t){try{return new Ru(this,function(t,e){if(t=yr(t,Fa),cr(\"collectionGroup\",\"collection id\",e),0<=e.indexOf(\"/\"))throw new gi(yi.INVALID_ARGUMENT,\"Invalid collection ID '\"+e+\"' passed to function collectionGroup(). Collection IDs must not contain '/'.\");return new Ua(t,null,(n=e,new zi(_i.emptyPath(),n)));var n}(this._delegate,t))}catch(t){throw ii(t,\"collectionGroup()\",\"Firestore.collectionGroup()\")}},t.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new Go;return t.asyncQueue.enqueueAndForget(function(){return Object(hi.b)(n,void 0,void 0,function(){var n;return Object(hi.d)(this,function(i){switch(i.label){case 0:return[4,er(t).then(function(t){return t.datastore})];case 1:return n=i.sent(),new Sa(t.asyncQueue,n,e,r).run(),[2]}})})}),r.promise}(_r(t),function(n){return e(new _u(t,n))})}(this._delegate,function(n){return t(new Au(e,n))})},t.prototype.batch=function(){var t=this;return _r(this._delegate),new Du(new wu(this._delegate,function(e){return Zr(t._delegate,e)}))},t.prototype.loadBundle=function(){throw new gi(yi.FAILED_PRECONDITION,'\"loadBundle()\" does not exist, have you imported \"firebase/firestore/bundle\"?')},t.prototype.namedQuery=function(){throw new gi(yi.FAILED_PRECONDITION,'\"namedQuery()\" does not exist, have you imported \"firebase/firestore/bundle\"?')},t}(),Su=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(hi.c)(e,t),e.prototype.convertBytes=function(t){return new Iu(new Qa(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return Cu.tu(e,this.firestore,null)},e}(mu),Au=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new Su(t)}return t.prototype.get=function(t){var e=this,n=ai(t);return this._delegate.get(n).then(function(t){return new ju(e._firestore,new cu(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))})},t.prototype.set=function(t,e,n){var r=ai(t);return n?(hr(\"Transaction.set\",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=ai(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,Object(hi.f)([s,e,n],i)),this},t.prototype.delete=function(t){var e=ai(t);return this._delegate.delete(e),this},t}(),Du=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=ai(t);return n?(hr(\"WriteBatch.set\",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=ai(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,Object(hi.f)([s,e,n],i)),this},t.prototype.delete=function(t){var e=ai(t);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),Nu=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new hu(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new ku(this._firestore,n),null==e?{}:e)},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.eu=function(e,n){var r=t.nu,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new Su(e),n),i.set(n,o)),o},t}();Nu.nu=new WeakMap;var Cu=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Su(t)}return t.su=function(e,n,r){if(0!=e.length%2)throw new gi(yi.INVALID_ARGUMENT,\"Invalid document reference. Document references must have an even number of segments, but \"+e.canonicalString()+\" has \"+e.length);return new t(n,new Va(n._delegate,r,new Ci(e)))},t.tu=function(e,n,r){return new t(n,new Va(n._delegate,r,e))},Object.defineProperty(t.prototype,\"id\",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"parent\",{get:function(){return new Pu(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"path\",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Pu(this.firestore,vr(this._delegate,t))}catch(t){throw ii(t,\"collection()\",\"DocumentReference.collection()\")}},t.prototype.isEqual=function(t){return(t=Object(li.h)(t))instanceof Va&&br(this._delegate,t)},t.prototype.set=function(t,e){e=hr(\"DocumentReference.set\",e);try{return function(t,e,n){t=yr(t,Va);var r=yr(t.firestore,za),i=Yr(t.converter,e,n);return Zr(r,[Dr(Ar(r),\"setDoc\",t._key,i,null!==t.converter,n).toMutation(t._key,Ji.none())])}(this._delegate,t,e)}catch(t){throw ii(t,\"setDoc()\",\"DocumentReference.set()\")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?$r(this._delegate,t):$r.apply(void 0,Object(hi.f)([this._delegate,t,e],n))}catch(t){throw ii(t,\"updateDoc()\",\"DocumentReference.update()\")}},t.prototype.delete=function(){return Zr(yr((t=this._delegate).firestore,za),[new no(t._key,Ji.none())]);var t},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=oi(e),i=si(e,function(e){return new ju(t.firestore,new cu(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))});return Jr(this._delegate,r,i)},t.prototype.get=function(t){var e=this;return(\"cache\"===(null==t?void 0:t.source)?function(t){t=yr(t,Va);var e=yr(t.firestore,za),n=_r(e),r=new Eu(e);return function(t,e){var n=this,r=new Go;return t.asyncQueue.enqueueAndForget(function(){return Object(hi.b)(n,void 0,void 0,function(){var n;return Object(hi.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(hi.b)(this,void 0,void 0,function(){var r,i;return Object(hi.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(e,n){var r=f(t);return r.persistence.runTransaction(\"read document\",\"readonly\",function(t){return r.Mn.mn(t,n)})}(0,e)];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new gi(yi.UNAVAILABLE,\"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)\")),[3,3];case 2:return r=o.sent(),i=Cn(r,\"Failed to get document '\"+e+\" from cache\"),n.reject(i),[3,3];case 3:return[2]}})})},[4,rr(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t._key).then(function(n){return new cu(e,r,t._key,n,new uu(null!==n&&n.hasLocalMutations,!0),t.converter)})}(this._delegate):\"server\"===(null==t?void 0:t.source)?function(t){t=yr(t,Va);var e=yr(t.firestore,za);return ar(_r(e),t._key,{source:\"server\"}).then(function(n){return ti(e,t,n)})}(this._delegate):function(t){t=yr(t,Va);var e=yr(t.firestore,za);return ar(_r(e),t._key).then(function(n){return ti(e,t,n)})}(this._delegate)).then(function(t){return new ju(e.firestore,new cu(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))})},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Nu.eu(this.firestore,e)):this._delegate.withConverter(null))},t}(),ju=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,\"ref\",{get:function(){return new Cu(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"id\",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"metadata\",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"exists\",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return Br(this._delegate,t._delegate)},t}(),ku=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(hi.c)(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(ju),Ru=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Su(t)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,zr(this._delegate,function(t,e,n){var r=qr(\"where\",t);return new du(r,e,n)}(e,n,r)))}catch(e){throw ii(e,/(orderBy|where)\\(\\)/,\"Query.$1()\")}},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,zr(this._delegate,function(t,e){void 0===e&&(e=\"asc\");var n=e,r=qr(\"orderBy\",t);return new pu(r,n)}(e,n)))}catch(e){throw ii(e,/(orderBy|where)\\(\\)/,\"Query.$1()\")}},t.prototype.limit=function(e){try{return new t(this.firestore,zr(this._delegate,(gr(\"limit\",n=e),new yu(\"limit\",n,\"F\"))))}catch(e){throw ii(e,\"limit()\",\"Query.limit()\")}var n},t.prototype.limitToLast=function(e){try{return new t(this.firestore,zr(this._delegate,(gr(\"limitToLast\",n=e),new yu(\"limitToLast\",n,\"L\"))))}catch(e){throw ii(e,\"limitToLast()\",\"Query.limitToLast()\")}var n},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,zr(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new gu(\"startAt\",t,!0)}.apply(void 0,e)))}catch(e){throw ii(e,\"startAt()\",\"Query.startAt()\")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,zr(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new gu(\"startAfter\",t,!1)}.apply(void 0,e)))}catch(e){throw ii(e,\"startAfter()\",\"Query.startAfter()\")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,zr(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new vu(\"endBefore\",t,!0)}.apply(void 0,e)))}catch(e){throw ii(e,\"endBefore()\",\"Query.endBefore()\")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,zr(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new vu(\"endAt\",t,!1)}.apply(void 0,e)))}catch(e){throw ii(e,\"endAt()\",\"Query.endAt()\")}},t.prototype.isEqual=function(t){return wr(this._delegate,t._delegate)},t.prototype.get=function(t){var e=this;return(\"cache\"===(null==t?void 0:t.source)?function(t){t=yr(t,Ua);var e=yr(t.firestore,za),n=_r(e),r=new Eu(e);return function(t,e){var n=this,r=new Go;return t.asyncQueue.enqueueAndForget(function(){return Object(hi.b)(n,void 0,void 0,function(){var n;return Object(hi.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(hi.b)(this,void 0,void 0,function(){var r,i,o,s,a;return Object(hi.d)(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,nn(t,e,!0)];case 1:return a=u.sent(),r=new ga(e,a.Bn),i=r._o(a.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=u.sent(),a=Cn(s,\"Failed to execute query '\"+e+\" against cache\"),n.reject(a),[3,3];case 3:return[2]}})})},[4,rr(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t._query).then(function(n){return new lu(e,r,t,n)})}(this._delegate):\"server\"===(null==t?void 0:t.source)?function(t){t=yr(t,Ua);var e=yr(t.firestore,za),n=_r(e),r=new Eu(e);return ur(n,t._query,{source:\"server\"}).then(function(n){return new lu(e,r,t,n)})}(this._delegate):function(t){t=yr(t,Ua);var e=yr(t.firestore,za),n=_r(e),r=new Eu(e);return Kr(t._query),ur(n,t._query).then(function(n){return new lu(e,r,t,n)})}(this._delegate)).then(function(t){return new Lu(e.firestore,new lu(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))})},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=oi(e),i=si(e,function(e){return new Lu(t.firestore,new lu(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))});return Jr(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Nu.eu(this.firestore,e)):this._delegate.withConverter(null))},t}(),xu=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,\"type\",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"doc\",{get:function(){return new ku(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"oldIndex\",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"newIndex\",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),Lu=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,\"query\",{get:function(){return new Ru(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"metadata\",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"size\",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"empty\",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"docs\",{get:function(){var t=this;return this._delegate.docs.map(function(e){return new ku(t._firestore,e)})},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map(function(t){return new xu(e._firestore,t)})},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach(function(r){t.call(e,new ku(n._firestore,r))})},t.prototype.isEqual=function(t){return Br(this._delegate,t._delegate)},t}(),Pu=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return Object(hi.c)(e,t),Object.defineProperty(e.prototype,\"id\",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"path\",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"parent\",{get:function(){var t=this._delegate.parent;return t?new Cu(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new Cu(this.firestore,void 0===t?mr(this._delegate):mr(this._delegate,t))}catch(t){throw ii(t,\"doc()\",\"CollectionReference.doc()\")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=yr(t.firestore,za),r=mr(t),i=Yr(t.converter,e);return Zr(n,[Dr(Ar(t.firestore),\"addDoc\",r._key,i,null!==t.converter,{}).toMutation(r._key,Ji.exists(!1))]).then(function(){return r})}(this._delegate,t).then(function(t){return new Cu(e.firestore,t)})},e.prototype.isEqual=function(t){return br(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(Nu.eu(this.firestore,t)):this._delegate.withConverter(null))},e}(Ru),Mu=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(Ga.bind.apply(Ga,Object(hi.f)([void 0],t)))}return t.documentId=function(){return new t(Ti.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=Object(li.h)(t))instanceof Ga&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),Fu=function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new eu(\"serverTimestamp\");return e._methodName=\"FieldValue.serverTimestamp\",new t(e)},t.delete=function(){var e=new tu(\"deleteField\");return e._methodName=\"FieldValue.delete\",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new nu(\"arrayUnion\",t)}.apply(void 0,e);return r._methodName=\"FieldValue.arrayUnion\",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ru(\"arrayRemove\",t)}.apply(void 0,e);return r._methodName=\"FieldValue.arrayRemove\",new t(r)},t.increment=function(e){var n=new iu(\"increment\",e);return n._methodName=\"FieldValue.increment\",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}()}).call(this,n(6))},function(t,e,n){\"use strict\";var r=Math.max,i=Math.round,o=Math.floor;(function(t){function s(t){var e=\"function\"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&\"number\"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?\"Object is not iterable.\":\"Symbol.iterator is not defined.\")}function a(){}function u(t){var e=typeof t;return\"array\"==(e=\"object\"==e?t?Array.isArray(t)?\"array\":e:\"null\":e)||\"object\"==e&&\"number\"==typeof t.length}function c(t){var e=typeof t;return\"object\"==e&&null!=t||\"function\"==e}function h(t){return t.call.apply(t.bind,arguments)}function l(t,e){if(!t)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,n),t.apply(e,r)}}return function(){return t.apply(e,arguments)}}function f(){return(f=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf(\"native code\")?h:l).apply(null,arguments)}function d(t){var e=Array.prototype.slice.call(arguments,1);return function(){var n=e.slice();return n.push.apply(n,arguments),t.apply(this,n)}}function p(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return e.prototype[n].apply(t,r)}}function y(){this.s=this.s,this.o=this.o}function g(){return Array.prototype.concat.apply([],arguments)}function v(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function m(t){return/^[\\s\\xa0]*$/.test(t)}function b(t,e){return-1!=t.indexOf(e)}function w(t,e){return t<e?-1:t>e?1:0}function E(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function _(t){var e={};for(var n in t)e[n]=t[n];return e}function I(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<sn.length;i++)e=sn[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function T(t){return T[\" \"](t),t}function O(){var t=Je.document;return t?t.documentMode:void 0}function S(){return function(t){var e=mn;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}(function(){for(var t=0,e=nn(an+\"\").split(\".\"),n=nn(\"9\").split(\".\"),i=r(e.length,n.length),o=0;0==t&&o<i;o++){var s=e[o]||\"\",a=n[o]||\"\";do{if(s=/(\\d*)(\\D*)(.*)/.exec(s)||[\"\",\"\",\"\",\"\"],a=/(\\d*)(\\D*)(.*)/.exec(a)||[\"\",\"\",\"\",\"\"],0==s[0].length&&0==a[0].length)break;t=w(0==s[1].length?0:parseInt(s[1],10),0==a[1].length?0:parseInt(a[1],10))||w(0==s[2].length,0==a[2].length)||w(s[2],a[2]),s=s[3],a=a[3]}while(0==t)}return 0<=t})}function A(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function D(t,e){if(A.call(this,t?t.type:\"\"),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key=\"\",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType=\"\",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(fn){t:{try{T(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else\"mouseover\"==n?e=t.fromElement:\"mouseout\"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0===r.clientX?r.pageX:r.clientX,this.clientY=void 0===r.clientY?r.pageY:r.clientY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0===t.clientX?t.pageX:t.clientX,this.clientY=void 0===t.clientY?t.pageY:t.clientY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||\"\",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=\"string\"==typeof t.pointerType?t.pointerType:_n[t.pointerType]||\"\",this.state=t.state,this.i=t,t.defaultPrevented&&D.Z.h.call(this)}}function N(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=i,this.key=++Tn,this.ca=this.fa=!1}function C(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function j(t){this.src=t,this.g={},this.h=0}function k(t,e){var n=e.type;if(n in t.g){var r,i=t.g[n],o=tn(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(C(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function R(t,e,n,r){for(var i,o=0;o<t.length;++o)if(!(i=t[o]).ca&&i.listener==e&&i.capture==!!n&&i.ia==r)return o;return-1}function x(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=U(r),e&&e[In]?e.O(n,r,c(i)?!!i.capture:!!i,o):L(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)x(t,e[o],n,r,i);return null}return n=U(n),t&&t[In]?t.N(e,n,c(r)?!!r.capture:!!r,i):L(t,e,n,!1,r,i)}function L(t,e,n,r,i,o){if(!e)throw Error(\"Invalid event type\");var s=c(i)?!!i.capture:!!i,a=V(t);if(a||(t[On]=a=new j(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=F;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)En||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(M(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error(\"addEventListener and attachEvent are unavailable.\");t.addListener(r)}return n}function P(t){if(\"number\"!=typeof t&&t&&!t.ca){var e=t.src;if(e&&e[In])k(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(M(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=V(e))?(k(n,t),0==n.h&&(n.src=null,e[On]=null)):C(t)}}}function M(t){return t in Sn?Sn[t]:Sn[t]=\"on\"+t}function F(t,e){if(t.ca)t=!0;else{e=new D(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&P(t),t=n.call(r,e)}return t}function V(t){return(t=t[On])instanceof j?t:null}function U(t){return\"function\"==typeof t?t:(t[An]||(t[An]=function(e){return t.handleEvent(e)}),t[An])}function q(){y.call(this),this.i=new j(this),this.P=this,this.I=null}function B(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,\"string\"==typeof e)e=new A(e,t);else if(e instanceof A)e.target=e.target||t;else{var i=e;I(e=new A(r,t),i)}if(i=!0,n)for(var o,s=n.length-1;0<=s;s--)i=K(o=e.g=n[s],r,!0,e)&&i;if(i=K(o=e.g=t,r,!0,e)&&i,i=K(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)i=K(o=e.g=n[s],r,!1,e)&&i}function K(t,e,n,r){if(!(e=t.i.g[e+\"\"]))return!0;e=e.concat();for(var i,o=!0,s=0;s<e.length;++s)if((i=e[s])&&!i.ca&&i.capture==n){var a=i.listener,u=i.ia||i.src;i.fa&&k(t.i,i),o=!1!==a.call(u,r)&&o}return o&&!r.defaultPrevented}function z(){var t=xn,e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}function G(t){Je.setTimeout(function(){throw t},0)}function Q(t,e){Dn||function(){var t=Je.Promise.resolve(void 0);Dn=function(){t.then(H)}}(),Rn||(Dn(),Rn=!0),xn.add(t,e)}function H(){for(var t;t=z();){try{t.h.call(t.g)}catch(t){G(t)}var e=jn;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Rn=!1}function W(t,e){q.call(this),this.h=t||1,this.g=e||Je,this.j=f(this.kb,this),this.l=Date.now()}function Y(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function X(t,e,n){if(\"function\"==typeof t)n&&(t=f(t,n));else{if(!t||\"function\"!=typeof t.handleEvent)throw Error(\"Invalid listener argument\");t=f(t.handleEvent,t)}return 2147483647<+e?-1:Je.setTimeout(t,e||0)}function $(t){y.call(this),this.h=t,this.g={}}function J(t,e,n,r){Array.isArray(n)||(n&&(Pn[0]=n.toString()),n=Pn);for(var i,o=0;o<n.length&&(i=x(e,n[o],r||t.handleEvent,!1,t.h||t));o++)t.g[i.key]=i}function Z(t){E(t.g,function(t,e){this.g.hasOwnProperty(e)&&P(t)},t),t.g={}}function tt(){this.g=!0}function et(t,e,n,r){t.info(function(){return\"XMLHTTP TEXT (\"+e+\"): \"+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if(\"noop\"!=o&&\"stop\"!=o&&\"close\"!=o)for(var s=1;s<i.length;s++)i[s]=\"\"}}}return Nn(n)}catch(o){return e}}(t,n)+(r?\" \"+r:\"\")})}function nt(){return Fn=Fn||new q}function rt(t){A.call(this,Mn.Ma,t)}function it(t){var e=nt();B(e,new rt(e,t))}function ot(t,e){A.call(this,Mn.STAT_EVENT,t),this.stat=e}function st(t){var e=nt();B(e,new ot(e,t))}function at(t,e){A.call(this,Mn.Na,t),this.size=e}function ut(t,e){if(\"function\"!=typeof t)throw Error(\"Fn must not be null and must be a function\");return Je.setTimeout(function(){t()},e)}function ct(){}function ht(t){return t.h||(t.h=t.i())}function lt(){}function ft(){A.call(this,\"d\")}function dt(){A.call(this,\"c\")}function pt(){}function yt(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new $(this),this.P=Kn,t=ln?125:void 0,this.W=new W(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new gt}function gt(){this.i=null,this.g=\"\",this.h=!1}function vt(t,e,n){t.K=1,t.v=Vt(Rt(e)),t.s=n,t.U=!0,mt(t,null)}function mt(t,e){t.F=Date.now(),_t(t),t.A=Rt(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[r+\"\"]),Ht(n.h,\"t\",r),t.C=0,n=t.l.H,t.h=new gt,t.g=qe(t.l,n?e:null,!t.s),0<t.O&&(t.L=new Ln(f(t.Ia,t,t.g),t.O)),J(t.V,t.g,\"readystatechange\",t.gb),e=t.H?_(t.H):{},t.s?(t.u||(t.u=\"POST\"),e[\"Content-Type\"]=\"application/x-www-form-urlencoded\",t.g.ea(t.A,t.u,t.s,e)):(t.u=\"GET\",t.g.ea(t.A,t.u,null,e)),it(1),function(t,e,n,r,i,o){t.info(function(){if(t.g)if(o){for(var s,a=\"\",u=o.split(\"&\"),c=0;c<u.length;c++)if(1<(s=u[c].split(\"=\")).length){var h=s[0];s=s[1];var l=h.split(\"_\");a=2<=l.length&&\"type\"==l[1]?a+(h+\"=\")+s+\"&\":a+(h+\"=redacted&\")}}else a=null;else a=o;return\"XMLHTTP REQ (\"+r+\") [attempt \"+i+\"]: \"+e+\"\\n\"+n+\"\\n\"+a})}(t.j,t.u,t.A,t.m,t.X,t.s)}function bt(t){return!!t.g&&\"GET\"==t.u&&2!=t.K&&t.l.Ba}function wt(t,e,n){for(var r,i=!0;!t.I&&t.C<n.length;){if((r=Et(t,n))==Gn){4==e&&(t.o=4,st(14),i=!1),et(t.j,t.m,null,\"[Incomplete Response]\");break}if(r==zn){t.o=4,st(15),et(t.j,t.m,n,\"[Invalid Chunk]\"),i=!1;break}et(t.j,t.m,r,null),At(t,r)}bt(t)&&r!=Gn&&r!=zn&&(t.h.g=\"\",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,st(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info(\"Great, no buffering proxy detected. Bytes received: \"+n.length),Re(e),e.L=!0,st(11))):(et(t.j,t.m,n,\"[Invalid Chunked Response]\"),St(t),Ot(t))}function Et(t,e){var n=t.C,r=e.indexOf(\"\\n\",n);return-1==r?Gn:(n=+e.substring(n,r),isNaN(n)?zn:(r+=1)+n>e.length?Gn:(e=e.substr(r,n),t.C=r+n,e))}function _t(t){t.Y=Date.now()+t.P,It(t,t.P)}function It(t,e){if(null!=t.B)throw Error(\"WatchDog timer not null\");t.B=ut(f(t.eb,t),e)}function Tt(t){t.B&&(Je.clearTimeout(t.B),t.B=null)}function Ot(t){0==t.l.G||t.I||Pe(t.l,t)}function St(t){Tt(t);var e=t.L;e&&\"function\"==typeof e.na&&e.na(),t.L=null,Y(t.W),Z(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function At(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||Jt(n.i,t)))if(n.I=t.N,!t.J&&Jt(n.i,t)&&3==n.G){try{var r=n.Ca.g.parse(e)}catch(o){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;Le(n),Te(n)}ke(n),st(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=ut(f(n.ab,n),6e3));if(1>=$t(n.i)&&n.ka){try{n.ka()}catch(o){}n.ka=void 0}}else Fe(n,11)}else if((t.J||n.g==t)&&Le(n),!m(e))for(i=n.Ca.g.parse(e),e=0;e<i.length;e++){var o=i[e];if(n.U=o[0],o=o[1],2!=n.G)3==n.G&&(\"stop\"==o[0]||\"close\"==o[0]?\"stop\"==o[0]?Fe(n,7):Ie(n):\"noop\"!=o[0]&&n.j&&n.j.wa(o),n.A=0);else if(\"c\"==o[0]){n.J=o[1],n.la=o[2];var s=o[3];null!=s&&(n.ma=s,n.h.info(\"VER=\"+n.ma));var a=o[4];null!=a&&(n.za=a,n.h.info(\"SVER=\"+n.za));var u=o[5];null!=u&&\"number\"==typeof u&&0<u&&(r=1.5*u,n.K=r,n.h.info(\"backChannelRequestTimeoutMs_=\"+r)),r=n;var c=t.g;if(c){var h=c.g?c.g.getResponseHeader(\"X-Client-Wire-Protocol\"):null;if(h){var l=r.i;!l.g&&(b(h,\"spdy\")||b(h,\"quic\")||b(h,\"h2\"))&&(l.j=l.l,l.g=new Set,l.h&&(Zt(l,l.h),l.h=null))}if(r.D){var d=c.g?c.g.getResponseHeader(\"X-HTTP-Session-Id\"):null;d&&(r.sa=d,Ft(r.F,r.D,d))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info(\"Handshake RTT: \"+n.O+\"ms\"));var p=t;if((r=n).oa=Ue(r,r.H?r.la:null,r.W),p.J){te(r.i,p);var y=p,g=r.K;g&&y.setTimeout(g),y.B&&(Tt(y),_t(y)),r.g=p}else je(r);0<n.l.length&&Ae(n)}else\"stop\"!=o[0]&&\"close\"!=o[0]||Fe(n,7)}it(4)}catch(o){}}function Dt(t,e){if(t.forEach&&\"function\"==typeof t.forEach)t.forEach(e,void 0);else if(u(t)||\"string\"==typeof t)en(t,e,void 0);else{if(t.T&&\"function\"==typeof t.T)var n=t.T();else if(t.R&&\"function\"==typeof t.R)n=void 0;else if(u(t)||\"string\"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.R&&\"function\"==typeof t.R)return t.R();if(\"string\"==typeof t)return t.split(\"\");if(u(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Nt(t){this.h={},this.g=[],this.i=0;var e=arguments.length;if(1<e){if(e%2)throw Error(\"Uneven number of arguments\");for(var n=0;n<e;n+=2)this.set(arguments[n],arguments[n+1])}else if(t)if(t instanceof Nt)for(e=t.T(),n=0;n<e.length;n++)this.set(e[n],t.get(e[n]));else for(n in t)this.set(n,t[n])}function Ct(t){if(t.i!=t.g.length){for(var e,n=0,r=0;n<t.g.length;)e=t.g[n],jt(t.h,e)&&(t.g[r++]=e),n++;t.g.length=r}if(t.i!=t.g.length){var i={};for(r=n=0;n<t.g.length;)jt(i,e=t.g[n])||(t.g[r++]=e,i[e]=1),n++;t.g.length=r}}function jt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function kt(t,e){if(this.i=this.s=this.j=\"\",this.m=null,this.o=this.l=\"\",this.g=!1,t instanceof kt){this.g=void 0===e?t.g:e,xt(this,t.j),this.s=t.s,Lt(this,t.i),Pt(this,t.m),this.l=t.l,e=t.h;var n=new Kt;n.i=e.i,e.g&&(n.g=new Nt(e.g),n.h=e.h),Mt(this,n),this.o=t.o}else t&&(n=(t+\"\").match(Qn))?(this.g=!!e,xt(this,n[1]||\"\",!0),this.s=Ut(n[2]||\"\"),Lt(this,n[3]||\"\",!0),Pt(this,n[4]),this.l=Ut(n[5]||\"\",!0),Mt(this,n[6]||\"\",!0),this.o=Ut(n[7]||\"\")):(this.g=!!e,this.h=new Kt(null,this.g))}function Rt(t){return new kt(t)}function xt(t,e,n){t.j=n?Ut(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,\"\"))}function Lt(t,e,n){t.i=n?Ut(e,!0):e}function Pt(t,e){if(e){if(e=+e,isNaN(e)||0>e)throw Error(\"Bad port number \"+e);t.m=e}else t.m=null}function Mt(t,e,n){e instanceof Kt?(t.h=e,function(t,e){e&&!t.j&&(zt(t),t.i=null,t.g.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(Gt(this,e),Ht(this,n,t))},t)),t.j=e}(t.h,t.g)):(n||(e=qt(e,Xn)),t.h=new Kt(e,t.g))}function Ft(t,e,n){t.h.set(e,n)}function Vt(t){return Ft(t,\"zx\",o(2147483648*Math.random()).toString(36)+Math.abs(o(2147483648*Math.random())^Date.now()).toString(36)),t}function Ut(t,e){return t?e?decodeURI(t.replace(/%25/g,\"%2525\")):decodeURIComponent(t):\"\"}function qt(t,e,n){return\"string\"==typeof t?(t=encodeURI(t).replace(e,Bt),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,\"%$1\")),t):null}function Bt(t){return\"%\"+(15&(t=t.charCodeAt(0))>>4).toString(16)+(15&t).toString(16)}function Kt(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function zt(t){t.g||(t.g=new Nt,t.h=0,t.i&&function(t,e){if(t){t=t.split(\"&\");for(var n=0;n<t.length;n++){var r=t[n].indexOf(\"=\"),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\\+/g,\" \")):\"\")}}}(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\\+/g,\" \")),n)}))}function Gt(t,e){zt(t),e=Wt(t,e),jt(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,jt((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&Ct(t)))}function Qt(t,e){return zt(t),e=Wt(t,e),jt(t.g.h,e)}function Ht(t,e,n){Gt(t,e),0<n.length&&(t.i=null,t.g.set(Wt(t,e),v(n)),t.h+=n.length)}function Wt(t,e){return e+=\"\",t.j&&(e=e.toLowerCase()),e}function Yt(t){this.l=t||Zn,Je.PerformanceNavigationTiming?t=0<(t=Je.performance.getEntriesByType(\"navigation\")).length&&(\"hq\"==t[0].nextHopProtocol||\"h2\"==t[0].nextHopProtocol):t=!!(Je.g&&Je.g.Ea&&Je.g.Ea()&&Je.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Xt(t){return!!t.h||!!t.g&&t.g.size>=t.j}function $t(t){return t.h?1:t.g?t.g.size:0}function Jt(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function Zt(t,e){t.g?t.g.add(e):t.h=e}function te(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function ee(t){var e,n;if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){var r=t.i;try{for(var i,o=s(t.g.values()),a=o.next();!a.done;a=o.next())i=a.value,r=r.concat(i.D)}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return r}return v(t.i)}function ne(){}function re(){this.g=new ne}function ie(t,e,n){var r=n||\"\";try{Dt(t,function(t,n){var i=t;c(t)&&(i=Nn(t)),e.push(r+n+\"=\"+encodeURIComponent(i))})}catch(n){throw e.push(r+\"type=\"+encodeURIComponent(\"_badmap\")),n}}function oe(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}function se(t){this.l=t.$b||null,this.j=t.ib||!1}function ae(t,e){q.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=tr,this.status=0,this.responseType=this.responseText=this.response=this.statusText=\"\",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C=\"GET\",this.B=\"\",this.g=!1,this.A=this.j=this.l=null}function ue(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function ce(t){t.readyState=4,t.l=null,t.j=null,t.A=null,he(t)}function he(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function le(t){q.call(this),this.headers=new Nt,this.u=t||null,this.h=!1,this.C=this.g=null,this.H=\"\",this.m=0,this.j=\"\",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=nr,this.K=this.L=!1}function fe(t){return\"content-type\"==t.toLowerCase()}function de(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,pe(t),ge(t)}function pe(t){t.D||(t.D=!0,B(t,\"complete\"),B(t,\"error\"))}function ye(t){if(t.h&&void 0!==$e&&(!t.C[1]||4!=me(t)||2!=t.ba()))if(t.v&&4==me(t))X(t.Fa,0,t);else if(B(t,\"readystatechange\"),4==me(t)){t.h=!1;try{var e,n=t.ba();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=(t.H+\"\").match(Qn)[1]||null;if(!o&&Je.self&&Je.self.location){var s=Je.self.location.protocol;o=s.substr(0,s.length-1)}i=!rr.test(o?o.toLowerCase():\"\")}e=i}if(e)B(t,\"complete\"),B(t,\"success\");else{t.m=6;try{var a=2<me(t)?t.g.statusText:\"\"}catch(t){a=\"\"}t.j=a+\" [\"+t.ba()+\"]\",pe(t)}}finally{ge(t)}}}function ge(t,e){if(t.g){ve(t);var n=t.g,r=t.C[0]?a:null;t.g=null,t.C=null,e||B(t,\"ready\");try{n.onreadystatechange=r}catch(e){}}}function ve(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(Je.clearTimeout(t.A),t.A=null)}function me(t){return t.g?t.g.readyState:0}function be(t){try{if(!t.g)return null;if(\"response\"in t.g)return t.g.response;switch(t.J){case nr:case\"text\":return t.g.responseText;case\"arraybuffer\":if(\"mozResponseArrayBuffer\"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function we(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e=\"\";return E(t,function(t,n){e+=n,e+=\":\",e+=t,e+=\"\\r\\n\"}),e}(n),\"string\"==typeof t?null!=n&&encodeURIComponent(n+\"\"):Ft(t,e,n))}function Ee(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function _e(t){this.za=0,this.l=[],this.h=new tt,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Ee(\"failFast\",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Ee(\"baseRetryDelayMs\",5e3,t),this.$a=Ee(\"retryDelaySeedMs\",1e4,t),this.Ya=Ee(\"forwardChannelMaxRetries\",2,t),this.ra=Ee(\"forwardChannelRequestTimeoutMs\",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J=\"\",this.i=new Yt(t&&t.concurrentRequestLimit),this.Ca=new re,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function Ie(t){if(Oe(t),3==t.G){var e=t.V++,n=Rt(t.F);Ft(n,\"SID\",t.J),Ft(n,\"RID\",e),Ft(n,\"TYPE\",\"terminate\"),Ne(t,n),(e=new yt(t,t.h,e,void 0)).K=2,e.v=Vt(Rt(n)),n=!1,Je.navigator&&Je.navigator.sendBeacon&&(n=Je.navigator.sendBeacon(e.v.toString(),\"\")),!n&&Je.Image&&((new Image).src=e.v,n=!0),n||(e.g=qe(e.l,null),e.g.ea(e.v)),e.F=Date.now(),_t(e)}Ve(t)}function Te(t){t.g&&(Re(t),t.g.cancel(),t.g=null)}function Oe(t){Te(t),t.u&&(Je.clearTimeout(t.u),t.u=null),Le(t),t.i.cancel(),t.m&&(\"number\"==typeof t.m&&Je.clearTimeout(t.m),t.m=null)}function Se(t,e){t.l.push(new Jn(t.Za++,e)),3==t.G&&Ae(t)}function Ae(t){Xt(t.i)||t.m||(t.m=!0,Q(t.Ha,t),t.C=0)}function De(t,e){var n=e?e.m:t.V++,r=Rt(t.F);Ft(r,\"SID\",t.J),Ft(r,\"RID\",n),Ft(r,\"AID\",t.U),Ne(t,r),t.o&&t.s&&we(r,t.o,t.s),n=new yt(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=Ce(t,n,1e3),n.setTimeout(i(.5*t.ra)+i(.5*t.ra*Math.random())),Zt(t.i,n),vt(n,r,e)}function Ne(t,e){t.j&&Dt({},function(t,n){Ft(e,n,t)})}function Ce(t,e,n){n=Math.min(t.l.length,n);var i=t.j?f(t.j.Oa,t.j,t):null;t:for(var o,s=t.l,a=-1;;){o=[\"count=\"+n],-1==a?0<n?(a=s[0].h,o.push(\"ofs=\"+a)):a=0:o.push(\"ofs=\"+a);for(var u=!0,c=0;c<n;c++){var h=s[c].h,l=s[c].g;if(0>(h-=a))a=r(0,s[c].h-100),u=!1;else try{ie(l,o,\"req\"+h+\"_\")}catch(a){i&&i(l)}}if(u){i=o.join(\"&\");break t}}return t=t.l.splice(0,n),e.D=t,i}function je(t){t.g||t.u||(t.Y=1,Q(t.Ga,t),t.A=0)}function ke(t){return!(t.g||t.u||3<=t.A)&&(t.Y++,t.u=ut(f(t.Ga,t),Me(t,t.A)),t.A++,!0)}function Re(t){null!=t.B&&(Je.clearTimeout(t.B),t.B=null)}function xe(t){t.g=new yt(t,t.h,\"rpc\",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=Rt(t.oa);Ft(e,\"RID\",\"rpc\"),Ft(e,\"SID\",t.J),Ft(e,\"CI\",t.N?\"0\":\"1\"),Ft(e,\"AID\",t.U),Ne(t,e),Ft(e,\"TYPE\",\"xmlhttp\"),t.o&&t.s&&we(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=Vt(Rt(e)),n.s=null,n.U=!0,mt(n,t)}function Le(t){null!=t.v&&(Je.clearTimeout(t.v),t.v=null)}function Pe(t,e){var n=null;if(t.g==e){Le(t),Re(t),t.g=null;var r=2}else{if(!Jt(t.i,e))return;n=e.D,te(t.i,e),r=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==r){n=e.s?e.s.length:0,e=Date.now()-e.F;var i=t.C;B(r=nt(),new at(r,n,e,i)),Ae(t)}else je(t);else if(3==(i=e.o)||0==i&&0<t.I||!(1==r&&function(t,e){return!($t(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.l=e.D.concat(t.l),0):1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya)||(t.m=ut(f(t.Ha,t,e),Me(t,t.C)),t.C++,0)))}(t,e)||2==r&&ke(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Fe(t,5);break;case 4:Fe(t,10);break;case 3:Fe(t,6);break;default:Fe(t,2)}}function Me(t,e){var n=t.Pa+o(Math.random()*t.$a);return t.j||(n*=2),n*e}function Fe(t,e){if(t.h.info(\"Error code \"+e),2==e){var n=null;t.j&&(n=null);var r=f(t.jb,t);n||(n=new kt(\"//www.google.com/images/cleardot.gif\"),Je.location&&\"http\"==Je.location.protocol||xt(n,\"https\"),Vt(n)),function(t,e){var n=new tt;if(Je.Image){var r=new Image;r.onload=d(oe,n,r,\"TestLoadImage: loaded\",!0,e),r.onerror=d(oe,n,r,\"TestLoadImage: error\",!1,e),r.onabort=d(oe,n,r,\"TestLoadImage: abort\",!1,e),r.ontimeout=d(oe,n,r,\"TestLoadImage: timeout\",!1,e),Je.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else st(2);t.G=0,t.j&&t.j.va(e),Ve(t),Oe(t)}function Ve(t){t.G=0,t.I=-1,t.j&&((0!=ee(t.i).length||0!=t.l.length)&&(t.i.i.length=0,v(t.l),t.l.length=0),t.j.ua())}function Ue(t,e,n){var r,i=(r=n)instanceof kt?Rt(r):new kt(r,void 0);if(\"\"!=i.i)e&&Lt(i,e+\".\"+i.i),Pt(i,i.m);else{var o=Je.location;i=function(t,e,n,r){var i=new kt(null,void 0);return t&&xt(i,t),e&&Lt(i,e),n&&Pt(i,n),r&&(i.l=r),i}(o.protocol,e?e+\".\"+o.hostname:o.hostname,+o.port,n)}return t.aa&&E(t.aa,function(t,e){Ft(i,e,t)}),e=t.D,n=t.sa,e&&n&&Ft(i,e,n),Ft(i,\"VER\",t.ma),Ne(t,i),i}function qe(t,e,n){if(e&&!t.H)throw Error(\"Can't create secondary domain capable XhrIo object.\");return(e=n&&t.Ba&&!t.qa?new le(new se({ib:!0})):new le(t.qa)).L=t.H,e}function Be(){}function Ke(){if(cn&&!(10<=+wn))throw Error(\"Environmental error: no available transport.\")}function ze(t,e){q.call(this),this.g=new _e(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t[\"X-Client-Protocol\"]=\"webchannel\":t={\"X-Client-Protocol\":\"webchannel\"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t[\"X-WebChannel-Content-Type\"]=e.messageContentType:t={\"X-WebChannel-Content-Type\":e.messageContentType}),e&&e.ya&&(t?t[\"X-WebChannel-Client-Profile\"]=e.ya:t={\"X-WebChannel-Client-Profile\":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!m(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!m(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new He(this)}function Ge(t){ft.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function Qe(){dt.call(this),this.status=1}function He(t){this.g=t}n.d(e,\"a\",function(){return ar}),n.d(e,\"b\",function(){return cr}),n.d(e,\"c\",function(){return ur}),n.d(e,\"d\",function(){return lr}),n.d(e,\"e\",function(){return hr}),n.d(e,\"f\",function(){return fr}),n.d(e,\"g\",function(){return dr}),n.d(e,\"h\",function(){return or}),n.d(e,\"i\",function(){return sr});var We,Ye=function(t,e){return(Ye=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},Xe=\"undefined\"==typeof globalThis?\"undefined\"==typeof window?void 0===t?\"undefined\"==typeof self?{}:self:t:window:globalThis,$e=$e||{},Je=Xe||self;Math.random();y.prototype.s=!1,y.prototype.na=function(){},y.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var Ze,tn=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(\"string\"==typeof t)return\"string\"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},en=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=\"string\"==typeof t?t.split(\"\"):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)},nn=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\\s\\xa0]*([\\s\\S]*?)[\\s\\xa0]*$/.exec(t)[1]};t:{var rn=Je.navigator;if(rn){var on=rn.userAgent;if(on){Ze=on;break t}}Ze=\"\"}var sn=[\"constructor\",\"hasOwnProperty\",\"isPrototypeOf\",\"propertyIsEnumerable\",\"toLocaleString\",\"toString\",\"valueOf\"];T[\" \"]=a;var an,un=b(Ze,\"Opera\"),cn=b(Ze,\"Trident\")||b(Ze,\"MSIE\"),hn=b(Ze,\"Edge\"),ln=hn||cn,fn=b(Ze,\"Gecko\")&&(!b(Ze.toLowerCase(),\"webkit\")||b(Ze,\"Edge\"))&&!(b(Ze,\"Trident\")||b(Ze,\"MSIE\"))&&!b(Ze,\"Edge\"),dn=b(Ze.toLowerCase(),\"webkit\")&&!b(Ze,\"Edge\");t:{var pn=\"\",yn=function(){var t=Ze;return fn?/rv:([^\\);]+)(\\)|;)/.exec(t):hn?/Edge\\/([\\d\\.]+)/.exec(t):cn?/\\b(?:MSIE|rv)[: ]([^\\);]+)(\\)|;)/.exec(t):dn?/WebKit\\/(\\S+)/.exec(t):un?/(?:Version)[ \\/]?(\\S+)/.exec(t):void 0}();if(yn&&(pn=yn?yn[1]:\"\"),cn){var gn=O();if(null!=gn&&gn>parseFloat(pn)){an=gn+\"\";break t}}an=pn}var vn,mn={};if(Je.document&&cn){var bn=O();vn=bn||(parseInt(an,10)||void 0)}else vn=void 0;var wn=vn,En=function(){if(!Je.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},\"passive\",{get:function(){t=!0}});try{Je.addEventListener(\"test\",a,e),Je.removeEventListener(\"test\",a,e)}catch(t){}return t}();A.prototype.h=function(){this.defaultPrevented=!0},p(D,A);var _n={2:\"touch\",3:\"pen\",4:\"mouse\"};D.prototype.h=function(){D.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var In=\"closure_listenable_\"+(0|1e6*Math.random()),Tn=0;j.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.g[o])||(t=this.g[o]=[],this.h++);var s=R(t,e,r,i);return-1<s?(e=t[s],n||(e.fa=!1)):((e=new N(e,this.src,o,!!r,i)).fa=n,t.push(e)),e};var On=\"closure_lm_\"+(0|1e6*Math.random()),Sn={},An=\"__closure_events_fn_\"+(1e9*Math.random()>>>0);p(q,y),q.prototype[In]=!0,q.prototype.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=c(i)?!!i.capture:!!i,r=U(r),e&&e[In]?(e=e.i,(n=(n+\"\").toString())in e.g&&-1<(r=R(s=e.g[n],r,i,o))&&(C(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.g[n],e.h--))):e&&(e=V(e))&&(n=e.g[n.toString()],e=-1,n&&(e=R(n,r,i,o)),(r=-1<e?n[e]:null)&&P(r))}(this,t,e,n,r)},q.prototype.M=function(){if(q.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)C(n[r]);delete e.g[t],e.h--}}this.I=null},q.prototype.N=function(t,e,n,r){return this.i.add(t+\"\",e,!1,n,r)},q.prototype.O=function(t,e,n,r){return this.i.add(t+\"\",e,!0,n,r)};var Dn,Nn=Je.JSON.stringify,Cn=function(){function t(){this.h=this.g=null}return t.prototype.add=function(t,e){var n=jn.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n},t}(),jn=new(function(){function t(t,e){this.i=t,this.j=e,this.h=0,this.g=null}return t.prototype.get=function(){var t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t},t}())(function(){return new kn},function(t){return t.reset()}),kn=function(){function t(){this.next=this.g=this.h=null}return t.prototype.set=function(t,e){this.h=t,this.g=e,this.next=null},t.prototype.reset=function(){this.next=this.g=this.h=null},t}(),Rn=!1,xn=new Cn;p(W,q),(We=W.prototype).da=!1,We.S=null,We.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),B(this,\"tick\"),this.da&&(Y(this),this.start()))}},We.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},We.M=function(){W.Z.M.call(this),Y(this),delete this.g};var Ln=function(t){function e(e,n){var r=t.call(this)||this;return r.m=e,r.j=n,r.h=null,r.i=!1,r.g=null,r}return function(t,e){function n(){this.constructor=t}if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Class extends value \"+e+\" is not a constructor or null\");Ye(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.l=function(){this.h=arguments,this.g?this.i=!0:function t(e){e.g=X(function(){e.g=null,e.i&&(e.i=!1,t(e))},e.j);var n=e.h;e.h=null,e.m.apply(null,n)}(this)},e.prototype.M=function(){t.prototype.M.call(this),this.g&&(Je.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},e}(y);p($,y);var Pn=[];$.prototype.M=function(){$.Z.M.call(this),Z(this)},$.prototype.handleEvent=function(){throw Error(\"EventHandler.handleEvent not implemented\")},tt.prototype.Aa=function(){this.g=!1},tt.prototype.info=function(){};var Mn={},Fn=null;Mn.Ma=\"serverreachability\",p(rt,A),Mn.STAT_EVENT=\"statevent\",p(ot,A),Mn.Na=\"timingevent\",p(at,A);var Vn={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Un={qb:\"complete\",Mb:\"success\",Ka:\"error\",Ja:\"abort\",Eb:\"ready\",Fb:\"readystatechange\",TIMEOUT:\"timeout\",Ab:\"incrementaldata\",Db:\"progress\",tb:\"downloadprogress\",Ub:\"uploadprogress\"};ct.prototype.h=null;var qn,Bn={OPEN:\"a\",pb:\"b\",Ka:\"c\",Bb:\"d\"};p(ft,A),p(dt,A),p(pt,ct),pt.prototype.g=function(){return new XMLHttpRequest},pt.prototype.i=function(){return{}},qn=new pt;var Kn=45e3,zn={},Gn={};(We=yt.prototype).setTimeout=function(t){this.P=t},We.gb=function(t){t=t.target;var e=this.L;e&&3==me(t)?e.l():this.Ia(t)},We.Ia=function(t){try{if(t==this.g)t:{var e=me(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>e)&&(3!=e||ln||this.g&&(this.h.h||this.g.ga()||be(this.g)))){this.I||4!=e||7==n||it(8==n||0>=r?3:2),Tt(this);var i=this.g.ba();this.N=i;e:if(bt(this)){var o=be(this.g);t=\"\";var s=o.length,a=4==me(this.g);if(!this.h.i){if(\"undefined\"==typeof TextDecoder){St(this),Ot(this);var u=\"\";break e}this.h.i=new Je.TextDecoder}for(n=0;n<s;n++)this.h.h=!0,t+=this.h.i.decode(o[n],{stream:a&&n==s-1});o.splice(0,s),this.h.g+=t,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(t,e,n,r,i,o,s){t.info(function(){return\"XMLHTTP RESP (\"+r+\") [ attempt \"+i+\"]: \"+e+\"\\n\"+n+\"\\n\"+o+\" \"+s})}(this.j,this.u,this.A,this.m,this.X,e,i),this.i){if(this.$&&!this.J){e:{if(this.g){var c,h=this.g;if((c=h.g?h.g.getResponseHeader(\"X-HTTP-Initial-Response\"):null)&&!m(c)){var l=c;break e}}l=null}if(!(i=l)){this.i=!1,this.o=3,st(12),St(this),Ot(this);break t}et(this.j,this.m,i,\"Initial handshake response via X-HTTP-Initial-Response\"),this.J=!0,At(this,i)}this.U?(wt(this,e,u),ln&&this.i&&3==e&&(J(this.V,this.W,\"tick\",this.fb),this.W.start())):(et(this.j,this.m,u,null),At(this,u)),4==e&&St(this),this.i&&!this.I&&(4==e?Pe(this.l,this):(this.i=!1,_t(this)))}else 400==i&&0<u.indexOf(\"Unknown SID\")?(this.o=3,st(12)):(this.o=0,st(13)),St(this),Ot(this)}}}catch(a){}},We.fb=function(){if(this.g){var t=me(this.g),e=this.g.ga();this.C<e.length&&(Tt(this),wt(this,t,e),this.i&&4!=t&&_t(this))}},We.cancel=function(){this.I=!0,St(this)},We.eb=function(){this.B=null;var t=Date.now();0<=t-this.Y?(function(t,e){t.info(function(){return\"TIMEOUT: \"+e})}(this.j,this.A),2!=this.K&&(it(3),st(17)),St(this),this.o=2,Ot(this)):It(this,this.Y-t)},(We=Nt.prototype).R=function(){Ct(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},We.T=function(){return Ct(this),this.g.concat()},We.get=function(t,e){return jt(this.h,t)?this.h[t]:e},We.set=function(t,e){jt(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},We.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Qn=/^(?:([^:/?#.]+):)?(?:\\/\\/(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$/;kt.prototype.toString=function(){var t=[],e=this.j;e&&t.push(qt(e,Hn,!0),\":\");var n=this.i;return(n||\"file\"==e)&&(t.push(\"//\"),(e=this.s)&&t.push(qt(e,Hn,!0),\"@\"),t.push(encodeURIComponent(n+\"\").replace(/%25([0-9a-fA-F]{2})/g,\"%$1\")),null!=(n=this.m)&&t.push(\":\",n+\"\")),(n=this.l)&&(this.i&&\"/\"!=n.charAt(0)&&t.push(\"/\"),t.push(qt(n,\"/\"==n.charAt(0)?Yn:Wn,!0))),(n=this.h.toString())&&t.push(\"?\",n),(n=this.o)&&t.push(\"#\",qt(n,$n)),t.join(\"\")};var Hn=/[#\\/\\?@]/g,Wn=/[#\\?:]/g,Yn=/[#\\?]/g,Xn=/[#\\?@]/g,$n=/#/g;(We=Kt.prototype).add=function(t,e){zt(this),this.i=null,t=Wt(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},We.forEach=function(t,e){zt(this),this.g.forEach(function(n,r){en(n,function(n){t.call(e,n,r,this)},this)},this)},We.T=function(){zt(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},We.R=function(t){zt(this);var e=[];if(\"string\"==typeof t)Qt(this,t)&&(e=g(e,this.g.get(Wt(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=g(e,t[n])}return e},We.set=function(t,e){return zt(this),this.i=null,Qt(this,t=Wt(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},We.get=function(t,e){return t?0<(t=this.R(t)).length?t[0]+\"\":e:e},We.toString=function(){if(this.i)return this.i;if(!this.g)return\"\";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(r+\"\");r=this.R(r);for(var o,s=0;s<r.length;s++)o=i,\"\"!==r[s]&&(o+=\"=\"+encodeURIComponent(r[s]+\"\")),t.push(o)}return this.i=t.join(\"&\")};var Jn=function(t,e){this.h=t,this.g=e},Zn=10;Yt.prototype.cancel=function(){var t,e;if(this.i=ee(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){try{for(var n=s(this.g.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.g.clear()}},ne.prototype.stringify=function(t){return Je.JSON.stringify(t,void 0)},ne.prototype.parse=function(t){return Je.JSON.parse(t,void 0)},p(se,ct),se.prototype.g=function(){return new ae(this.l,this.j)},se.prototype.i=function(t){return function(){return t}}({}),p(ae,q);var tr=0;(We=ae.prototype).open=function(t,e){if(this.readyState!=tr)throw this.abort(),Error(\"Error reopening a connection\");this.C=t,this.B=e,this.readyState=1,he(this)},We.send=function(t){if(1!=this.readyState)throw this.abort(),Error(\"need to call open() first. \");this.g=!0;var e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||Je).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},We.abort=function(){this.response=this.responseText=\"\",this.v=new Headers,this.status=0,this.j&&this.j.cancel(\"Request was aborted.\"),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,ce(this)),this.readyState=tr},We.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,he(this)),this.g&&(this.readyState=3,he(this),this.g)))if(\"arraybuffer\"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==Je.ReadableStream&&\"body\"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for \"streamBinaryChunks\" mode responses.');this.response=[]}else this.response=this.responseText=\"\",this.A=new TextDecoder;ue(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},We.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?ce(this):he(this),3==this.readyState&&ue(this)}},We.Ua=function(t){this.g&&(this.response=this.responseText=t,ce(this))},We.Ta=function(t){this.g&&(this.response=t,ce(this))},We.ha=function(){this.g&&ce(this)},We.setRequestHeader=function(t,e){this.v.append(t,e)},We.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||\"\"},We.getAllResponseHeaders=function(){if(!this.h)return\"\";for(var t=[],e=this.h.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+\": \"+n[1]),n=e.next();return t.join(\"\\r\\n\")},Object.defineProperty(ae.prototype,\"withCredentials\",{get:function(){return\"include\"===this.m},set:function(t){this.m=t?\"include\":\"same-origin\"}});var er=Je.JSON.parse;p(le,q);var nr=\"\",rr=/^https?$/i,ir=[\"POST\",\"PUT\"];(We=le.prototype).ea=function(t,e,n,r){if(this.g)throw Error(\"[goog.net.XhrIo] Object is active with another request=\"+this.H+\"; newUri=\"+t);e=e?e.toUpperCase():\"GET\",this.H=t,this.j=\"\",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():qn.g(),this.C=this.u?ht(this.u):ht(qn),this.g.onreadystatechange=f(this.Fa,this);try{this.F=!0,this.g.open(e,t+\"\",!0),this.F=!1}catch(i){return void de(this,i)}t=n||\"\";var i,o=new Nt(this.headers);r&&Dt(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=fe,n=t.length,r=\"string\"==typeof t?t.split(\"\"):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:\"string\"==typeof t?t.charAt(e):t[e]}(o.T()),n=Je.FormData&&t instanceof Je.FormData,!(0<=tn(ir,e))||r||n||o.set(\"Content-Type\",\"application/x-www-form-urlencoded;charset=utf-8\"),o.forEach(function(t,e){this.g.setRequestHeader(e,t)},this),this.J&&(this.g.responseType=this.J),\"withCredentials\"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{ve(this),0<this.B&&((this.K=(i=this.g,cn&&S()&&\"number\"==typeof i.timeout&&void 0!==i.ontimeout))?(this.g.timeout=this.B,this.g.ontimeout=f(this.pa,this)):this.A=X(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(i){de(this,i)}},We.pa=function(){void 0!==$e&&this.g&&(this.j=\"Timed out after \"+this.B+\"ms, aborting\",this.m=8,B(this,\"timeout\"),this.abort(8))},We.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,B(this,\"complete\"),B(this,\"abort\"),ge(this))},We.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),ge(this,!0)),le.Z.M.call(this)},We.Fa=function(){this.s||(this.F||this.v||this.l?ye(this):this.cb())},We.cb=function(){ye(this)},We.ba=function(){try{return 2<me(this)?this.g.status:-1}catch(t){return-1}},We.ga=function(){try{return this.g?this.g.responseText:\"\"}catch(t){return\"\"}},We.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),er(e)}},We.Da=function(){return this.m},We.La=function(){return\"string\"==typeof this.j?this.j:this.j+\"\"},(We=_e.prototype).ma=8,We.G=1,We.hb=function(t){try{this.h.info(\"Origin Trials invoked: \"+t)}catch(t){}},We.Ha=function(t){if(this.m)if(this.m=null,1!=this.G)3==this.G&&(t?De(this,t):0==this.l.length||Xt(this.i)||De(this));else if(!t){this.V=o(1e5*Math.random()),t=this.V++;var e=new yt(this,this.h,t,void 0),n=this.s;if(this.P&&(n?I(n=_(n),this.P):n=this.P),null===this.o&&(e.H=n),this.ja)t:{for(var r=0,i=0;i<this.l.length;i++){var s=this.l[i];if(void 0===(s=\"__data__\"in s.g&&\"string\"==typeof(s=s.g.__data__)?s.length:void 0))break;if(4096<(r+=s)){r=i;break t}if(4096===r||i===this.l.length-1){r=i+1;break t}}r=1e3}else r=1e3;r=Ce(this,e,r),Ft(i=Rt(this.F),\"RID\",t),Ft(i,\"CVER\",22),this.D&&Ft(i,\"X-HTTP-Session-Id\",this.D),Ne(this,i),this.o&&n&&we(i,this.o,n),Zt(this.i,e),this.Ra&&Ft(i,\"TYPE\",\"init\"),this.ja?(Ft(i,\"$req\",r),Ft(i,\"SID\",\"null\"),e.$=!0,vt(e,i,null)):vt(e,i,r),this.G=2}},We.Ga=function(){if(this.u=null,xe(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info(\"BP detection timer enabled: \"+t),this.B=ut(f(this.bb,this),t)}},We.bb=function(){this.B&&(this.B=null,this.h.info(\"BP detection timeout reached.\"),this.h.info(\"Buffering proxy detected and switch to long-polling!\"),this.N=!1,this.L=!0,st(10),Te(this),xe(this))},We.ab=function(){null!=this.v&&(this.v=null,Te(this),ke(this),st(19))},We.jb=function(t){t?(this.h.info(\"Successfully pinged google.com\"),st(2)):(this.h.info(\"Failed to ping google.com\"),st(1))},(We=Be.prototype).xa=function(){},We.wa=function(){},We.va=function(){},We.ua=function(){},We.Oa=function(){},Ke.prototype.g=function(t,e){return new ze(t,e)},p(ze,q),ze.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info(\"Origin Trials enabled.\"),Q(f(t.hb,t,e))),st(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=Ue(t,null,t.W),Ae(t)},ze.prototype.close=function(){Ie(this.g)},ze.prototype.u=function(t){if(\"string\"==typeof t){var e={};e.__data__=t,Se(this.g,e)}else this.v?((e={}).__data__=Nn(t),Se(this.g,e)):Se(this.g,t)},ze.prototype.M=function(){this.g.j=null,delete this.j,Ie(this.g),delete this.g,ze.Z.M.call(this)},p(Ge,ft),p(Qe,dt),p(He,Be),He.prototype.xa=function(){B(this.g,\"a\")},He.prototype.wa=function(t){B(this.g,new Ge(t))},He.prototype.va=function(t){B(this.g,new Qe(t))},He.prototype.ua=function(){B(this.g,\"b\")},Ke.prototype.createWebChannel=Ke.prototype.g,ze.prototype.send=ze.prototype.u,ze.prototype.open=ze.prototype.m,ze.prototype.close=ze.prototype.close,Vn.NO_ERROR=0,Vn.TIMEOUT=8,Vn.HTTP_ERROR=6,Un.COMPLETE=\"complete\",lt.EventType=Bn,Bn.OPEN=\"a\",Bn.CLOSE=\"b\",Bn.ERROR=\"c\",Bn.MESSAGE=\"d\",q.prototype.listen=q.prototype.N,le.prototype.listenOnce=le.prototype.O,le.prototype.getLastError=le.prototype.La,le.prototype.getLastErrorCode=le.prototype.Da,le.prototype.getStatus=le.prototype.ba,le.prototype.getResponseJson=le.prototype.Qa,le.prototype.getResponseText=le.prototype.ga,le.prototype.send=le.prototype.ea;var or=function(){return new Ke},sr=function(){return nt()},ar=Vn,ur=Un,cr=Mn,hr={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},lr=se,fr=lt,dr=le}).call(this,n(5))},function(t,e,n){\"use strict\";function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function i(t){u.forEach(function(e){e.setLogLevel(t)})}function o(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=c[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var s=i.map(function(t){if(null==t)return null;if(\"string\"==typeof t)return t;if(\"number\"==typeof t||\"boolean\"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}}).filter(function(t){return t}).join(\" \");n>=(null!=r?r:e.logLevel)&&t({level:a[n].toLowerCase(),message:s,args:i,type:e.name})}},r=0,i=u;r<i.length;r++)n(i[r])}n.d(e,\"a\",function(){return a}),n.d(e,\"b\",function(){return d}),n.d(e,\"c\",function(){return i}),n.d(e,\"d\",function(){return o});var s,a,u=[];!function(t){t[t.DEBUG=0]=\"DEBUG\",t[t.VERBOSE=1]=\"VERBOSE\",t[t.INFO=2]=\"INFO\",t[t.WARN=3]=\"WARN\",t[t.ERROR=4]=\"ERROR\",t[t.SILENT=5]=\"SILENT\"}(a||(a={}));var c={debug:a.DEBUG,verbose:a.VERBOSE,info:a.INFO,warn:a.WARN,error:a.ERROR,silent:a.SILENT},h=a.INFO,l=((s={})[a.DEBUG]=\"log\",s[a.VERBOSE]=\"log\",s[a.INFO]=\"info\",s[a.WARN]=\"warn\",s[a.ERROR]=\"error\",s),f=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var o=(new Date).toISOString(),s=l[e];if(!s)throw new Error(\"Attempted to log a message with an invalid logType (value: \"+e+\")\");console[s].apply(console,r([\"[\"+o+\"]  \"+t.name+\":\"],n))}},d=function(){function t(t){this.name=t,this._logLevel=h,this._logHandler=f,this._userLogHandler=null,u.push(this)}return Object.defineProperty(t.prototype,\"logLevel\",{get:function(){return this._logLevel},set:function(t){if(!(t in a))throw new TypeError('Invalid value \"'+t+'\" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel=\"string\"==typeof t?c[t]:t},Object.defineProperty(t.prototype,\"logHandler\",{get:function(){return this._logHandler},set:function(t){if(\"function\"!=typeof t)throw new TypeError(\"Value assigned to `logHandler` must be a function\");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"userLogHandler\",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,a.DEBUG],t)),this._logHandler.apply(this,r([this,a.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,a.VERBOSE],t)),this._logHandler.apply(this,r([this,a.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,a.INFO],t)),this._logHandler.apply(this,r([this,a.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,a.WARN],t)),this._logHandler.apply(this,r([this,a.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,a.ERROR],t)),this._logHandler.apply(this,r([this,a.ERROR],t))},t}()},function(t){var e=function(){return this}();try{e=e||new Function(\"return this\")()}catch(t){\"object\"==typeof window&&(e=window)}t.exports=e},function(t){function e(){throw new Error(\"setTimeout has not been defined\")}function n(){throw new Error(\"clearTimeout has not been defined\")}function r(t){if(u===setTimeout)return setTimeout(t,0);if((u===e||!u)&&setTimeout)return u=setTimeout,setTimeout(t,0);try{return u(t,0)}catch(e){try{return u.call(null,t,0)}catch(e){return u.call(this,t,0)}}}function i(){d&&l&&(d=!1,l.length?f=l.concat(f):p=-1,f.length&&o())}function o(){if(!d){var t=r(i);d=!0;for(var e=f.length;e;){for(l=f,f=[];++p<e;)l&&l[p].run();p=-1,e=f.length}l=null,d=!1,function(t){if(c===clearTimeout)return clearTimeout(t);if((c===n||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(t);try{c(t)}catch(e){try{return c.call(null,t)}catch(e){return c.call(this,t)}}}(t)}}function s(t,e){this.fun=t,this.array=e}function a(){}var u,c,h=t.exports={};!function(){try{u=\"function\"==typeof setTimeout?setTimeout:e}catch(t){u=e}try{c=\"function\"==typeof clearTimeout?clearTimeout:n}catch(t){c=n}}();var l,f=[],d=!1,p=-1;h.nextTick=function(t){var e=Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];f.push(new s(t,e)),1!==f.length||d||r(o)},s.prototype.run=function(){this.fun.apply(null,this.array)},h.title=\"browser\",h.browser=!0,h.env={},h.argv=[],h.version=\"\",h.versions={},h.on=a,h.addListener=a,h.once=a,h.off=a,h.removeListener=a,h.removeAllListeners=a,h.emit=a,h.prependListener=a,h.prependOnceListener=a,h.listeners=function(){return[]},h.binding=function(){throw new Error(\"process.binding is not supported\")},h.cwd=function(){return\"/\"},h.chdir=function(){throw new Error(\"process.chdir is not supported\")},h.umask=function(){return 0}},function(t,e,n){\"use strict\";\n/**\n * @license\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nn.r(e);var r={};n.r(r);var i,o,s=n(0),a=n(1),u=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode=\"LAZY\",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},t}(),c=\"[DEFAULT]\",h=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.onInitCallbacks=new Map}return t.prototype.get=function(t){var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new a.a;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:e});r&&n.resolve(r)}catch(e){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e,n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),r=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(\"Service \"+this.name+\" is not available\")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(n){if(r)return null;throw n}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error(\"Mismatching Component \"+t.name+\" for Provider \"+this.name+\".\");if(this.component)throw Error(\"Component for \"+this.name+\" has already been provided\");if(this.component=t,this.shouldAutoInitialize()){if(function(t){return\"EAGER\"===t.instantiationMode}\n/**\n * @license\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */(t))try{this.getOrInitializeService({instanceIdentifier:c})}catch(e){}try{for(var r=Object(s.g)(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=Object(s.e)(i.value,2),a=o[0],u=o[1],h=this.normalizeInstanceIdentifier(a);try{var l=this.getOrInitializeService({instanceIdentifier:h});u.resolve(l)}catch(e){}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}},t.prototype.clearInstance=function(t){void 0===t&&(t=c),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return Object(s.b)(this,void 0,void 0,function(){var t;return Object(s.d)(this,function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(Object(s.f)(Object(s.f)([],Object(s.e)(t.filter(function(t){return\"INTERNAL\"in t}).map(function(t){return t.INTERNAL.delete()}))),Object(s.e)(t.filter(function(t){return\"_delete\"in t}).map(function(t){return t._delete()}))))];case 1:return e.sent(),[2]}})})},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t=c),this.instances.has(t)},t.prototype.initialize=function(t){var e,n;void 0===t&&(t={});var r=t.options,i=void 0===r?{}:r,o=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(o))throw Error(this.name+\"(\"+o+\") has already been initialized\");if(!this.isComponentSet())throw Error(\"Component \"+this.name+\" has not been registered yet\");var a=this.getOrInitializeService({instanceIdentifier:o,options:i});try{for(var u=Object(s.g)(this.instancesDeferred.entries()),c=u.next();!c.done;c=u.next()){var h=Object(s.e)(c.value,2),l=h[0],f=h[1];o===this.normalizeInstanceIdentifier(l)&&f.resolve(a)}}catch(t){e={error:t}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(e)throw e.error}}return a},t.prototype.onInit=function(t,e){var n,r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);var o=this.instances.get(r);return o&&t(o,r),function(){i.delete(t)}},t.prototype.invokeOnInitCallbacks=function(t,e){var n,r,i=this.onInitCallbacks.get(e);if(i)try{for(var o,a=Object(s.g)(i),u=a.next();!u.done;u=a.next()){o=u.value;try{o(t,e)}catch(t){}}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}},t.prototype.getOrInitializeService=function(t){var e=t.instanceIdentifier,n=t.options,r=void 0===n?{}:n,i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:function(t){return t===c?void 0:t}(e),options:r}),this.instances.set(e,i),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch(t){}return i||null},t.prototype.normalizeInstanceIdentifier=function(t){return void 0===t&&(t=c),this.component?this.component.multipleInstances?t:c:t},t.prototype.shouldAutoInitialize=function(){return!!this.component&&\"EXPLICIT\"!==this.component.instantiationMode},t}(),l=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(\"Component \"+t.name+\" has already been registered with \"+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new h(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}(),f=n(4),d=((i={})[\"no-app\"]=\"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()\",i[\"bad-app-name\"]=\"Illegal App name: '{$appName}\",i[\"duplicate-app\"]=\"Firebase App named '{$appName}' already exists\",i[\"app-deleted\"]=\"Firebase App named '{$appName}' already deleted\",i[\"invalid-app-argument\"]=\"firebase.{$appName}() takes either no argument or a Firebase App instance.\",i[\"invalid-log-argument\"]=\"First argument to `onLog` must be null or a function.\",i),p=new a.b(\"app\",\"Firebase\",d),y=\"@firebase/app\",g=\"[DEFAULT]\",v=((o={})[y]=\"fire-core\",o[\"@firebase/analytics\"]=\"fire-analytics\",o[\"@firebase/app-check\"]=\"fire-app-check\",o[\"@firebase/auth\"]=\"fire-auth\",o[\"@firebase/database\"]=\"fire-rtdb\",o[\"@firebase/functions\"]=\"fire-fn\",o[\"@firebase/installations\"]=\"fire-iid\",o[\"@firebase/messaging\"]=\"fire-fcm\",o[\"@firebase/performance\"]=\"fire-perf\",o[\"@firebase/remote-config\"]=\"fire-rc\",o[\"@firebase/storage\"]=\"fire-gcs\",o[\"@firebase/firestore\"]=\"fire-fst\",o[\"fire-js\"]=\"fire-js\",o[\"firebase-wrapper\"]=\"fire-js-all\",o),m=new f.b(\"@firebase/app\"),b=function(){function t(t,e,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=Object(a.f)(t),this.container=new l(e.name),this._addComponent(new u(\"app\",function(){return r},\"PUBLIC\")),this.firebase_.INTERNAL.components.forEach(function(t){return r._addComponent(t)})}return Object.defineProperty(t.prototype,\"automaticDataCollectionEnabled\",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"name\",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"options\",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise(function(e){t.checkDestroyed_(),e()}).then(function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map(function(t){return t.delete()}))}).then(function(){t.isDeleted_=!0})},t.prototype._getService=function(t,e){var n;void 0===e&&(e=g),this.checkDestroyed_();var r=this.container.getProvider(t);return r.isInitialized()||\"EXPLICIT\"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=g),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){m.debug(\"Component \"+t.name+\" failed to register with FirebaseApp \"+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw p.create(\"app-deleted\",{appName:this.name_})},t}();\n/**\n * @license\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */b.prototype.name&&b.prototype.options||b.prototype.delete||console.log(\"dc\");var w=\"8.7.0\",E=\n/**\n * @license\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nfunction t(){var e=function(t){function e(t){if(t=t||g,!Object(a.c)(r,t))throw p.create(\"no-app\",{appName:t});return r[t]}function n(n){var s=n.name;if(i.has(s))return m.debug(\"There were multiple attempts to register component \"+s+\".\"),\"PUBLIC\"===n.type?o[s]:null;if(i.set(s,n),\"PUBLIC\"===n.type){var u=function(t){if(void 0===t&&(t=e()),\"function\"!=typeof t[s])throw p.create(\"invalid-app-argument\",{appName:s});return t[s]()};void 0!==n.serviceProps&&Object(a.g)(u,n.serviceProps),o[s]=u,t.prototype[s]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._getService.bind(this,s).apply(this,n.multipleInstances?t:[])}}for(var c,h=0,l=Object.keys(r);h<l.length;h++)c=l[h],r[c]._addComponent(n);return\"PUBLIC\"===n.type?o[s]:null}var r={},i=new Map,o={__esModule:!0,initializeApp:function(e,n){void 0===n&&(n={}),(\"object\"!=typeof n||null===n)&&(n={name:n});var i=n;void 0===i.name&&(i.name=g);var s=i.name;if(\"string\"!=typeof s||!s)throw p.create(\"bad-app-name\",{appName:s+\"\"});if(Object(a.c)(r,s))throw p.create(\"duplicate-app\",{appName:s});var u=new t(e,i,o);return r[s]=u,u},app:e,registerVersion:function(t,e,r){var i,o=null!==(i=v[t])&&void 0!==i?i:t;r&&(o+=\"-\"+r);var s=o.match(/\\s|\\//),a=e.match(/\\s|\\//);if(s||a){var c=['Unable to register library \"'+o+'\" with version \"'+e+'\":'];return s&&c.push('library name \"'+o+'\" contains illegal characters (whitespace or \"/\")'),s&&a&&c.push(\"and\"),a&&c.push('version name \"'+e+'\" contains illegal characters (whitespace or \"/\")'),void m.warn(c.join(\" \"))}n(new u(o+\"-version\",function(){return{library:o,version:e}},\"VERSION\"))},setLogLevel:f.c,onLog:function(t,e){if(null!==t&&\"function\"!=typeof t)throw p.create(\"invalid-log-argument\");Object(f.d)(t,e)},apps:null,SDK_VERSION:w,INTERNAL:{registerComponent:n,removeApp:function(t){delete r[t]},components:i,useAsService:function(t,e){return\"serverAuth\"===e?null:e}}};return o.default=o,Object.defineProperty(o,\"apps\",{get:function(){return Object.keys(r).map(function(t){return r[t]})}}),e.App=t,o}(b);return e.INTERNAL=Object(s.a)(Object(s.a)({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){Object(a.g)(e,t)},createSubscribe:a.e,ErrorFactory:a.b,deepExtend:a.g}),e}(),_=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map(function(t){if(function(t){var e=t.getComponent();return\"VERSION\"===(null==e?void 0:e.type)}(t)){var e=t.getImmediate();return e.library+\"/\"+e.version}return null}).filter(function(t){return t}).join(\" \")},t}();\n/**\n * @license\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */if(Object(a.j)()&&void 0!==self.firebase){m.warn(\"\\n    Warning: Firebase is already defined in the global scope. Please make sure\\n    Firebase library is only loaded once.\\n  \");var I=self.firebase.SDK_VERSION;I&&0<=I.indexOf(\"LITE\")&&m.warn(\"\\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\\n    \")}var T=E.initializeApp;E.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Object(a.o)()&&m.warn('\\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\\n      run in a Node environment.  If running in a Node environment, make sure you\\n      are using the bundle specified by the \"main\" field in package.json.\\n      \\n      If you are using Webpack, you can specify \"main\" as the first item in\\n      \"resolve.mainFields\":\\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\\n      \\n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify \"main\"\\n      as the first item in \"mainFields\", e.g. [\\'main\\', \\'module\\'].\\n      https://github.com/rollup/@rollup/plugin-node-resolve\\n      '),T.apply(void 0,t)};var O=E;!function(t,e){t.INTERNAL.registerComponent(new u(\"platform-logger\",function(t){return new _(t)},\"PRIVATE\")),t.registerVersion(y,\"0.6.28\",void 0),t.registerVersion(\"fire-js\",\"\")}(O);var S=n(2),A=(n(3),{Firestore:S.q,GeoPoint:S.b,Timestamp:S.f,Blob:S.k,Transaction:S.g,WriteBatch:S.n,DocumentReference:S.d,DocumentSnapshot:S.i,Query:S.j,QueryDocumentSnapshot:S.h,QuerySnapshot:S.l,CollectionReference:S.o,FieldPath:S.m,FieldValue:S.r,setLogLevel:S.e,CACHE_SIZE_UNLIMITED:S.p});(function(t){!function(t,e){t.INTERNAL.registerComponent(new u(\"firestore\",function(t){return function(t,e){return new S.q(t,new S.c(t,e),new S.a)}(t.getProvider(\"app\").getImmediate(),t.getProvider(\"auth-internal\"))},\"PUBLIC\").setServiceProps(Object.assign({},A)))}(t),t.registerVersion(\"@firebase/firestore\",\"2.3.8\")})(O),console.log(r)}]);","extractedComments":[]}